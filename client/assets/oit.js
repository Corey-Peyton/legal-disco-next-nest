/*
 Copyright (c) 2012, 2016, Oracle. All rights reserved. */
'use strict';if(window.OIT){var modView=window.OIT.view;modView&&(modView.detach?modView.detach():modView.unload&&modView.unload());}
window.OIT=function(){var a=function(){b.globalEvents.init.dispatch();b.globalEvents.init.reset();},b={extend:function(){if(0<arguments.length){var c=arguments[0];switch(typeof c){case 'function':c.call(b,b);break;case 'string':var d=b[c];d&&(c=d.extend)&&c.apply(d,arguments);break;case 'boolean':d=b,d.globalEvents.install.dispatch(d),d.globalEvents.install.reset(),!c&&window.OIT&&delete window.OIT.extend,window.addEventListener('load',a);}}},subclass:function(a,d){d||(d=b.Object);return a.prototype=
Object.create(d.prototype);},uninstall:function(){var a=window.OIT.view;a&&a.detach();},'export':function(a,b,d){Object.defineProperty(OIT,a,{value:b,writable:!!d});}},d={extend:function(){b.extend.apply(this,arguments);}};Object.defineProperties(d,{uninstall:{value:function(){b&&(b.uninstall(),b=null);window.OIT=void 0;},writable:!0}});return d;}();(function(a,b){OIT.extend(function(d){var c=/^[.#\w][-_\.\w\d]*$/,f=('oit'+Math.random()).replace(/\W/g,''),e=[],l=1,p=d.doc=function(a){if(c.test(a)){if(0==a.lastIndexOf('#',0))return p.byId(a.slice(1));if(0==a.lastIndexOf('.',0))return p.byClass(a.slice(1));if(0===a.indexOf(' '))return p.byTagName(a);}return p.bySelector(a);};Object.defineProperties(p,{html:{get:function(){return p.wrap(b.documentElement);}},body:{get:function(){return p.wrap(b.body);}},head:{get:function(){return p.wrap(p.html.childByTagName('head'));}},
expando:{value:f}});p.byId=function(a){return p.wrap(b.getElementById(a));};p.byClass=function(a){return p.wrap(b.getElementsByClassName(a));};p.byTagName=function(a){return p.wrap(b.getElementsByTagName(a));};p.bySelector=function(a){return p.wrap(b.querySelectorAll(a));};p.attach=function(a){a.data('_elem',a);};p.query=function(a){return p.data(a,'_elem');};p.isElement=function(a){return a&&(a.dom||1===a.nodeType);};p.isText=function(a){return a&&3===a.nodeType;};p.isDescendantOf=function(a,b){a=p.unwrap(a);
for(b=p.unwrap(b);a.parentNode;){if(a.parentNode===b)return!0;a=a.parentNode;}return!1;};p.nodeIndex=function(a){for(var b=0;a=a.previousSibling;)++b;return b;};p.unwrap=function(a){a&&a.dom&&(a=a.dom);return a;};p.wrap=function(a){if(a){if(0<=a.length){var b;'function'===typeof a.item?b=[]:Array.isArray(a)&&(b=a);if(b){for(var c=0;c<a.length;c++)b[c]=p.wrap(a[c]);0===b.length&&(b=void 0);return b;}}if(a.tagName&&!a.dom)return(b=p.query(a))||(b=new d.Element(a)),b;}return a;};p.acceptsData=function(a){return a&&
(1===a.nodeType||9===a.nodeType);};p.data=function(a,b,c){a=p.unwrap(a);if(p.acceptsData(a)&&b){var k=a[f];if(void 0!==c){if(!k){do k=l++;while(void 0!==e[k]);Object.defineProperty(a,f,{value:k});}e[k]||(e[k]={});p.nodeToString&&(a=p.nodeToString(a),e[k].domNode=a);return e[k][b]=c;}var d;k&&(c=e[k])&&(d=c[b]);void 0===d&&a.getAttribute&&(d=a.getAttribute('data-'+b),null===d&&(d=void 0));return d;}};p.destroyData=function(a){a=p.unwrap(a);if(p.acceptsData(a)&&(a=a[f]))e[a]=void 0,a<l&&(l=a);};p.removeData=
function(a,b){a=p.unwrap(a);if(p.acceptsData(a)){var c=a[f];if(c)if(b){if(c=e[c]){delete c[b];var k;a:{for(k in c)if(Object.prototype.hasOwnProperty.call(c,k)){k=!0;break a;}k=!1;}k||p.removeData(a);}}else e[c]=void 0;}};p.removeSubtreeData=function(a){p.removeData(a);for(a=a.firstElementChild;a;a=a.nextElementSibling)p.removeSubtreeData(a);};p.reset=function(){var a,b;for(b in e){var c=e[b];c&&(p.logUnreleasedData&&p.logUnreleasedData(c),a||(a=[]),a[b]=c);}a?e=a:(e=[],l=1);};p.hasClass=function(a,b){if(Array.isArray(b)){for(var c=
0;c<b.length;c++)if(p.hasClass(a,b[c]))return!0;return!1;}a=p.unwrap(a);return a.classList?a.classList.contains(b):a.getAttribute&&(c=a.getAttribute('class'))?(c=' '+c+' ',b=' '+b.trim()+' ',-1!=c.indexOf(b)):!1;};p.addClass=function(a,b){a=p.unwrap(a);if(a.classList)a.classList.add(b);else if(a.getAttribute&&!p.hasClass(a,b)){var c=a.getAttribute('class');a.setAttribute('class',c+(' '+b));}};p.removeClass=function(a,b){a=p.unwrap(a);if(a.classList)a.classList.remove(b);else if(a.getAttribute){var c=
a.getAttribute('class').replace(b,'');a.setAttribute('class',c);}};p.create=function(a,b,c,k){return new d.Element(a,b,c,k);};p.createText=function(a){return b.createTextNode(a);};p.listen=function(a,c,d){return b.addEventListener(a,c,d);};p.unlisten=function(a,c,d){return b.removeEventListener(a,c,d);};p.cursor=function(a){void 0!==a&&(b.body.style.cursor=a);return b.body.style.cursor;};p.clearSelection=function(){a.focus();if(a.getSelection){var b=a.getSelection();null!=b&&b.removeAllRanges();}};p.selectRange=
function(c,e,m,k){a.focus();if(a.getSelection){var f;d.util.isDOMRange(c)?f=c:(f=b.createRange(),f.setStart(c,e),f.setEnd(m,k));c=a.getSelection();c.removeAllRanges();c.addRange(f);}};p.selectedText=function(){var c;if(a.getSelection){var d=a.getSelection();d&&(c=d.toString());}else b.selection&&'Control'!=b.selection.type&&(c=b.selection.createRange().text);c||(c='');return c;};});})(window,document);OIT.extend(function(a){a.Object=function(){};var b=a.Object.prototype;b.prop=function(a,b,f,e){'string'===typeof a&&void 0!==b&&Object.defineProperty(this,a,{value:b,writable:!!f});};b.deleteAll=function(){for(var a in this)this.hasOwnProperty(a)&&delete this[a];};b.invalidArg=function(b,c,f,e){var l='';this.publicName&&b&&(l=this.publicName+'.'+b+': ');l=c?l+('Invalid value specified for argument \''+c+'\''):l+'Invalid argument';f&&(l+=': \''+a.util.stringify(f)+'\'');e&&(l+=', '+e);this.logError(b,l);};
b.logError=function(b,c){var f;this.publicName&&b&&(f=this.publicName+'.'+b+': ');c&&(f=(f?f+': ':'')+String(c));f&&0<f.length&&a.dispatch('document','error',f)&&console.error(f);};b.logFatalError=function(b,c){var f;this.publicName&&b&&(f=this.publicName+'.'+b+': ');c&&(f=(f?f+': ':'')+String(c));f&&0<f.length&&a.dispatch('document','error',f)&&console.error(f);};});OIT.extend(function(a){var b=a.doc,d=[];d[0]=d[23]='right';d[5]=d[6]='up';d[11]=d[12]='left';d[17]=d[18]='down';a.Element=function(a){void 0===a&&(a='div');if('string'==typeof a){var c=this.dom=document.createElement(a),g=1;if(g<arguments.length){var k;'string'==typeof arguments[g]?k=arguments[g++]:Array.isArray(arguments[g])&&(k=arguments[g++].join(' '));k&&k.length&&c.setAttribute('class',k);}g<arguments.length&&'string'==typeof arguments[g]&&(c.id=arguments[g++]);g<arguments.length&&(c=b.wrap(arguments[g++]))&&
b.isElement(c)&&c.append(this);}else b.isElement(a)&&(this.dom=b.unwrap(a));};for(var c=a.subclass(a.Element),f='clientLeft clientTop clientWidth clientHeight offsetWidth offsetHeight scrollWidth scrollHeight parentNode tagName classList'.split(' '),e=function(a){Object.defineProperty(c,a,{get:function(){return this.dom[a];}});},l=0;l<f.length;l++)e(f[l]);Object.defineProperties(c,{id:{get:function(){return this.dom.id;},set:function(a){this.dom.id=a;}},opacity:{get:function(){return Number(this.computedStyleProp('opacity'));},
set:function(a){this.dom.style.opacity=a;}},offsetLeft:{get:function(){return this.dom.offsetLeft;},set:function(b){this.dom.style.left=a.math.round(b)+'px';}},offsetTop:{get:function(){return this.dom.offsetTop;},set:function(b){this.dom.style.top=a.math.round(b)+'px';}},scrollLeft:{get:function(){return this.dom.scrollLeft;},set:function(b){this.dom.scrollLeft=a.math.round(b);}},scrollTop:{get:function(){return this.dom.scrollTop;},set:function(b){this.dom.scrollTop=a.math.round(b);}},innerWidth:{get:function(){var a=
this.computedStyleProp('width');return-1!=a.indexOf('px')?parseInt(a):this.dom.clientWidth;},set:function(b){this.dom.style.width=a.math.round(b)+'px';}},innerHeight:{get:function(){var a=this.computedStyleProp('height');return-1!=a.indexOf('px')?parseInt(a):this.dom.clientHeight;},set:function(b){this.dom.style.height=a.math.round(b)+'px';}}});c.focus=function(){this.dom.focus();};c.blur=function(){this.dom.blur();};c.parent=function(){return b.wrap(this.dom.parentNode);};c.firstChildElem=function(){return b.wrap(this.dom.firstElementChild);};
c.nextSiblingElem=function(){return b.wrap(this.dom.nextElementSibling);};c.destroy=function(){var a=this.dom.parentNode;a&&a.removeChild(this.dom);this.destroyChildren();b.destroyData(this.dom);this.deleteAll();};var p=function(a){for(var c=a.firstElementChild;c;c=a){a=c.nextElementSibling;p(c);var g=b.query(c);g?g.destroy():b.removeData(c);}};c.destroyChildren=function(){p(this.dom);};c.equals=function(a){return this.dom==b.unwrap(a);};c.html=function(a){void 0!==a&&(this.destroyChildren(),this.dom.innerHTML=
a);return this.dom.innerHTML;};c.text=function(a){void 0!==a&&(this.destroyChildren(),this.dom.textContent=a);return this.dom.textContent;};c.data=function(a,c){return b.data(this.dom,a,c);};c.ancestorData=function(c){for(var g,k=this.dom,d=b.unwrap(a.glob.rootNode);k;){g=b.data(k,c);if(void 0!==g)break;if(k==d)break;k=k.parentNode;}return g;};c.removeData=function(a){return b.removeData(this.dom,a);};c.hasClass=function(a){return b.hasClass(this.dom,a);};c.addClass=function(a){b.addClass(this.dom,a);return this;};
c.addClasses=function(a){Array.isArray(a)||(a=a.split(' '));if(Array.isArray(a))for(var c=0;c<a.length;c++)b.addClass(this.dom,a[c]);return this;};c.removeClass=function(a){b.removeClass(this.dom,a);return this;};c.attr=function(a,b){if(Array.isArray(a)){for(var c={},g=0;g<a.length;g++){var k=a[g];c[k]=this.dom.getAttribute(k);}return c;}if(void 0===b){if('string'===typeof a)return this.dom.getAttribute(a);for(k in a)a.hasOwnProperty(k)&&this.dom.setAttribute(k,a[k]);}else null===b?this.dom.removeAttribute(a):
this.dom.setAttribute(a,b);return this;};c.css=function(b,c){var g=this.dom;if(g){g=g.style;try{if(Array.isArray(b)){for(var k={},d=0;d<b.length;d++){var r=b[d];k[r]=g.getPropertyValue(h(r));}return k;}if(void 0===c){if('string'===typeof b){if(-1==b.indexOf(':'))return g.getPropertyValue(h(b));(k=a.css.parse(b))&&this.css(k);}for(r in b)b.hasOwnProperty(r)&&(d=b[r],null===d||void 0===d?g.removeProperty(h(r)):g.setProperty(h(r),d,''));}else null===c?g.removeProperty(h(b)):g.setProperty(h(b),c,'');}catch(m){}}return this;};
var h=function(b){return a.css.nameMap[b]||b;};c.removeStyle=function(a){var b=this.dom;if(Array.isArray(a))for(var c=0;c<a.length;c++)b.style.removeProperty(a[c]);else if('string'===typeof a)b.style.removeProperty(a);else for(c in a)a.hasOwnProperty(c)&&b.style.removeProperty(c);return this;};c.resetStyle=function(){return this.attr('style',null);};c.computedStyle=function(){return window.getComputedStyle(this.dom);};c.computedStyleProp=function(a){return this.computedStyle().getPropertyValue(a);};c.show=
function(){this._hidden&&(this.removeStyle('display'),delete this._hidden);return this;};c.hide=function(){this._hidden||(this.css('display','none'),this._hidden=!0);return this;};c.isHidden=function(){return this._hidden;};c.autoscroll=function(a,b){var c=this.dom;switch(arguments.length){case 0:return{left:c.scrollLeft,top:c.scrollTop};case 1:return this.autoscroll(a.left,a.top);case 2:void 0!==a&&(c.scrollLeft=a),void 0!==b&&(c.scrollTop=b);}return this;};c.scroll=function(a,b){(void 0!==a||void 0!==
b)&&this.cancelKinetic();return this.autoscroll.apply(this,arguments);};c.dscroll=function(a,b){this.cancelKinetic();a&&(this.dom.scrollLeft+=a);b&&(this.dom.scrollTop+=b);};c.animate=function(b){b&&(this.finishAnimation(),this.dom&&new a.Animation(this,b));};c.finishAnimation=function(){var a=this.data('_animation');a&&a.finish();};c.abortAnimation=function(){var a=this.data('_animation');a&&a.abort();};c.append=function(){if(this.dom)for(var a=arguments,c=0;c<a.length;c++){var g=a[c];Array.isArray(g)?
this.append.apply(this,g):this.dom.appendChild(b.unwrap(g));}return this;};c.insert=function(a,c){this.dom&&this.dom.insertBefore(b.unwrap(a),b.unwrap(c));return this;};c.insertAfter=function(a,c){this.dom&&(a=b.unwrap(a),c=b.unwrap(c),c=c.nextSibling,this.dom.insertBefore(a,c));return this;};c.insertFirst=function(a){this.dom&&this.dom.insertBefore(b.unwrap(a),this.dom.firstChild);return this;};c.transferFrom=function(a){a=b.unwrap(a);if(this.dom&&a)for(;0<a.childNodes.length;)this.dom.appendChild(a.childNodes[0]);
return this;};c.forElementAndAncestors=function(c){for(var g=this,k=b.unwrap(a.glob.rootNode);g&&!1!==c(g)&&g!=k;)g=g.parent();return this;};c.forChildElements=function(a){return q.call(this,a,!1,arguments);};c.queryChildElements=function(a){return q.call(this,a,!0,arguments);};var q=function(a,c,g){for(var k=[null,-1],d=1;d<g.length;d++)k.push(g[d]);g=0;var h=this.dom.firstElementChild;for(g=0;h;h=d,g++)if(d=h.nextElementSibling,h=!0===c?b.query(h):b.wrap(h))if(k[0]=h,k[1]=g,!1===a.apply(null,k))break;
return this;};c.pos=function(a){var c=this.dom;a=b.unwrap(a);if(a==c)return{left:0,top:0};for(;c&&!c.getBoundingClientRect;)c=c.parentNode;if(c)return c=c.getBoundingClientRect(),c={left:c.left,top:c.top},a&&a!==document.body&&(a=a.getBoundingClientRect(),c.left-=a.left,c.top-=a.top),c;};c.size=function(){for(var a=this.dom;a&&!a.getBoundingClientRect;)a=a.parentNode;if(a)return a=a.getBoundingClientRect(),{width:a.width,height:a.height};};c.rect=function(a){a=b.unwrap(a);for(var c=this.dom;c&&!c.getBoundingClientRect;)c=
c.parentNode;if(c){var g=c.getBoundingClientRect(),g={left:g.left,top:g.top,right:g.right,bottom:g.bottom,width:g.width,height:g.height};a&&a!==document.body&&(a==c?(g.right-=g.left,g.bottom-=g.top,g.left=0,g.top=0):(a=a.getBoundingClientRect(),g.left-=a.left,g.top-=a.top,g.right-=a.left,g.bottom-=a.top));return g;}};c.inRect=function(a,b){var c=this.dom;return c&&0<=a&&0<=b&&a<=c.clientWidth&&b<=c.clientHeight;};c.ancestorByClass=function(b){for(var c=this.parent(),g=a.glob.rootNode;c;){if(c.hasClass(b))return c;
if(c.equals(g))break;c=c.parent();}return null;};c.childByTagName=function(a){a=a.toUpperCase();for(var c=this.dom.firstElementChild;c;c=c.nextElementSibling)if(c.tagName.toUpperCase()===a)return b.wrap(c);return null;};c.childrenByTagName=function(a){var c=null;a=a.toUpperCase();for(var g=this.dom.firstElementChild;g;g=g.nextElementSibling)g.tagName.toUpperCase()===a&&(c||(c=[]),c.push(b.wrap(g)));return c;};c.childByClass=function(a){if(this)for(var b=this.firstChildElem();b;b=b.nextSiblingElem())if(b.hasClass(a))return b;
return null;};c.byClass=function(a){return b.wrap(this.dom.getElementsByClassName(a));};c.byId=function(a){for(var c=[b.unwrap(this.dom)];0<c.length;)for(var g=c.shift().firstElementChild;g;g=g.nextElementSibling){if(g.id===a)return b.wrap(g);c.push(g);}};c.byTag=function(a){a=a.toUpperCase();for(var c=[b.unwrap(this.dom)],g=[];0<c.length;)for(var k=c.shift().firstElementChild;k;k=k.nextElementSibling)k.tagName.toUpperCase()===a?g.push(b.wrap(k)):c.push(k);if(g.length)return g;};c.isDescendantOf=function(a){return b.isDescendantOf(this.dom,
a);};c.mousePos=function(a){a||(a=window.event);for(var b={x:0,y:0},c=this.dom;c;c=c.offsetParent)b.x+=c.offsetLeft,b.y+=c.offsetTop;if(a.pageX||a.pageY)b.x=a.pageX-b.x,b.y=a.pageY-b.y;else if(a.clientX||a.clientY)b.x=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft-b.x,b.y=a.clientY+document.body.scrollTop+document.documentElement.scrollTop-b.y;return b;};c.touchPos=function(a){if(a){for(var b=0,c=0,g=this.dom;g;g=g.offsetParent)b+=g.offsetLeft,c+=g.offsetTop;return{identifier:a.identifier,
x:a.pageX-b,y:a.pageY-c};}};c.select=function(){window.focus();if(window.getSelection){var a=document.createRange();a.selectNodeContents(this.dom);b.selectRange(a);}else document.selection&&document.body.createTextRange&&(a=document.body.createTextRange(),a.moveToElementText(this.dom),a.select());};var m=function(a){for(var c=!0;c;){var g=a.currentNode;if(1===g.nodeType)if('svg'===g.nodeName)c=a.skipNode();else if(g=b.data(g,'acc'),void 0!==g)if('none'===g)c=a.skipNode();else break;else break;else if(3===
g.nodeType)break;else c=a.nextNode();}return c;},k=function(){for(;;){var a=this.nextSibling();if(a)return a;if(!this.parentNode())return null;}},z=function(a){for(;this.currentNode!==a&&this.nextNode(););return this.currentNode===a;},s=function(){return m(this);},t=function(){var a=this.nextNode();a&&(a=m(this));return a;};c.createTreeWalker=function(a,b,c){void 0===a&&(a=NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);void 0===b&&(b=null);void 0===c&&(c=!1);a=document.createTreeWalker(this.dom,a,b,c);a.skipNode=
k;a.skipToNode=z;a.firstACCNode=s;a.nextACCNode=t;return a;};c.createCanvas=function(){return new a.Canvas(this);};c.on=function(a,c,g){if('function'===typeof g){var k=Array.prototype.slice.call(arguments,2);k[0]=null;c=c||this;var d,h=this.dom;d=a;var r=b.data(h,'_events');r||(r={},b.data(h,'_events',r));(h=r[d])||(h=r[d]=[]);d=h;for(r=0;r<d.length;r++)if(h=d[r],h.fn===g){h.ref=c;h.args=k;g=null;break;}g&&(d.push({fn:g,ref:c,args:k}),1==d.length&&(k=this._events[a])&&k.add&&k.add(this,a));}return this;};
c.off=function(a,b){if('function'===typeof b){var c=v(this.dom,a);if(c){for(var g=0;g<c.length;g++)if(c[g].fn===b){c.splice(g,1);break;}0==c.length&&(c=this._events[a])&&c.remove&&c.remove(this,a);}}return this;};for(var v=function(a,c){var g=b.data(a,'_events');if(g&&(g=g[c])&&0<g.length)return g;},y=function(a,b,c){a['on'+b]=function(a,c){1==arguments.length&&(c=a,a=null);return this.on(b,a,c);};a['off'+b]=function(a){return this.off(b,a);};a._events||(a._events={});a._events[b]=c;},w=function(b){var c=
v(b.currentTarget,b.type);if(c){for(var g=!0,k=0;k<c.length;k++){var d=c[k];d.args[0]=b;!1===d.fn.apply(d.ref,d.args)&&(g=!1);d.args[0]=null;}g||a.util.preventDefault(b);}},f='mouseover mouseout mouseenter mouseleave mousedown mousemove mouseup mousewheel touchstart touchmove touchend touchcancel click dblclick contextmenu keydown keyup keypress blur focus scroll'.split(' '),e={add:function(a,b){a.dom.addEventListener(b,w);},remove:function(a,b){a.dom.removeEventListener(b,w);}},l=0;l<f.length;l++)y(c,
f[l],e);for(var f='tap press pressup panstart panmove panend pancancel dragstart dragmove dragend dragcancel swipeleft swiperight swipeup swipedown pinchstart pinchmove pinchend pinchcancel rotatestart rotatemove rotateend rotatecancel'.split(' '),x=function(a){return'dragstart'===a||'dragmove'===a||'dragend'===a||'dragcancel'===a;},u=function(a,b){var c=a.data('_gestures');!c&&b&&(c={listenerCount:0},a.data('_gestures',c));return c;},e={add:function(a,b){var c=u(a,!0);c.touches||(c.touches=[],a.ontouchstart(I));
c.listenerCount++;x(b)&&(c.dragCount||(c.dragCount=0,a.onmousedown(H)),c.dragCount++);},remove:function(a,b){var c=u(a);c&&(c.listenerCount--,0==c.listenerCount&&(a.removeData('_gestures'),a.offtouchstart(I)),x(b)&&0<c.dragCount&&(c.dragCount--,c.dragCount||a.offmousedown(H)));}},l=0;l<f.length;l++)y(c,f[l],e);var B={add:function(a,b){},remove:function(a,b){}};c.customEvent=function(a){y(this,a,B);};c.dispatchCustom=function(a,b){var c=!0,g=v(this.dom,a);if(g)for(var k=0;k<g.length;k++){var d=g[k];d.args[0]=
b;!1==d.fn.apply(d.ref,d.args)&&(c=!1);d.args[0]=null;}return c;};var n=function(b,c,g,k){var h=!0;if(v(b.dom,c)){var h=a.math,r=g.start,m=g.current,e=r.center,n=m.center,t=g.delta;t||(t=g.delta={x:0,y:0});t.x=n.x-e.x;t.y=n.y-e.y;if(t.x||t.y)g.moved=!0;var f=g.moved||!1,y=g.press?!!g.press.started:!1,l=h.round(h.distanceBetweenPoints(e.x,e.y,n.x,n.y)),u=h.round(h.angleBetweenPoints(e.x,e.y,n.x,n.y),100),A;0<l&&(A=d[Math.floor((12*u/Math.PI+24)%24)]);var q=1,C=0;g.touches&&1<g.touches.length&&(0<r.distance&&
(q=m.distance/r.distance),C=h.normalizeAngle(m.angle-r.angle));g={type:c,srcEvent:k,target:b.dom,distance:l,angle:u,scale:q,rotation:C,start:e,center:n,delta:t,direction:A,moved:f,press:y};a.logGesture&&a.logGesture(c,b,g);h=b.dispatchCustom(c,g);}return h;},A=function(a,b,c){b.press&&(b.press.started=!0,n(a,'press',b,c));},g=function(b,c,g){c.press&&(c.press.started&&n(b,'pressup',c,g),c.press.timer&&a.util.clearTimeout(c.press.timer),delete c.press);},r=function(b,c,g,k,d,h){if(b=g.kinetic){g.start=
d;g.current=h;var m=Date.now()-b.frameTime,m=Math.exp(-m/325),e,t;b.ax&&(e=-b.ax*m,0.5>Math.abs(e)&&(e=0),g.current.center.x=d.center.x+b.tx+e);b.ay&&(t=-b.ay*m,0.5>Math.abs(t)&&(t=0),g.current.center.y=d.center.y+b.ty+t);e||t?(e=g.dragCount?'dragmove':'panmove',n(c,e,g,k),b.anim=a.util.requestAnimationFrame(r,null,c,g,k,d,h)):(e=g.dragCount?'dragend':'panend',n(c,e,g,k),delete g.kinetic,delete g.start,delete g.current);}},C=function(a,b,c){b.pan&&(n(a,'pancancel',b,c),delete b.pan);},F=function(b){if(b){var c=
a.math,g=Date.now();if(1==b.length){var k=b[0];b={x:c.round(k.x),y:c.round(k.y)};return{distance:0,angle:0,center:b,time:g};}if(2<=b.length){for(var k=0,d,h,r=b.length-1,m=0;m<r;m++)for(var e=b[m],t=m+1;t<b.length;t++){var n=b[t],n=c.distanceBetweenPoints(e.x,e.y,n.x,n.y);n>k&&(k=n,d=e,h=b[t]);}b=c.centroid(b);b.x=c.round(b.x);b.y=c.round(b.y);return{distance:c.round(k),angle:c.round(c.angleBetweenPoints(d.x,d.y,h.x,h.y),100),center:b,time:g};}}};c.kinetic=function(a){!0===a?u(this,!0).enableKinetic=
!0:!1===a&&(a=u(this))&&delete a.enableKinetic;};c.cancelKinetic=function(){var b=u(this);b&&b.kinetic&&(b.kinetic.anim&&a.util.cancelAnimationFrame(b.kinetic.anim),delete b.kinetic);};var I=function(b){var c=u(this);if(c){this.cancelKinetic();for(var k=c.touches,d=b.changedTouches,h=c.dragCount?a.glob.viewNode:this,r=0;r<d.length;r++){var m=h.touchPos(d[r]);m.ox=m.x;m.oy=m.y;k.push(m);}c.current=F(c.touches);c.start=c.current;1==k.length?(delete c.tap,c.tap={time:c.current.time},g(this,c,b),k=a.util.setTimeout(A,
500,null,this,c,b),c.press={timer:k}):1<k.length&&!c.pinch&&(delete c.tap,g(this,c,b),C(this,c,b),delete c.distance,c.pinch||(c.pinch={},n(this,'pinchstart',c,b)));a.user.setTouchCapture(J,L,E,this);a.util.preventDefault(b);return!1;}},J=function(b){var c=u(this);if(c){for(var k=c.touches,d=b.changedTouches,h=c.dragCount?a.glob.viewNode:this,r=0;r<d.length;r++)for(var m=h.touchPos(d[r]),e=0;e<k.length;e++){var t=k[e];if(t.identifier===m.identifier){t.x=m.x;t.y=m.y;t.dx=m.x-t.ox;t.dy=m.y-t.oy;break;}}t=
c.current;d=F(c.touches);if(d.distance!==t.distance||d.angle!==t.angle||d.center.x!==t.center.x||d.center.y!==t.center.y)if(c.previous=t,c.current=d,1==k.length&&!c.multi){if(t=k[0],k=c.distance=a.math.distanceBetweenPoints(t.dx,t.dy,0,0),t=d.time-c.start.time,10<k&&50<t&&(delete c.tap,c.press&&c.press.started||g(this,c,b),c.pan||(C(this,c,b),c.pan={time:c.current.time},c.enableKinetic&&!c.press&&(c.kinetic={vx:0,vy:0,frameTime:c.current.time,frameX:0,frameY:0}),n(this,c.dragCount?'dragstart':'panstart',
c,b)),c.pan&&(n(this,c.dragCount?'dragmove':'panmove',c,b),k=c.kinetic)))t=c.current.time,d=t-k.frameTime,c=c.delta,h=1E3*(c.y-k.frameY)/(d+1),k.vx=0.8*(1E3*(c.x-k.frameX)/(d+1))+0.2*k.vx,k.vy=0.8*h+0.2*k.vy,k.frameTime=t,k.frameX=c.x,k.frameY=c.y;}else 1<k.length&&(c.multi=!0,c.pinch&&(k=a.math,t=c.previous,d=c.current,h=c.start,0<h.distance&&(r=k.round(t.distance/h.distance,100),k.round(d.distance/h.distance,100)!=r&&n(this,'pinchmove',c,b)),d.angle!=t.angle&&(c.rotate||(c.rotate={start:c.start.angle},
n(this,'rotatestart',c,b)),n(this,'rotatemove',c,b))));a.util.preventDefault(b);return!1;}},L=function(a){D(this,a,!1);},E=function(a){D(this,a,!0);},D=function(b,c,k){var d=u(b);if(d){var h=d.touches,t=h.length-c.changedTouches.length;if(1==h.length)if(k)delete d.tap,g(b,d,c),C(b,d,c);else{if(d.pan){k=Date.now();var t=k-d.pan.time,m=!1,e=d.kinetic;e&&(10<Math.abs(e.vx)&&(e.ax=0.8*e.vx,e.tx=Math.round(d.delta.x+e.ax)),10<Math.abs(e.vy)&&(e.ay=0.8*e.vy,e.ty=Math.round(d.delta.y+e.ay)),e.ax||e.ay?(e.frameTime=
k,e.anim=a.util.requestAnimationFrame(r,null,b,d,c,d.start,d.current),m=!0):delete d.kinetic);if(!m){var f=d.dragCount?'dragend':'panend';n(b,f,d,c);}if(!d.dragCount&&(!d.press||!d.press.started)&&1E3>t)k=d.touches[0],t=Math.abs(k.dx),m=Math.abs(k.dy),60<=t&&60>m?f=0>k.dx?'swiperight':'swipeleft':60<=m&&60>t&&(f=0>k.dy?'swipeup':'swipedown'),f&&n(b,f,d,c);delete d.pan;}g(b,d,c);d.tap&&(200>d.current.time-d.tap.time&&n(b,'tap',d,c),delete d.tap);}else 1<h.length&&1>=t&&(k?(d.rotate&&(n(b,'rotatecancel',
d,c),delete d.rotate),d.pinch&&(n(b,'pinchcancel',d,c),delete d.pinch)):(d.rotate&&(n(b,'rotateend',d,c),delete d.rotate),d.pinch&&(n(b,'pinchend',d,c),delete d.pinch)));b=c.changedTouches;for(f=0;f<b.length;f++){k=b[f];for(t=0;t<h.length;t++)if(h[t].identifier===k.identifier){h.splice(t,1);break;}}delete d.distance;0==h.length&&(delete d.start,delete d.current,delete d.previous,delete d.multi,a.user.releaseTouchCapture());a.util.preventDefault(c);return!1;}},K=function(b){b=a.glob.viewNode.mousePos(b);
return{distance:0,angle:0,center:{x:b.x,y:b.y}};},H=function(b){if(0==(b.button||0)){var c=K(b),g=u(this,!0);g.start=c;g.current=c;n(this,'dragstart',g,b)&&(a.user.setMouseCapture(M,P,this),a.util.preventDefault(b));}},M=function(b){var c=K(b),g=u(this,!0),k=g.current.center;if(c.center.x!=k.x||c.center.y!=k.y)g.current=c,n(this,'dragmove',g,b);a.util.preventDefault(b);},P=function(b){var c=u(this,!0);n(this,'dragend',c,b);a.user.releaseMouseCapture();a.util.preventDefault(b);};a.Button=function(b,c,
g){a.Element.call(this,'input',g);this.dom.type='button';'string'===typeof b&&(this.dom.value=b);'string'===typeof c&&(this.dom.title=c);};l=a.subclass(a.Button,a.Element);Object.defineProperties(l,{disabled:{get:function(){return this.dom.disabled;},set:function(a){this.dom.disabled=a;}}});a.TextArea=function(b,c){a.Element.call(this,'textarea',c);'string'===typeof b&&(this.dom.value=b);};l=a.subclass(a.TextArea,a.Element);Object.defineProperties(l,{value:{get:function(){return this.dom.value;},set:function(a){this.dom.value=
a;}}});l.moveCaret=function(a){var b=this.dom;b.createTextRange?(b=b.createTextRange(),b.move('character',a),b.select()):void 0!==b.selectionStart?(b.focus(),b.setSelectionRange(a,a)):b.focus();};a.Canvas=function(c,g){a.Element.call(this,'canvas');2===arguments.length?(this.dom.width=c,this.dom.height=g):1===arguments.length&&(this.dom.width=c.clientWidth,this.dom.height=c.clientHeight,b.wrap(c).append(this));};l=a.subclass(a.Canvas,a.Element);Object.defineProperties(l,{width:{get:function(){return this.dom.width;}},
height:{get:function(){return this.dom.height;}}});var O=function(a,b,c,g,k,d){this.globalAlpha=1;void 0!==k&&(this.fillStyle=k);d?(this.strokeStyle=d,this.lineWidth=1,this.lineCap='square',this.beginPath(),this.rect(a,b,c,g),this.fill(),this.stroke(),this.closePath()):(this.lineWidth=0,this.fillRect(a,b,c,g));},R=function(a,b,c,g,k){void 0!==k&&(this.strokeStyle=k);this.lineWidth=1;this.lineCap='square';this.globalAlpha=1;this.beginPath();this.moveTo(a,b);this.lineTo(c,g);this.stroke();this.closePath();};
l.getContext=function(a){a=this.dom.getContext(a);a.oitrect=O;a.oitline=R;return a;};});OIT.extend(function(a){a.Plugin=function(a){this.prop('name',a);};a.subclass(a.Plugin);});OIT.extend(function(a){a.PluginList=function(a){this._createFn=a;this._plugins={};};a=a.subclass(a.PluginList);a.item=function(a){return this._plugins[a];};a.extend=function(a,d){if(Array.isArray(d))for(var c=Array.prototype.slice.call(arguments),f=0;f<d.length;f++)c[1]=d[f],this.extend.apply(this,c);else{if('string'===typeof d)return c=this._plugins[d],c||(c=this._createFn.apply(this,arguments))&&(this._plugins[d]=c),c&&c.extend.apply(c,arguments),c;if('object'===typeof d)for(f in c=[a,null,null],
d)c[1]=f,c[2]=d[f],this.extend.apply(this,c);}};});OIT.extend(function(a){a.glob=new a.PluginList(function(b,c,f){return new a.Global(c);});a.glob.reset=function(a){for(var b in this._plugins)this._plugins[b].reset(a);};a.Global=function(b){a.Plugin.call(this,b);};var b=a.subclass(a.Global,a.Plugin);b.extend=function(b,c,f){f=f||{};var e={_v:{value:void 0,writable:!0}};f.init&&(e.init={value:f.init});void 0!==f.def&&('function'===typeof f.def?e.defFn={value:f.def}:e.def={value:f.def});if('opt'===b&&(!0===f.pub&&(e.pub={value:f.pub}),f.legal&&(e.legal=
{value:f.legal}),f.validate&&(e.validate={value:f.validate}),f.type&&(e.type={value:f.type||'boolean'},'number'===f.type||Array.isArray(f.type)&&-1!=f.type.indexOf('number'))))'number'===typeof f.min&&(e.min={value:f.min}),'number'===typeof f.max&&(e.max={value:f.max});Object.defineProperties(this,e);b=a[b];var l=this;b['on'+c]=function(a,b){return l.listen(a,b);};Object.defineProperty(b,c,{enumerable:!0,get:function(){return void 0===l._v&&(l.init&&(l._v=l.init(a)),void 0===l._v)?l.default():l._v;},
set:function(a){l.set(a);}});};b.listen=function(a,b){void 0===b&&(b=a,a=void 0);this._listeners||(this._listeners=[]);this._listeners.push({context:a,fn:b});};b.set=function(b,c){if(b!==this._v){if(void 0!==b){var f=!0;if(this.type){var e=null===b?'null':typeof b,f=e===this.type;!f&&Array.isArray(this.type)&&(f=-1!=this.type.indexOf(e));!f&&'string'===e&&(f='color'===this.type,!f&&Array.isArray(this.type)&&(f=-1!=this.type.indexOf('color')),f&&(e='color'));f&&'color'===e?a.css.stringToColor(b)||(this.pub&&
a.document.invalidArg('setOptions',this.name,b,'Must be a CSS color string'),b=this._v):f||('null'===e?b=void 0:(this.pub&&(e=Array.isArray(this.type)?'Must be one of these types: '+JSON.stringify(this.type):'Must be of type '+this.type,a.document.invalidArg('setOptions',this.name,b,e)),b=this._v));}f&&(this.legal&&-1==this.legal.indexOf(b)?(this.pub&&a.document.invalidArg('setOptions',this.name,b,'Must be one of '+JSON.stringify(this.legal)),b=this._v):void 0!==this.min&&b<this.min?(this.pub&&a.document.invalidArg('setOptions',
this.name,b,'Using minimum value of '+this.min,!1),b=this.min):void 0!==this.max&&b>this.max?(this.pub&&a.document.invalidArg('setOptions',this.name,b,'Using maximum value of '+this.max,!1),b=this.max):this.validate&&(b=this.validate(a,this.name,b,this._v)));}if(b!==this._v){f=this._v;if('object'===this.type){this._v={};for(var l in b)b.hasOwnProperty(l)&&(this._v[l]=b[l]);}else this._v=b;if(!1!==c&&this._listeners)for(l=0;l<this._listeners.length;l++)e=this._listeners[l],e.fn.call(e.context,this._v,
f,this.name);}}};b.setProperty=function(a,b){if('object'===this.type||Array.isArray(this.type)&&-1!=this.type.indexOf('object')&&(!this._v||this._v[a]!==b))if(this._v||(this._v={}),this._v[a]!==b&&(this._v[a]=b,this._listeners))for(var f=0;f<this._listeners.length;f++){var e=this._listeners[f];e.fn.call(e.context,this._v,null,this.name);}};b.reset=function(a){this.set(void 0,a);};b.default=function(){if(void 0!==this.def)return this.def;if(void 0!==this.defFn)return this.defFn.call(this,a);};});
OIT.extend('glob',{URL:{init:function(a){return document.URL;}},baseURL:{def:function(a){return a.opt.outputBaseUrl;}},viewNode:{init:function(a){if(a=a.glob.rootNode)return a.childByClass('oit-view');}},rootNode:{init:function(a){if((a=a.doc.byClass('oit-view-root'))&&0<a.length)return a[0];}},deFeatures:{def:{zoom:!1,rotate:!1,pages:!1,fitpage:!1,highlights:!1,textselection:!1,rectselection:!1,cellselection:!1,customtextselection:!1,anchorednotes:!1}},deType:{},drawing:{},libversion:{},documentLoading:{def:!1},
documentLoaded:{def:!1},documentComplete:{def:!1},dynamicContent:{def:!1},enableRawText:{},guid:{},singlePageIndex:{},isMobile:{init:function(a){a=!1;var b=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(b)||
/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,
4)))a=!0;return a;}},isMobileOrTablet:{init:function(a){a=!1;var b=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,
4)))a=!0;return a;}},editingComment:{def:0}});OIT.extend(function(a){a.opt=new a.PluginList(function(b,d,c){return new a.Global(d);});a.opt.isPublic=function(a){return(a=this.item(a))&&a.pub;};a.opt.reset=function(b){a.util.eachSparse(this._plugins,'reset',null,b);};});
OIT.extend('opt',{disableAnimation:{pub:!0,type:'boolean',init:function(a){return a.glob.isMobileOrTablet;}},memoryModel:{pub:!0,type:'string',legal:['large','small','micro','none'],init:function(a){return a.glob.isMobileOrTablet?'small':'large';}},detectBaseUrl:{pub:!0,type:'boolean',def:!0},outputBaseUrl:{pub:!0,type:'string',def:''},centerPages:{pub:!0,type:'boolean',def:!0},redactionColor:{pub:!0,type:'color',def:'#000'},redactionFillColor:{pub:!0,type:'color',def:null},showHighlightLabels:{pub:!0,
type:'boolean',def:!0},highlightLabelFontFamily:{pub:!0,type:'string',def:null},highlightLabelFontSize:{pub:!0,type:'string',def:null},highlightActivationBoxColor:{pub:!0,type:['color','null'],def:null},redactionMode:{pub:!0,type:'string',legal:['simple','compound','hybrid'],def:'hybrid'},contentTimeout:{pub:!0,type:'number',min:1,def:2E4},doubleClickInterval:{pub:!0,type:'number',def:500,min:1,max:1E4},removeExtraEmailHeaders:{pub:!0,type:'boolean',def:!1},emailHeaderStyle:{pub:!0,type:'object',
def:null},zoom:{type:'number',def:1,min:0.1,max:40},zoomMode:{type:['string','null'],legal:[null,'page','pagewidth','pageheight','mobile'],init:function(a){return a.glob.isMobileOrTablet?'mobile':null;}},rotation:{type:'number',legal:[0,90,180,270],def:0},selectionMode:{type:'string',legal:['text','rect','cell','none'],def:'text',validate:function(a,b,d,c){return a.selection.validateMode(d,c);}},nochrome:{pub:!0,type:'boolean',def:!1,init:function(a){return a.glob.isMobileOrTablet?!0:!1;}},scrollMode:{pub:!0,
type:'string',legal:['single','vertical','hswipe','vswipe'],def:'vertical',init:function(a){return a.glob.isMobileOrTablet?'hswipe':'vertical';}},showSlideNotes:{pub:!0,type:'boolean',def:!1},presentationMode:{pub:!0,type:'string',legal:['normal','slideshow'],def:'normal'}});OIT.extend(function(a){a.Event=function(b,c,d){a.Plugin.call(this,d);Object.defineProperties(this,{host:{value:b},dispatcher:{value:c}});};var b=a.subclass(a.Event,a.Plugin),d=function(a,b,c){if(a=a._int)for(var d=0;d<a.length;d++){var h=a[d];if(h.fn===b&&(void 0===c||h.context===c))return d;}return-1;},c=function(a,b){var c=a._pub;return c?c.indexOf(b):-1;},f=function(b,c,h,e){void 0===h&&(h=c,c=void 0);if(-1===d(b,h,c)){var t=!b.hasListeners(),f={context:c,fn:h};!0===e&&(f.listenOnce=!0);b._int||b.prop('_int',
[],!0);b._int.push(f);t&&b.isSystemEvent()&&b.dispatcher.addElementListeners(b.name);b.onListen&&b.onListen.call(a,b,h,c);}},e=function(b,c){-1!=c&&(b.dispatching?(b._xint||(b._xint=[]),b._xint.push(c)):(b._int.splice(c,1),!b.hasListeners()&&b.isSystemEvent()&&b.dispatcher.removeElementListeners(b.name),b.onUnlisten&&b.onUnlisten.call(a,b)));},l=function(b,c){-1!=c&&(b.dispatching?(b._xpub||(b._xpub=[]),b._xpub.push(c)):(b._pub.splice(c,1),!b.hasListeners()&&b.isSystemEvent()&&b.dispatcher.removeElementListeners(b.name),
b.onRemove&&b.onRemove.call(a,b)));},p=function(){var b;this.detail&&(b=this.detail.apply(a,arguments));var c=this.systemEventName||this.name,d=document.createEvent('CustomEvent');d.initCustomEvent(c,!0,!0,b);return d;},h=function(){var a=!0;this.dispatching=!0;var b=this._int;if(b)for(var c=b.length,d=0;d<c;d++){var h=b[d];!1===h.fn.apply(h.context,arguments)&&(a=!1);h.listenOnce&&e(this,d);}b=this._pub;if(a&&b){a=p.apply(this,arguments);c=b.length;for(d=0;d<c;d++)b[d].call(void 0,a);a=!a.defaultPrevented;}a&&
this._def&&(a=this._def.fn.apply(this._def.context,arguments));this.dispatching=!1;if(this._xint){for(d=this._xint.length-1;0<=d;d--)e(this,this._xint[d]);delete this._xint;}if(this._xpub){for(d=this._xpub.length-1;0<=d;d--)l(this,this._xpub[d]);delete this._xpub;}return a;};b.extend=function(a,b,c){c&&(!0===c.pub&&(this.prop('pub',!0),c.detail&&this.prop('detail',c.detail)),!0===c.systemEvent&&this.prop('systemEventName','_'+b),0<c.delay&&this.prop('delay',c.delay),this.prop('onListen',c.onListen),
this.prop('onUnlisten',c.onUnlisten),this.prop('onAdd',c.onAdd),this.prop('onRemove',c.onRemove),Object.defineProperty(this.dispatcher,b,{enumerable:!0,value:this}));};b.enable=function(){this.disabled=!1;};b.disable=function(){this.disabled=!0;};b.hasListeners=function(){return!!this._def||this._int&&0<this._int.length||this._pub&&0<this._pub.length;};b.isSystemEvent=function(){return!!this.systemEventName;};b.setDefaultListener=function(b,c){if(b){this._def&&this.setDefaultListener(null);var d=!this.hasListeners();
this._def={context:c,fn:b};d&&this.isSystemEvent()&&this.dispatcher.addElementListeners(this.name);this.onListen&&this.onListen.call(a,this,b,c);}else this._def&&(delete this._def,!this.hasListeners()&&this.isSystemEvent()&&this.dispatcher.removeElementListeners(this.name),this.onUnlisten&&this.onUnlisten.call(a,this));};b.listen=function(a,b){f(this,a,b,!1);};b.listenOnce=function(a,b){f(this,a,b,!0);};b.unlisten=function(a){e(this,d(this,a));};b.addPublicListener=function(b){if(this.pub&&'function'===
typeof b&&-1===c(this,b)){var k=!this.hasListeners();this._pub||this.prop('_pub',[],!0);this._pub.push(b);k&&this.isSystemEvent()&&this.dispatcher.addElementListeners(this.name);this.onAdd&&this.onAdd.call(a,this,b);}};b.removePublicListener=function(a){l(this,c(this,a));};b.dispatch=function(){this.logDispatch&&this.logDispatch.apply(this,arguments);if(this.hasListeners()&&!this.disabled){if(!this.delay)return h.apply(this,arguments);this._dispatchTimer&&a.util.clearTimeout(this._dispatchTimer);this._ddArgs=
arguments;this._dispatchTimer=a.util.setTimeout(q,this.delay,this);}return!0;};var q=function(){h.apply(this,this._ddArgs);delete this._ddArgs;};b.dispatchTo=function(a,b){var c=p.apply(this,b);a.call(void 0,c);return!c.defaultPrevented;};b.reset=function(){this._int&&(this._int=[]);this._pub&&(this._pub=[]);delete this._def;};});OIT.extend(function(a){var b=a.doc,d=function(b,c,d){return new a.Event(this._host,this,c);};a.EventDispatcher=function(c,f){a.PluginList.call(this,d);this.name=f;this._host=c;this._eventElements=[];var p=this;this.onSystemEvent=function(c){var d=p[c.type];if(d&&d.hasListeners()&&!d.disabled){var e;a:{e=c.currentTarget;for(e=b.unwrap(e);e;){var k=b.data(e,'dispatcherData');if(k){e=k;break a;}e=e.parentNode;}e=void 0;}if(e)return e[1]=c,(d=d.dispatch.apply(d,e))||a.util.preventDefault(c),e[1]=null,d;}return!0;};
this.onTap=function(a){var b,c=a.srcEvent;b=a.center;a=b.x;var k=b.y,d=b.x,e=b.y;document.createEvent?(b=document.createEvent('MouseEvent'),b.initMouseEvent('click',!0,!0,window,null,a,k,d,e,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,0,c.currentTarget)):b=new MouseEvent('click',{screenX:a,screenY:k,clientX:d,clientY:e,ctrlKey:c.ctrlKey,shiftKey:c.shiftKey,altKey:c.altKey,metaKey:c.metaKey,button:0,buttons:c.buttons,relatedTarget:c.currentTarget,region:c.region});c.currentTarget.dispatchEvent(b);};};var c=
a.subclass(a.EventDispatcher,a.PluginList);c.enable=function(){this.disabled=!1;};c.disable=function(){this.disabled=!0;};c.addElementListeners=function(a){if(this[a])for(var c=0;c<this._eventElements.length;c++){var d=this._eventElements[c];d.addEventListener(a,this.onSystemEvent,!1);if('click'===a)b.wrap(d).ontap(this,this.onTap);}};c.removeElementListeners=function(a){if(this[a])for(var b=0;b<this._eventElements.length;b++)this._eventElements[b].removeEventListener(a,this.onSystemEvent);};c.addElement=
function(a){if((a=b.unwrap(a))&&a.addEventListener&&-1==this._eventElements.indexOf(a)){this._eventElements.push(a);for(var c=[b.wrap(a),null],d=1;d<arguments.length;d++)c.push(arguments[d]);b.data(a,'dispatcherData',c);for(var h in this._plugins)if(c=this[h],c.isSystemEvent()&&c.hasListeners()&&(a.addEventListener(h,this.onSystemEvent,!1),'click'===h))b.wrap(a).ontap(this,this.onTap);}};c.removeElement=function(a){a=b.unwrap(a);var c=this._eventElements.indexOf(a);if(-1!=c){this._eventElements.splice(c,
1);b.removeData(a,'dispatcherData');for(var d in this._plugins)c=this[d],c.isSystemEvent()&&c.hasListeners()&&a.removeEventListener(d,this.onSystemEvent);}};c.eventMessage=function(){if(!this._eventMessage){for(var a in this._plugins)this._eventMessage=this._eventMessage?this._eventMessage+','+a:'Must be one of ['+a;this._eventMessage&&(this._eventMessage+=']');}return this._eventMessage;};var f=function(b,c){var d=a[b];if(d&&(d=d.on))return d[c];};a.on=function(a,b,c,d){(a=f(a,b))&&a.listen(c,d);};a.off=
function(a,b,c){(a=f(a,b))&&a.unlisten(c);};a.dispatch=function(a,b){var c=f(a,b);return c?2<arguments.length?c.dispatch.apply(c,Array.prototype.slice.call(arguments,2)):c.dispatch.apply(c):!0;};a.enableEvent=function(a,b){var c=f(a,b);c&&c.enable();};a.disableEvent=function(a,b){var c=f(a,b);c&&c.disable();};a.globalEvents=new a.EventDispatcher(a,'globalEvents');});OIT.extend('globalEvents',{install:{},init:{}});OIT.extend(function(a){var b='mousedown mouseup click dblclick contextmenu mousemove mouseover mouseout touchstart touchend touchmove touchcancel'.split(' ');a.mod=new a.PluginList(function(b,d,e){b=new a.Module(d);return a[d]=b;});a.Module=function(b){a.Plugin.call(this,b);};var d=a.subclass(a.Module,a.Plugin);d.extend=function(c,d,e){this.def=e;a.globalEvents.install.listen(this,this.install);c=e.events;e=e.userEventDef;if(c||e){this.on||(this.on=new a.EventDispatcher(this,this.name));if(c)for(var l in c)d=
c[l],this.on.extend.call(this.on,'on',l,d),d&&d.pub&&(this.hasPublicEvents=!0);if(e){e.systemEvent=!0;for(l=0;l<b.length;l++)this.on.extend.call(this.on,'on',b[l],e);e.pub&&(this.hasPublicEvents=!0);}}};d.install=function(a){var b=this,d=this.def;delete this.def;d.install&&d.install(a,this);if(b.hasPublicEvents||d.exports&&0<d.exports.length){OIT[b.name]||(a.export(b.name,{}),b.publicName='OIT.'+b.name);a={};b.hasPublicEvents&&(b.addEventListener||(a.addEventListener={value:function(a,c){var d=b.on[a];
d?d.addPublicListener(c):b.invalidArg('addEventListener','name',a,b.on.eventMessage());}}),b.removeEventListener||(a.removeEventListener={value:function(a,c){var d=b.on[a];d?d.removePublicListener(c):b.invalidArg('removeEventListener','name',a,b.on.eventMessage());}}));if(d.exports&&0<d.exports.length)for(var l=0;l<d.exports.length;l++){var p=d.exports[l],h=b[p];void 0!==h&&(a||(a={}),a[p]={value:h});}Object.defineProperties(OIT[b.name],a);}};});OIT.extend(function(a){a.de=new a.PluginList(function(b,c,f){return new a.DisplayEngine(c);});a.DisplayEngine=function(b){a.Plugin.call(this,b);};var b=a.subclass(a.DisplayEngine,a.Plugin);b.extend=function(b,c,f){this.def=f;a.globalEvents.install.listen(this,this.install);};b.install=function(a){var b=this.def;delete this.def;b.install&&b.install(a,this);};b.init=function(a){if(a.isPending()){var b=this;a.load(!0,!0,function(){b.load(a);});}else this.load(a);};b.load=function(a){};b.unload=function(){};
b.topPageIndex=function(){return a.pages.current();};b.bottomPageIndex=function(){return a.pages.current();};b.maxPageWidth=function(){return a.pages.maxWidth();};b.maxPageHeight=function(){return a.pages.maxHeight();};b.padding=function(){return{left:0,top:0,right:0,bottom:0};};b.margin=function(){return{left:0,top:0,right:0,bottom:0};};b.scrollOffset=function(){return a.glob.viewNode.scroll();};b.getSelectedText=function(){return a.doc.selectedText();};b.select=function(a){return!1;};b.keydown=function(a){return!0;};
b.showHidden=function(a){};b.loadRange=function(a,b){b&&b(a);};b.moveto=function(a,b,f){return!1;};b.pageRange=function(a,b){};b.pageRect=function(b,c,f){return a.pages.elementRect(a.pages.page(b),c);};b.rangeRect=function(a,b,f,e){};b.rangeFromRect=function(a,b,f,e,l,p,h){};b.extendRange=function(a,b,f,e){};b.moveAnchor=function(a,b,f,e){return!1;};b.incrementSelection=function(a,b,f,e,l){return!1;};b.layoutChanged=function(a){};b.update=function(a){};});OIT.extend(function(a){var b='zoom rotate showhidden pages fitpage highlights textselection rectselection rectredaction cellselection customtextselection anchorednotes'.split(' '),d=a.fmt=new a.PluginList(function(b,d,e){return new a.FormatType(d);});d.createDisplay=function(b){if(b=d.item(b))return a.de.item(b.de);};d.features=function(a){if(a=d.item(a))return a.features;};a.FormatType=function(b){a.Plugin.call(this,b);};a.subclass(a.FormatType,a.Plugin).extend=function(a,d,e){this.de=e.de;a=this.features=
{};for(d=0;d<b.length;d++){var l=b[d],p=e[l];void 0===p&&(p=!0);a[l]=p;}};});OIT.extend('mod','css',{install:function(a,b){var d=a.math,c=function(a){return'string'===typeof a;},f={aliceblue:'#f0f8ff',antiquewhite:'#faebd7',aqua:'#00ffff',aquamarine:'#7fffd4',azure:'#f0ffff',beige:'#f5f5dc',bisque:'#ffe4c4',black:'#000000',blanchedalmond:'#ffebcd',blue:'#0000ff',blueviolet:'#8a2be2',brown:'#a52a2a',burlywood:'#deb887',cadetblue:'#5f9ea0',chartreuse:'#7fff00',chocolate:'#d2691e',coral:'#ff7f50',cornflowerblue:'#6495ed',cornsilk:'#fff8dc',crimson:'#dc143c',cyan:'#00ffff',darkblue:'#00008b',
darkcyan:'#008b8b',darkgoldenrod:'#b8860b',darkgray:'#a9a9a9',darkgreen:'#006400',darkkhaki:'#bdb76b',darkmagenta:'#8b008b',darkolivegreen:'#556b2f',darkorange:'#ff8c00',darkorchid:'#9932cc',darkred:'#8b0000',darksalmon:'#e9967a',darkseagreen:'#8fbc8f',darkslateblue:'#483d8b',darkslategray:'#2f4f4f',darkturquoise:'#00ced1',darkviolet:'#9400d3',deeppink:'#ff1493',deepskyblue:'#00bfff',dimgray:'#696969',dodgerblue:'#1e90ff',firebrick:'#b22222',floralwhite:'#fffaf0',forestgreen:'#228b22',fuchsia:'#ff00ff',
gainsboro:'#dcdcdc',ghostwhite:'#f8f8ff',gold:'#ffd700',goldenrod:'#daa520',gray:'#808080',green:'#008000',greenyellow:'#adff2f',honeydew:'#f0fff0',hotpink:'#ff69b4',indianred:'#cd5c5c',indigo:'#4b0082',ivory:'#fffff0',khaki:'#f0e68c',lavender:'#e6e6fa',lavenderblush:'#fff0f5',lawngreen:'#7cfc00',lemonchiffon:'#fffacd',lightblue:'#add8e6',lightcoral:'#f08080',lightcyan:'#e0ffff',lightgoldenrodyellow:'#fafad2',lightgray:'#d3d3d3',lightgreen:'#90ee90',lightpink:'#ffb6c1',lightsalmon:'#ffa07a',lightseagreen:'#20b2aa',
lightskyblue:'#87cefa',lightslategray:'#778899',lightsteelblue:'#b0c4de',lightyellow:'#ffffe0',lime:'#00ff00',limegreen:'#32cd32',linen:'#faf0e6',magenta:'#ff00ff',maroon:'#800000',mediumaquamarine:'#66cdaa',mediumblue:'#0000cd',mediumorchid:'#ba55d3',mediumpurple:'#9370db',mediumseagreen:'#3cb371',mediumslateblue:'#7b68ee',mediumspringgreen:'#00fa9a',mediumturquoise:'#48d1cc',mediumvioletred:'#c71585',midnightblue:'#191970',mintcream:'#f5fffa',mistyrose:'#ffe4e1',moccasin:'#ffe4b5',navajowhite:'#ffdead',
navy:'#000080',oldlace:'#fdf5e6',olive:'#808000',olivedrab:'#6b8e23',orange:'#ffa500',orangered:'#ff4500',orchid:'#da70d6',palegoldenrod:'#eee8aa',palegreen:'#98fb98',paleturquoise:'#afeeee',palevioletred:'#db7093',papayawhip:'#ffefd5',peachpuff:'#ffdab9',peru:'#cd853f',pink:'#ffc0cb',plum:'#dda0dd',powderblue:'#b0e0e6',purple:'#800080',red:'#ff0000',rosybrown:'#bc8f8f',royalblue:'#4169e1',saddlebrown:'#8b4513',salmon:'#fa8072',sandybrown:'#f4a460',seagreen:'#2e8b57',seashell:'#fff5ee',sienna:'#a0522d',
silver:'#c0c0c0',skyblue:'#87ceeb',slateblue:'#6a5acd',slategray:'#708090',snow:'#fffafa',springgreen:'#00ff7f',steelblue:'#4682b4',tan:'#d2b48c',teal:'#008080',thistle:'#d8bfd8',tomato:'#ff6347',turquoise:'#40e0d0',violet:'#ee82ee',wheat:'#f5deb3',white:'#ffffff',whitesmoke:'#f5f5f5',yellow:'#ffff00',yellowgreen:'#9acd32'},e=1/6,l=1/3,p=2/3,h=function(a,b,c){0>c?c+=1:1<c&&(c-=1);c<e?a+=6*(b-a)*c:0.5>c?a=b:c<p&&(a+=6*(b-a)*(p-c));return 255*a|0;},q=[{property:'webkit',css:'-webkit-'},{property:'Moz',
css:'-moz-'},{property:'ms',css:'-ms-'},{property:'O',css:'-o-'}],m=function(a,b,d){var k=document.documentElement;if(c(k.style[a]))return b;if(!1!==d){a=a.charAt(0).toUpperCase()+a.slice(1);for(d=0;d<q.length;d++)if(c(k.style[q[d].property+a]))return q[d].css+b;}},k=function(a,b){for(var c,d=document.createElement('div'),k=0;k<b.length;k++)if(d.style[a]=b[k],d.style[a]===b[k]){c=b[k];break;}return c;};b.nameMap={transform:m('transform','transform'),'transform-origin':m('transformOrigin','transform-origin')};
b.cursor={grab:k('cursor',['grab','-webkit-grab','-moz-grab','move']),grabbing:k('cursor',['grabbing','-webkit-grabbing','-moz-grabbing','move'])};var z=function(a,b){if(-1!=b)for(var c=a.chars;b<c.length;b++){var d=c[b];if(' '!==d&&'\n'!==d&&'\r'!==d&&'\t'!==d){'/'===d&&'*'===c[b+1]&&(c=a.string.indexOf('*/',b+2),b=-1==c?a.string.length:c+2);break;}}return b;},s=function(a,b,c){return-1!=b&&a.chars[b]!==c?-1:++b;};b.parse=function(a){var b;if(a){b={};a={string:a,chars:a.split('')};for(var c=0;-1!=c&&
c<a.chars.length;){var d=a,k=c,c=b,h={},k=z(d,k);if(-1!=k){for(var e=d.chars,n=void 0,n=k;n<e.length;n++){var f=e[n];if(!('a'<=f&&'z'>=f)&&!('A'<=f&&'Z'>=f)&&!('0'<=f&&'9'>=f)&&'-'!==f&&'_'!==f)break;}n>k?(h.name=d.string.substring(k,n),k=n):k=-1;}k=z(d,k);k=s(d,k,':');k=z(d,k);if(-1!=k){e=d.chars;n=void 0;for(n=k;n<e.length;n++){f=e[n];if('!'===f||';'===f)break;if('"'===f||'\''===f||'('===f){'('===f&&(f=')');for(var g=n+1;g<e.length;g++){var r=e[g];if(r===f){n=g;break;}else if('\\'===r){r=e[++g];if('0'<=
r&&'9'>=r||'a'<=r&&'f'>=r||'A'<=r&&'F'>=r){do r=e[++g];while('0'<=r&&'9'>=r||'a'<=r&&'f'>=r||'A'<=r&&'F'>=r);}n=g;break;}}}}n>k?(h.value=d.string.substring(k,n),k=n):k=-1;}k=z(d,k);e=h;-1!=k&&'!important'===d.string.substring(k,k+10)&&(e.important=!0,k+=10);k=z(d,k);k<d.chars.length&&(k=s(d,k,';'));-1!=k&&(c[h.name]=h.value);c=k;}}return b;};b.compose=function(a){var b=[];if(a)for(var c in a)a.hasOwnProperty(c)&&b.push(c,':',a[c],';');return b.join('');};b.get=function(a,b){if(a&&c(a)&&c(b)){for(var d=
0;;){d=a.indexOf(b,d);if(-1==d||0==d)break;var k=a.charAt(d-1);if(';'==k||' '==k)break;d++;}if(-1!=d){for(d+=b.length;' '===a.charAt(d);)d++;if(':'===a.charAt(d)){for(d++;' '===a.charAt(d);)d++;k=a.indexOf(';',d);-1===k&&(k=a.length);for(;k>d&&' '===a.charAt(k-1);)k--;return a.substring(d,k);}}}};b.colorToString=function(){var a=arguments;if(1==a.length){a=a[0];if(c(a))a=b.stringToColor(a);else if(void 0==a.r||void 0==a.g||void 0==a.b)a=void 0;if(a)return b.colorToString(a.r,a.g,a.b,a.a);}else if(3==
a.length||4==a.length){var k=d.round(d.clamp(a[0],0,255)),h=d.round(d.clamp(a[1],0,255)),e=d.round(d.clamp(a[2],0,255)),f=1;4==a.length&&void 0!==a[3]&&(f=d.clamp(a[3],0,1));if(1!=f)return'rgba('+k+','+h+','+e+','+f+')';k=k.toString(16);h=h.toString(16);e=e.toString(16);2>k.length&&(k='0'+k);2>h.length&&(h='0'+h);2>e.length&&(e='0'+e);return'#'+k+h+e;}};b.stringToColor=function(a){if(a){var c;if(0==a.indexOf('#')){if(c={r:parseInt(a.substring(1,3),16),g:parseInt(a.substring(3,5),16),b:parseInt(a.substring(5,
7),16),a:1},isNaN(c.b)){var k=a.substring(1,2),e=a.substring(2,3);a=a.substring(3,4);e+=e;a+=a;c.r=parseInt(k+k,16);c.g=parseInt(e,16);c.b=parseInt(a,16);}}else if(0==a.indexOf('rgba(')||0==a.indexOf('rgb(')){e=a.replace(/[^\d.,]/g,'').split(',');for(k=0;k<e.length;k++)e[k]=Number(e[k]);for(;3>e.length;)e.push(0);for(;4>e.length;)e.push(1);c={r:e[0],g:e[1],b:e[2],a:e[3]};}else if(0==a.indexOf('hsla(')||0==a.indexOf('hsl(')){c=a.replace(/[^\d.,]/g,'').split(',');for(k=0;k<c.length;k++)c[k]=Number(c[k]);
for(;3>c.length;)c.push(0);for(;4>c.length;)c.push(1);k=c[0];e=c[1];a=c[2];k/=360;e/=100;a/=100;if(0==e)e=a=k=255*a|0;else{var m=0.5>a?a*(1+e):a+e-a*e,u=2*a-m,e=h(u,m,k+l);a=h(u,m,k);k=h(u,m,k-l);}c={r:e,g:a,b:k,a:c[3]};}else if(k=f[a.toLowerCase()])return b.stringToColor(k);if(c)return c.r=d.clamp(c.r,0,255),c.g=d.clamp(c.g,0,255),c.b=d.clamp(c.b,0,255),c.a=d.clamp(c.a,0,1),c;}};b.rgbStringFromString=function(a){if(0==a.indexOf('#'))return a;if(0==a.indexOf('rgba(')||0==a.indexOf('rgb('))if(a=b.stringToColor(a))return b.colorToString(a.r,
a.g,a.b);};b.opacityFromString=function(a){return 0==a.indexOf('rgba')&&(a=b.stringToColor(a))?a.a:1;};b.blendColors=function(a,c){var k=b.stringToColor(a),d=b.stringToColor(c);if(!k||!d)return a;d.a=1-k.a;return b.colorToString(k.r*k.a+d.r*d.a,k.g*k.a+d.g*d.a,k.b*k.a+d.b*d.a);};b.validateLength=function(a){if(void 0!==a&&null!==a&&''!=a){var b=Number(a);if(isNaN(b)){if(a.match(/(\d|\.)+(em|ex|px|in|pt|pc|mm|cm|\%)/))return a;}else return b+'px';}else return null;};}});OIT.extend(function(a){OIT.local||a.export('local',{CANCEL:'Cancel',DISCARD_CHANGES:'Discard changes',DOCUMENT_ERROR:'Error occurred, document incomplete.',EMAIL_ATTACHMENTS:'Attachments',EMAIL_CALENDAREXCEPTIONS:'Calendar Exceptions',EMAIL_CC:'CC',EMAIL_BCC:'BCC',EMAIL_FROM:'From',EMAIL_TO:'To',EMAIL_DATE:'Sent',EMAIL_TOPIC:'Topic',EMAIL_PRIORITY:'Priority',EMAIL_IMPORTANCE:'Importance',EMAIL_OWNER:'Owner',EMAIL_STATUS:'Status',EMAIL_PERCENT:'Percent Complete',EMAIL_STARTDATE:'Start Date',EMAIL_ENDDATE:'End Date',
EMAIL_DUEDATE:'Due Date',EMAIL_CREATED:'Created',EMAIL_CATEGORY:'Categories',EMAIL_NAME:'Name',EMAIL_FULLNAME:'Full Name',EMAIL_FIRST:'First',EMAIL_LAST:'Last',EMAIL_MIDDLE:'Middle',EMAIL_SUFFIX:'Suffix',EMAIL_TITLE:'Title',EMAIL_FILEAS:'File as',EMAIL_DISPLAYAS:'Display as',EMAIL_COMPANY:'Company',EMAIL_JOBTITLE:'Job Title',EMAIL_BPHONE:'Business Phone',EMAIL_BADDRESS:'Business Address',EMAIL_FAX:'Business Fax',EMAIL_EMAIL:'Email Address',EMAIL_HPHONE:'Home Phone',EMAIL_HADDRESS:'Home Address',EMAIL_MOBILE:'Mobile',
EMAIL_IM:'IM',EMAIL_WEBPAGE:'Webpage',EMAIL_ENTRYTYPE:'Entry Type',EMAIL_STARTTIME:'Start Time',EMAIL_ENDTIME:'End Time',EMAIL_DURATION:'Duration',EMAIL_REQATTEND:'Required Attendees',EMAIL_OPTATTEND:'Optional Attendees',EMAIL_LOCATION:'Location',EMAIL_RECEIVED:'Received',EMAIL_RECURTYPE:'Recurrence Type',EMAIL_RECURRANGE:'Recurrence Range',EMAIL_SUBJECT:'Subject',LABEL_SEPARATOR:':',NO:'No',OK:'OK',PAGE_DOWN:'Next Page',PAGE_UP:'Previous Page',PLEASE_WAIT:'Please wait',PLEASE_WAIT_CONVERTING:'Document conversion in progress...',
PLEASE_WAIT_DOWNLOADING:'Loading document, please wait',PLEASE_WAIT_INITIALIZING:'Please wait while your<br>document is loaded...',PREPARING_TO_PRINT:'Preparing to print...',SAVE_CHANGES:'Save changes',SHOWDETAILS:'Show Details',HIDEDETAILS:'Hide Details',YES:'Yes'});});OIT.extend('mod','ajax',{install:function(a,b){var d=a.util,c=[],f=Date.now(),e=function(a,b){var c=a[b];if(c){var d=Array.prototype.slice.call(arguments,2);a.args&&(d=d.concat(a.args));c.apply(a.context,d);}};b.start=function(a){var b=a.url;if(window.XMLHttpRequest&&b){var l={request:new XMLHttpRequest,context:null},m;for(m in a)l[m]=a[m];!1===a.cache&&(b=-1!=b.indexOf('?')?b+'&':b+'?',b+='_='+ ++f);l.request.onreadystatechange=function(){if(!l.aborted)switch(l.request.readyState){case 2:l.contentLength=
Number(l.request.getResponseHeader('Content-Length'));e(l,'loading',l.url,l.contentLength,'');break;case 3:e(l,'loading',l.url,l.contentLength,'unknown'!=typeof l.request.responseText?l.request.responseText:void 0);break;case 4:var a='unknown'!=typeof l.request.responseText?l.request.responseText:void 0,b=l.request.status;void 0===l.contentLength&&(l.contentLength=a.length);200===b?e(l,'success',l.url,l.contentLength,a):e(l,'error',l.url,b);e(l,'complete',l.url,l.contentLength,a,b);d.remove(c,l);}};
l.request.open('GET',b,!0);l.request.send();c.push(l);return l;}};var l=function(a){a.aborted=!0;a.request&&a.request.abort();};b.abort=function(a){a?(d.remove(c,a),l(a)):(d.each(c,l),c=[]);};}});OIT.extend('mod','math',{install:function(a,b){b.round=function(a,b){return b&&1<b?Math.round(a*b)/b:Math.floor(0>a?a-0.5:a+0.5);};b.clamp=function(a,b,f){a<b?a=b:a>f&&(a=f);return a;};b.distanceBetweenPoints=function(a,c,f,e){if(a==f&&c==e)return 0;a=f-a;c=e-c;return b.round(Math.sqrt(a*a+c*c));};b.angleBetweenPoints=function(a,b,f,e){return a==f&&b==e?0:Math.atan2(b-e,f-a);};b.normalizeAngle=function(a,b){if('deg'===b)a%=360,0>a&&(a+=360);else{var f=Math.PI,e=2*f;a%=e;a<-f?a+=e:a>f&&(a-=e);}return a;};
b.centroid=function(a){if(a){if(1==a.length){var b=a[0];return{x:b.x,y:b.y};}if(2==a.length){var b=a[0],f=a[1];return{x:(b.x+f.x)/2,y:(b.y+f.y)/2};}if(2<a.length){for(var b={x:0,y:0},e=0,l=a.length-1,p=0;p<a.length;p++){var f=a[p],h=p<l?a[p+1]:a[0],q=f.x,f=f.y,m=h.x,h=h.y,k=q*h-m*f,e=e+k;b.x+=(q+m)*k;b.y+=(f+h)*k;}e*=3;b.x/=e;b.y/=e;return b;}}};b.rotatePoints=function(a,b,f){var e=Math.cos(f);f=Math.sin(f);for(var l=0;l<a.length;l++){var p=a[l].x-b.x,h=a[l].y-b.y;a[l].x=b.x+p*e+h*f;a[l].y=b.y+-p*f+h*
e;}};b.radians=function(a){return a*Math.PI/180;};b.degrees=function(a){return 180*a/Math.PI;};b.approxEqual=function(a,b,f){void 0===f&&(f=1.01);return(a>b?Math.abs(a/b):Math.abs(b/a))<=f;};}});OIT.extend('mod','util',{events:{fontload:{}},install:function(a,b){for(var d=a.glob,c=a.doc,f='ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split(''),e=['serif','sans-serif','monospace','cursive','fantasy'],l={},p=0,h,q=[],m=[],k=[],z=window.requestAnimationFrame,s=window.cancelAnimationFrame,t=0,v=['ms','moz','webkit','o'],y=0;y<v.length&&!z;++y)z=window[v[y]+'RequestAnimationFrame'],s=window[v[y]+'CancelAnimationFrame']||window[v[y]+'CancelRequestAnimationFrame'];z||(z=function(a,b){var c=(new Date).getTime(),
k=Math.max(0,16-(c-t)),d=window.setTimeout(function(){a(c+k);},k);t=c+k;return d;});s||(s=function(a){clearTimeout(a);});b.abortTimers=function(){for(var a=0;a<q.length;a++)window.clearInterval(q[a].id);q=[];for(a=0;a<m.length;a++)window.clearTimeout(m[a].id);m=[];for(a=0;a<k.length;a++)s.call(window,k[a].id);k=[];};var w=function(a,b,c,k){var d=0;k={fn:a[d++],remove:!!k};b&&(k.timeout=a[d++]);k.context=a[d++];c&&(k.args=[0],k.ts=!0);a.length>d&&(a=Array.prototype.slice.call(a,d),k.args=k.args?k.args.concat(a):
a);return k;},x=function(c,k,d){try{c.remove&&b.remove(k,c),c.ts&&(c.args[0]=d),c.fn.apply(c.context,c.args);}catch(h){a.logDebugError&&a.logDebugError('Error in asynchronous timer function: '+h.message);}};b.setInterval=function(a,b,c){var k=w(arguments,!0,!1,!1);q.push(k);k.id=window.setInterval(function(){x(k,q);},k.timeout);return k.id;};b.clearInterval=function(a){window.clearInterval(a);b.removeByProperty(q,'id',a);};b.setTimeout=function(a,b,c){var k=w(arguments,!0,!1,!0);m.push(k);k.id=window.setTimeout(function(){x(k,
m);},b);return k.id;};b.clearTimeout=function(a){window.clearTimeout(a);b.removeByProperty(m,'id',a);};b.requestAnimationFrame=function(a,b){for(var c=0;c<k.length;c++){var d=k[c];if(d.fn===a&&d.context===b)return d.id;}d=w(arguments,!1,!0,!0);k.push(d);d.id=z.call(window,function(a){x(d,k,a);});return d.id;};b.cancelAnimationFrame=function(a){s.call(window,a);b.removeByProperty(k,'id',a);};b.getTextRoot=function(a){for(;a&&!c.isElement(a);)a=a.parentNode;var b;if(a){a=c.wrap(a);var k=c.byId('oit-maildata');
if(k&&(a.isDescendantOf(k)||(k=c.byId('oit-em_allheaders'),a.isDescendantOf(k)||(k=null)),k))for(;a;){if('TD'===a.tagName){b=a;break;}if(a==k)break;a=a.parent();}b||(b=a.ancestorByClass(['oit-textfield','oit-email']));}return b?b:null;};b.preventDefault=function(a){a.stopPropagation();a.preventDefault();};b.defaultSSColHeader=function(a){if(!('number'!=typeof a||0>a)){if(26>a)return f[a];var b=a%26,c=(a-b)/26-1;if(702>a)return f[c]+f[b];a=Math.floor(c);c=a%26;return f[(a-c)/26-1]+f[c]+f[b];}};b.isFunction=
function(a){return'[object Function]'==Object.prototype.toString.call(a)?a:null;};b.isDOMRange=function(a){return a&&void 0!==a.startContainer&&void 0!==a.startOffset&&void 0!==a.endContainer&&void 0!==a.endOffset?!0:!1;};b.isDOMSelection=function(a){return a&&void 0!==a.anchorNode&&void 0!==a.anchorOffset&&void 0!==a.focusNode&&void 0!==a.focusOffset?!0:!1;};b.isRelativeURL=function(a){return!/^(?:[a-z]+:)?\/\//i.test(a);};b.concatURL=function(a,b){return a&&0!=a.length?!b||0==b.length?a:'/'==a.charAt(a.length-
1)?'/'==b.charAt(0)?a+b.substr(1):a+b:'/'==b.charAt(0)?a+b:a+'/'+b:b;};b.clone=function(a){var c;if(Array.isArray(a)){c=[];for(var k=0;k<a.length;k++)c[k]=b.clone(a[k]);}else{if(b.isFunction(a))return null;if(null==a)c=null;else switch(typeof a){case 'object':c={};for(k in a)a.hasOwnProperty(k)&&!b.isFunction(a[k])&&(c[k]=b.clone(a[k]));break;case 'string':c=new String(a);break;case 'number':case 'boolean':case 'undefined':c=a;}}return c;};b.each=function(a,b,c){u(!1,!1,null,arguments);};b.eachArgs=function(a,
b){u(!1,!1,a,b);};b.eachReverse=function(a,b,c){u(!1,!0,null,arguments);};b.eachSparse=function(a,b,c){u(!0,!1,null,arguments);};b.eachSparseArgs=function(a,b){u(!0,!1,a,b);};var u=function(a,b,c,k){var d=0;c||(c=k[d++]);if(c&&(a||0<c.length)){var h=k[d++],e=k[d++],f='string'==typeof h;f||d--;k=k.length>d?Array.prototype.slice.call(k,d):void 0;f?d=n:(d=B,k||(k=[null]));if(a)for(var l in c)c.hasOwnProperty(l)&&d(c[l],h,e,k);else if(b?(l=c.length-1,b=a=-1):(l=0,a=c.length,b=1),c.item)for(;l!=a;l+=b)d(c.item(l),
h,e,k);else for(;l!=a;l+=b)d(c[l],h,e,k);}},B=function(a,b,c,k){if(null!==a&&void 0!==a&&(null===c||void 0===c||a.filter(c)))k[0]=a,b.apply(null,k);},n=function(a,b,c,k){a&&(null===c||void 0===c||a.filter(c))&&a[b].apply(a,k);};b.arraysEqual=function(a,b){if(a===b)return!0;if(null===a||void 0===a)return null===b||void 0===b;if(null===b||void 0===b||('[object Array]'!==Object.prototype.toString.call(a)||'[object Array]'!==Object.prototype.toString.call(b))||a.length!=b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==
b[c])return!1;return!0;};b.remove=function(a,b){var c=a.indexOf(b);-1!=c&&a.splice(c,1);};b.removeByProperty=function(a,c,k){c=b.byPropertyIdx(a,c,k);-1!=c&&a.splice(c,1);};b.byProperty=function(a,c,k){c=b.byPropertyIdx(a,c,k);if(-1!=c)return a[c];};b.byPropertyIdx=function(a,b,c){if(Array.isArray(a)&&'string'===typeof b)for(var k=0;k<a.length;k++){var d=a[k];if(d&&d[b]===c)return k;}return-1;};b.stringify=function(a){return b.isDOMRange(a)?'[DOM Range]':b.isDOMSelection(a)?'[DOM Selection]':JSON.stringify(a);};
b.loadWebFont=function(a){var k=l[a];if(void 0===k){var e=d.rootNode;if(e){k=c.create('div','oit-fontpreloader');k.css('font-family',a);var n=c.create('span');k.append(n);n.html('AEIMNOTaeimnot130');e.append(k);l[a]=k;}p=0;h||(h=b.setTimeout(A,250));}};var A=function(){var a=!1,c=!1;h=void 0;for(var k in l){var d=l[k];if(d&&!0!==d){for(var n=!0,f,u=0;u<e.length;u++){d.css('font-family',k+','+e[u]);var m=d.offsetWidth;if(0<u&&m!=f){n=!1;break;}f=m;}n?(d.destroy(),c=l[k]=!0):(d.css('font-family',k),a=!0);}}if(a)if(p++,
20>p)h=b.setTimeout(A,250);else for(k in l)if((d=l[k])&&!0!==d)d.destroy(),l[k]=!1;c&&b.on.fontload.dispatch();};a.on('document','reset',function(){b.abortTimers();for(var a in l){var c=l[a];c&&!0!==c&&c.destroy();}l=[];p=0;h=void 0;q=[];m=[];k=[];});}});OIT.extend('mod','view',{exports:'attach detach fitToContainer height info load unload width'.split(' '),events:{resize:{delay:80},detach:{}},install:function(a,b){var d=a.glob,c=a.doc,f=a.opt,e=a.content,l=a.document,p=a.pages,h=a.util,q=a.dialog,m=a.ajax,k=a.css,z=OIT.local,s,t=0,v,y,w,x,u={},B,n=0,A=0,g=function(){B&&(B.hide(),B=null);};b.dispatchResize=function(){var a=d.viewNode;if(a&&(w&&r(),v!=a.clientWidth||y!=a.clientHeight))v=a.clientWidth,y=a.clientHeight,b.on.resize.dispatch();};var r=function(){if(w){var a=
w.computedStyle(),b=w.offsetWidth-parseInt(a.borderLeftWidth)-parseInt(a.borderRightWidth),a=w.offsetHeight-parseInt(a.borderTopWidth)-parseInt(a.borderBottomWidth);d.rootNode.css({width:b+'px',height:a+'px'});}};b.dispatchScroll=function(a){var b=d.viewNode;if(b&&(l.on.scrollupdate.dispatch(),b=b.scroll(),a||b.left!=A||b.top!=n)){a=b.left-A;var c=b.top-n;A=b.left;n=b.top;l.on.scroll.dispatch(a,b.left,c,b.top);}};var C=function(){I();},F=function(){},I=function(){f.memoryModel='none';for(var a=p.count(),
b=0;b<a;b++)(b=p.page(b))&&b.isPending()&&b.load(!1);},J=function(){f.nochrome?d.viewNode.addClass('oit-nochrome'):d.viewNode.removeClass('oit-nochrome');},L=function(){var a=d.rootNode;a&&(a.addClass('oit-view-root'),a=d.viewNode,a||(a=c.create('div','oit-view'),d.viewNode=a),s='oitview'+t++,a.id=s,J(),a.attr('tabindex','-1'),a.onscroll(b.dispatchScroll),b.fitToContainer());window.matchMedia&&(a=window.matchMedia('print'))&&a.addListener(function(a){a.matches&&I();});window.addEventListener('beforeprint',
C);window.addEventListener('afterprint',F);window.addEventListener('resize',b.dispatchResize);};a.globalEvents.init.listen(function(){var a=d.rootNode;if(a){var b=a.data('json'),c=a.data('icd'),k=a.data('page');if(b||c)x=a.parent();L();e.initializeContent(b,c,k);l.initializeDocument();}});b.attach=function(a){a&&(b.detach(),w=c.wrap(a),a=d.rootNode,a||(a=d.rootNode=c.create('div')),a.addClass('oit-view-embedded'),w.append(a),L());};b.detach=function(){b.unload();b.on.detach.dispatch();var a=d.rootNode;
if(a)try{a.destroy();}catch(c){}window.removeEventListener('beforeprint',C);window.removeEventListener('afterprint',F);window.removeEventListener('resize',b.dispatchResize);d.rootNode=d.viewNode=null;s=w=x=void 0;};b.load=function(a){!w&&!x?b.logError('load','Call OIT.view.attach before OIT.view.load'):(b.unload(),d.dynamicContent=!0,m.start({url:a,loading:E,success:D,error:K}),B=q.createProgressDialog(z.PLEASE_WAIT));};var E=function(a,b,c){a=c?c.length:0;B&&B.update(80*a/b);},D=function(a,c,k){c=!0;
try{0==k.length?(b.logError('load','Document is empty or is still being exported'),c=!1):c=l.installDocument(a,k);}catch(d){b.logError('load',d.message),c=!1;}c||g();},K=function(a){b.logError('load','Fatal error in OIT.view.load: unable to retrieve document from the server (error '+a+')');g();};b.unload=function(){l.unload();c.reset();};b.fitToContainer=function(){w&&(r(),b.dispatchResize());};b.width=function(a){a=k.validateLength(a);null!==a&&(w&&w.css('width',a),d.rootNode.css('width',a),b.dispatchResize());
return d.rootNode.offsetWidth;};b.height=function(a){a=k.validateLength(a);null!==a&&(w&&w.css('height',a),d.rootNode.css('height',a),b.dispatchResize());return d.rootNode.offsetHeight;};b.info=function(){var a=h.clone(u);a.libversion=d.libversion?h.clone(d.libversion):'Unknown';return a;};d.onviewNode(function(a,b){b&&b.destroy();if(a){for(var c=d.rootNode,k=c.childByClass('oit-toolframe');k;){k=k.childByClass('oit-toolcontent');if(!k)break;c=k;k=c.childByClass('oit-toolframe');}c&&c.append(a);}});a.on('document',
'reset',function(){g();y=v=void 0;u={};A=n=0;});a.on('content','data',function(a,b,c){a.info&&(u=a.info,u.fi||(u.fi=1999),u.fistring||(u.fistring='Unknown'),u.product||(u.product='Outside In Technology'),u.version||(u.version='Unknown'));b&&g();});f.onnochrome(J);}});OIT.extend('mod','dialog',{install:function(a,b){var d=a.glob,c=a.doc,f=a.util,e=a.pages,l=[],p=null,h=!1,q,m=!1;b.createProgressDialog=function(a,b){var c={dialog:null,text:null,ticks:null,spinner:null,percentDone:0,active:!1,suppressed:!1,message:a,showTicks:b,display:z,update:s,hide:v};l.push(c);performance&&performance.now?(c.startTime=performance.now(),c.interval=f.setInterval(k,200,c)):c.display();return c;};var k=function(){var a=performance.now()-this.startTime,b=!1;0<this.percentDone?(a=100*
a/this.percentDone,b=1E3<=a):b=500<=a;b&&(f.clearInterval(this.interval),this.display());},z=function(){var k=l.indexOf(this);if(!this.active&&0==k&&!this.dialog)if(this.active=!0,a.dispatch('document','showmessage',this.message,!0,this.showTicks)){this.suppressed=!1;b.showModalOverlay(!0,200);if(k=d.rootNode){this.dialog=c.create('div','oit-dialog oit-progress-dialog');this.text=c.create('div','oit-dialog-text');this.ticks=c.create('div','oit-progress-dialog-ticks');for(var h=0;20>h;h++)this.ticks.append(c.create('div'));
this.spinner=c.create('div','oit-pending oit-progress-dialog-ticks');this.dialog.append(this.text,this.ticks,this.spinner);k.append(this.dialog);}!1===this.showTicks?(this.ticks.css('display',null),this.spinner.css('display','block')):(this.spinner.css('display',null),this.ticks.css('display','block'));this.tickCount=void 0;this.update(this.percentDone);this.text.html(this.message);this.dialog.css({opacity:0,display:'block'});this.dialog.abortAnimation();this.dialog.animate({opacity:1,time:200,startCSS:{display:'block'}});}else this.suppressed=
!0;},s=function(b){'number'===typeof b&&(0>b?b=0:100<b&&(b=100),this.percentDone=b,this.active&&(a.dispatch('document','progress',b),this.dialog&&(b=Math.floor(21*b/100),20<b&&(b=20),b!=this.tickCount&&(this.tickCount=b,this.ticks.forChildElements(t,b)))));},t=function(a,b,c){b<c?a.addClass('filled'):a.removeClass('filled');},v=function(){this.interval&&(f.clearInterval(this.interval),this.interval=void 0);this.active&&a.dispatch('document','hidemessage');this.dialog&&(this.dialog.abortAnimation(),this.dialog.animate({opacity:0,
endCSS:{display:'none'},time:200}),b.showModalOverlay(!1,200));f.remove(l,this);};b.showModalOverlay=function(a,b){b=b||200;var k=m;if(a){if(!q){var h=d.rootNode;h&&(q=c.create('div','oit-screen'),h.append(q));}q&&!m&&(m=!0,q.abortAnimation(),q.animate({opacity:0.5,time:b,startCSS:{opacity:0,display:'block'}}));}else m&&(m=!1,q.abortAnimation(),q.animate({opacity:0,time:b,endCSS:{display:null}}));m!=k&&(k=e.activeOverlay())&&k.updateCSS();};b.modalOverlayVisible=function(){return m;};b.showMessage=function(k){h&&
b.hideMessage();if(a.dispatch('document','showmessage',k,!1,!1)){if(!p){var e=d.rootNode;e&&(p=c.create('div','oit-background-message'),e.append(p));}p&&(h||(p.abortAnimation(),p.animate({opacity:0.8,time:200,startCSS:{opacity:0,display:'block'}})),p.html(k));}h=!0;};b.hideMessage=function(){h&&(a.dispatch('document','hidemessage'),p&&(p.abortAnimation(),p.animate({opacity:0,time:200,endCSS:{display:null}})),h=!1);};b.messageVisible=function(){return h;};a.on('document','reset',function(){for(;0<l.length;)l[l.length-
1].hide();p&&p.destroy();q&&q.destroy();p=null;h=!1;q=null;m=!1;});}});OIT.extend('mod','rawtext',{events:{add:{}},install:function(a,b){var d=a.glob,c=a.content,f=a.pages,e=a.range,l=a.util,p=a.ajax,h=[],q,m,k=function(){if(void 0===q)for(var a=q=0;a<h.length;a++)h[a].text&&q++;return q;};b.find=function(a,c,k,d){if(0<h.length){!1!==k&&(k=!0);for(d='up'===d;;){if(d){var l=c,n=k,m=-1;if(0<h.length){n||(l=l.toLowerCase());for(var g=z(a);void 0!=g;){var r=h[g];if(!r.text&&(s(r,!0),!r.text))break;var t=a-r.range.acc,v;if(r.range.acc+t+l.length>r.range.accend)if(g+1>=h.length){if(b.isPending())break;}else{v=
h[g+1];if(!v.text&&(s(v,!0),!v.text))break;var q=r.text.length-l.length;n?v=r.text.substring(q)+v.text.substring(0,l.length-1):(r.lctext||(r.lctext=r.text.toLowerCase()),v.lctext||(v.lctext=v.text.toLowerCase()),v=r.lctext.substring(q)+v.lctext.substring(0,l.length-1));v=v.lastIndexOf(l);if(-1!=v){m=r.range.acc+q+v;if(m<=a)break;m=void 0;}}n?v=r.text.lastIndexOf(l,t):(r.lctext||(r.lctext=r.text.toLowerCase()),v=r.lctext.lastIndexOf(l,t));if(-1!=v){m=r.range.acc+v;break;}else if(0==g)break;g--;}}}else if(l=
c,n=k,m=-1,h){n||(l=l.toLowerCase());for(g=z(a);void 0!=g;){r=h[g];if(!r.text&&(s(r,!0),!r.text))break;t=a-r.range.acc;n?q=r.text.indexOf(l,t):(r.lctext||(r.lctext=r.text.toLowerCase()),q=r.lctext.indexOf(l,t));if(-1!=q){m=r.range.acc+q;break;}if(g+1>=h.length)break;q=h[g+1];if(!q.text&&(s(q,!0),!q.text))break;n?q=r.text.substring(t)+q.text.substring(0,l.length):(r.lctext||(r.lctext=r.text.toLowerCase()),q.lctext||(q.lctext=q.text.toLowerCase()),q=r.lctext.substring(t)+q.lctext.substring(0,l.length));
q=q.indexOf(l);if(-1!=q){m=r.range.acc+t+q;break;}g++;}}a=m;if(-1===a)break;l=a+c.length;if(f.isDocumentText(a,l-1))return e.textRange(a,l);d?a--:a++;}}};b.findBoundaryStart=function(a,b){var c;if(0<h.length)for(var k=z(a);void 0!=k;){var d=h[k];if(!d.text&&(s(d,!1),!d.text))break;for(var e=a-d.range.acc;0<e;)if(e--,-1!=b.indexOf(d.text[e])){e++;c=d.range.acc+e;break;}if(void 0!==c)break;if(0===k)break;k--;}void 0===c&&(c=a);return c;};b.findBoundaryEnd=function(a,b){var c;if(0<h.length)for(var k=z(a);void 0!=
k;){var d=h[k];if(!d.text&&(s(d,!1),!d.text))break;for(var e=a-d.range.acc,l=d.text.length-1;e<l;)if(e++,-1!=b.indexOf(d.text[e])){c=d.range.acc+e;break;}if(void 0!==c)break;if(k+1>=h.length)break;k++;}void 0===c&&(c=a);return c;};b.firstACC=function(){if(0<h.length)return h[0].range.acc;};b.lastACC=function(){if(0<h.length)return h[h.length-1].range.accend;};b.hasRawText=function(){if(0<h.length)return!0;if(!c.isPending())return!1;};b.isPending=function(){return c.isPending()?!0:k()<h.length;};b.getRawTextBlock=
function(a){if(0<=a&&a<h.length)return a=h[a],a.text||s(a,!0),a;};var z=function(a){for(var b=0;b<h.length;b++){var c=h[b].range;if(a>=c.acc&&a<c.accend)return b;}},s=function(a,b,c){if(!a.text&&a.src&&!a.loading){var h=l.concatURL(d.baseURL,a.src);k();a.loading=!0;p.start({url:h,async:b,complete:t,args:[a,c]});}},t=function(a,k,d,h,e,n){e.loading=!1;200==h?c.isICD(d)?c.processContentData(d):(e.text=d,v(e)):e.text='';q++;n&&n(e);b.on.add.dispatch(e.range.acc,e.range.accend);};b.replaceRawText=function(a){if(a&&
(m=m?m.concat(a):a,0<h.length))for(a=0;a<h.length;a++)v(h[a]);};var v=function(a){if(m&&m.length&&a.text)for(var b,c=a.range.acc,k=a.range.acc+a.text.length,d=0;d<m.length;d++)if(b=m[d],b.acc>=c&&b.acc<k||b.accend>=c&&b.accend<k){var h=b.acc-c;b=b.accend-c;b>a.text.length&&(b=a.text.length);for(var e=b-h,g='';0<e--;)g+=' ';a.text=a.text.substr(0,h)+g+a.text.substr(b);}};a.on('document','reset',function(){m=q=void 0;h=[];});a.on('content','data',function(a,b,c){if(a.text)for(b=0;b<a.text.length;b++){c=
a.text[b];v(c);for(var k=0;k<h.length;k++)if(0==e.compare(c.range,h[k].range)){h[k].text=c.text;c=null;break;}c&&h.push(c);}});}});OIT.extend('mod','range',{install:function(a,b){var d=a.doc,c=a.glob,f=a.document,e=a.math,l=a.pages,p=a.util,h=function(a){return'number'===typeof a;},q=function(a){return'string'===typeof a;},m=function(a,b){return a.acc-b.acc;};b.isRangeObject=function(a){return a.constructor===OIT.TextRange||a.constructor===OIT.CellRange||a.constructor===OIT.RectRange;};b.validateRange=function(a,c,f){var m;if(a&&a.type)switch(a.type){case 'text':h(a.acc)&&h(a.accend)&&(m=a);if(m&&f&&(a=l.forRange(m,0,!0))&&a.isEmailHeader())if(a=
l.findTextRange(m))if((a=a[0].startContainer)&&(d.isText(a)||d.isElement(a)))if(a=p.getTextRoot(a),a=b.fromDOM(a))if(Array.isArray(a)&&(a=a[0]),m.acc<a.acc||m.accend>a.accend)m=b.clone(m),m.acc<a.acc&&(m.acc=a.acc),m.accend>a.accend&&(m.accend=a.accend);break;case 'cell':if(h(a.page)&&h(a.c1)&&h(a.r1)&&h(a.c2)&&h(a.r2)){m=a;if(0>m.page)m=void 0;else if(m.page<l.count())(f=l.page(m.page))&&('worksheet'!==f.type&&'database'!=f.type)&&(m=void 0);else if(m.offsets&&(!h(m.offsets.left)||!h(m.offsets.top)||
!h(m.offsets.right)||!h(m.offsets.bottom)))m=void 0;if(m&&!0===c&&(f=l.page(a.page)))if(f=f.spreadsheetModel()){var v=f.colCount()-1;c=f.rowCount()-1;f=e.clamp(a.c1,0,v);var v=e.clamp(a.c2,0,v),y=e.clamp(a.r1,0,c);c=e.clamp(a.r2,0,c);if(f!==a.c1||v!==a.c2||y!==a.r1||c!==a.r2)m=b.clone(a),m.c1=f,m.c2=v,m.r1=y,m.r2=c;}}break;case 'rect':if(h(a.page)&&h(a.left)&&h(a.top)&&h(a.right)&&h(a.bottom)&&q(a.units)&&('px'===a.units||'tw'===a.units||'pct'===a.units))if(m=a,'pct'===a.units&&!h(a.embedId)?m=void 0:
0>m.page?m=void 0:void 0===a.embedId&&m.page<l.count()&&(f=l.page(m.page))&&('page'!==f.type&&'drawing'!==f.type&&'slide'!==f.type&&'chart'!==f.type&&'bitmap'!==f.type&&'email'!==f.type&&'html'!==f.type&&'rt'!==f.type)&&(m=void 0),m&&(void 0===a.embedId&&!0===c)&&(f=l.page(a.page)))if(c=f.pageRect()){var v=e.clamp(a.left,c.left,c.right),y=e.clamp(a.top,c.top,c.bottom),w=e.clamp(a.bottom,y,c.bottom),x=a.right;'html'!==f.type&&(x=e.clamp(a.right,v,c.right));if(v!=a.left||x!=a.right||y!=a.top||w!=a.bottom)m=
b.clone(a),m.left=v,m.right=x,m.top=y,m.bottom=w;}}return m;};b.textRange=function(){var a=arguments,c,d;switch(a.length){case 2:h(a[0])&&h(a[1])&&(c=a[0],d=a[1]);break;case 1:if(h(a[0]))c=a[0],d=a[0];else if(p.isDOMRange(a[0])||p.isDOMSelection(a[0])){if(a=b.fromDOM(a[0]))Array.isArray(a)?(c=a[0].acc,d=a[a.length-1].accend):(c=a.acc,d=a.accend);}else if((a=b.validateRange(a[0]))&&'cell'===a.type){var e=l.page(a.page);if(e&&('worksheet'===e.type||'database'===e.type))if(e.load(!1,!1,null),e=e.spreadsheetModel())return e.mapToText(a);}}if(h(c)&&
h(d))return new OIT.TextRange(c,d);};b.accFromNode=function(a,b){a=d.unwrap(a);b=b||0;var h;a:{if(1===a.nodeType&&a.childNodes&&(h=a.childNodes[b]))break a;h=void 0;}h&&(a=h,b=0);var e;h=c.viewNode;for(var f=a;f;f=f.parentNode){var l=d.data(f,'acc');if(void 0!==l){'none'!==l&&(e=d.wrap(f));break;}if(f===h)break;}if(h=e){e=parseInt(h.data('acc'));if(!h.equals(a)){h=h.createTreeWalker();for(f=h.firstACCNode();f;){f=h.currentNode;if(f===a)break;1===f.nodeType?(f=d.data(f,'acc'))&&(e=parseInt(f)):3===f.nodeType&&
(e+=f.nodeValue.length);f=h.nextACCNode();}}return e+b;}};b.fromDOM=function(a){var c;p.isDOMRange(a)?c=a:p.isDOMSelection(a)&&'number'===typeof a.rangeCount&&0<a.rangeCount?c=a.getRangeAt(0):d.isElement(a)&&(c=document.createRange(),c.selectNode(d.unwrap(a)));if(c){a=c.startContainer;var h=c.startOffset,e=c.endContainer,f=c.endOffset;if(a===e){var l=b.accFromNode(a,h);if(h===f)return b.textRange(l,l);if(d.isText(a)){var m;return b.textRange(l,l+f-h);}}for(var q=c.commonAncestorContainer;q&&!d.isElement(q);)q=
q.parentNode;q=d.wrap(q);c=b.accFromNode(q);for(var u=[],B,q=q.createTreeWalker(),l=q.firstACCNode(),n=!1,A=!1,g=!1;l;){var r=q.currentNode;if(r===a&&d.isText(a))n=!0;else if(!n&&r.parentNode===a&&(A=!0,0==h||d.nodeIndex(r)==h))n=!0;A&&!n&&(d.isDescendantOf(r,a)||(n=!0));if(g&&!d.isDescendantOf(r,e))break;1===r.nodeType?(l=d.data(r,'acc'))&&(c='none'===l?void 0:Number(l)):3===r.nodeType&&void 0!==c&&(n&&0<r.nodeValue.length&&(l=c,r===a&&(l+=h),m=c+r.nodeValue.length,r===e&&(m=c+f),B&&(B.accend!=c&&
B.accend!=c-1)&&(B=null),B?B.accend=m:(B=b.textRange(l,m),u.push(B))),c+=r.nodeValue.length);if(r===e&&d.isText(e))break;else if(r.parentNode===e&&(g=!0,0==f||d.nodeIndex(r)>=f))break;l=q.nextACCNode();}u=b.consolidate(u);0==u.length?u=void 0:1==u.length&&(u=u[0]);return u;}};b.cellRange=function(){var a,c,d,e,m,p,w=arguments;switch(w.length){case 9:a=w[0];c=w[1];d=w[2];e=w[3];m=w[4];p={left:w[5],top:w[6],right:w[7],bottom:w[8]};break;case 5:a=w[0];c=w[1];d=w[2];e=w[3];m=w[4];break;case 4:c=w[0];d=
w[1];e=w[2];m=w[3];break;case 3:a=w[0];c=w[1];d=w[2];e=w[1];m=w[2];break;case 2:c=w[0];d=w[1];e=w[0];m=w[1];break;case 1:if((w=b.validateRange(w[0]))&&'text'===w.type){var x=l.forRange(w);if(x&&('worksheet'===x.type||'database'===x.type))if(x.load(!1,!1,null),x=x.spreadsheetModel())return x.mapToCells(w);}}if(void 0===a)a=l.current();else if(q(a)){if(x=l.byName(a))a=x.index;}else if(h(a)){if(0>a||a>=l.count())a=void 0;}else a=void 0;if(!h(a)||!h(c)||!h(d)||!h(e)||!h(m))f.invalidArg('cellRange');else return new OIT.CellRange(a,
c,d,e,m,p);};b.rectRange=function(){var a,b,c,d,e,m,p='px',x=arguments;if(2<=x.length&&6>=x.length){var u=0;void 0===x[0]&&(u=1);var B=u;if(q(x[B])){var n=l.byName(x[B]);n&&(b=n.index,B++);}for(var n=0,A=B;A<x.length;A++)if(h(x[A]))n++;else break;switch(n-u){case 6:a=x[B++];case 5:b=x[B++];case 4:c=x[B++];d=x[B++];e=x[B++];m=x[B++];break;case 3:b=x[B++];case 2:c=x[B++],d=x[B++],e=c,m=d;}B<x.count&&q(x[B])&&(p=x[B++]);}if(void 0===b)b=l.current();else if(h(b)){if(0>b||b>=l.count())b=void 0;}else b=void 0;
if(!h(b)||!h(c)||!h(d)||!h(e)||!h(m)||'px'!==p&&'tw'!==p&&'pct'!==p)f.invalidArg('rectRange');else return new OIT.RectRange(a,b,c,d,e,m,p);};b.convert=function(a,b){if('rect'===a.type&&a.units!==b)switch(b){case 'px':if('tw'===a.units){var c=l.page(a.page);c&&c.dpi&&(a.left=e.round(a.left*c.dpi/1440,1E4),a.top=e.round(a.top*c.dpi/1440,1E4),a.right=e.round(a.right*c.dpi/1440,1E4),a.bottom=e.round(a.bottom*c.dpi/1440,1E4),a.units='px');}else if('pct'===a.units&&void 0!==a.embedId&&(c=l.page(a.page)))if(c=
c.embeddingRect(a.embedId)){var d=c.width/100,h=c.height/100;a.left=e.round(a.left*d,1E4);a.right=e.round(a.right*d,1E4);a.top=e.round(a.top*h,1E4);a.bottom=e.round(a.bottom*h,1E4);a.units='px';}break;case 'tw':if('px'===a.units&&(c=l.page(a.page))&&c.dpi)a.left=e.round(1440*a.left/c.dpi,1E4),a.top=e.round(1440*a.top/c.dpi,1E4),a.right=e.round(1440*a.right/c.dpi,1E4),a.bottom=e.round(1440*a.bottom/c.dpi,1E4),a.units='tw';break;case 'pct':if('px'===a.units&&(c=l.page(a.page))){if(void 0!==a.embedId){if(c=
c.embeddingRect(a.embedId))d=100/c.width,h=100/c.height;}else h=c.pageRect(),d=100/h.width,h=100/h.height;void 0!==d&&(a.units='pct',a.left=e.round(a.left*d,1E4),a.right=e.round(a.right*d,1E4),a.top=e.round(a.top*h,1E4),a.bottom=e.round(a.bottom*h,1E4));}}};b.compare=function(a,c){if(!a)return!c?0:-1;if(!c)return 1;if(a.page<c.page)return-1;if(a.page>c.page)return 1;if(a.type===c.type)switch(a.type){case 'text':return a.acc<c.acc?-1:c.acc<a.acc?1:a.accend<c.accend?-1:c.accend<a.accend?1:0;case 'cell':if(a.r1<
c.r1)return-1;if(c.r1<a.r1)return 1;if(a.c1<c.c1)return-1;if(c.c1<a.c1)return 1;if(a.r2<c.r2)return-1;if(c.r2<a.r2)return 1;if(a.c2<c.c2)return-1;if(c.c2<a.c2)return 1;if(a.offsets)if(c.offsets){if(a.offsets.top<c.offsets.top)return-1;if(a.offsets.top>c.offsets.top)return 1;if(a.offsets.left<c.offsets.left)return-1;if(a.offsets.left>c.offsets.left)return 1;if(a.offsets.bottom<c.offsets.bottom)return-1;if(a.offsets.bottom>c.offsets.bottom)return 1;if(a.offsets.right<c.offsets.right)return-1;if(a.offsets.right>
c.offsets.right)return 1;}else return 1;else if(c.offsets)return-1;return 0;case 'rect':return a.units!=c.units&&(c=b.clone(c),b.convert(c,a.units)),a.top<c.top?-1:c.top<a.top?1:a.left<c.left?-1:c.left<a.left?1:a.bottom<c.bottom?-1:c.bottom<a.bottom?1:a.right<c.right?-1:c.right<a.right?1:0;}};b.contains=function(a,b){if(a.type===b.type)switch(a.type){case 'text':return b.acc>=a.acc&&b.accend<=a.accend;}return!1;};b.overlap=function(a,b){if(b.type===a.type)switch(b.type){case 'text':return a.accend>b.acc&&
a.acc<b.accend;}return!1;};b.clone=function(a){var b;if(a)switch(a.type){case 'text':b=new OIT.TextRange(a.acc,a.accend);break;case 'cell':b=new OIT.CellRange(a.page,a.c1,a.r1,a.c2,a.r2);!0===a.selectingCols&&(b.selectingCols=!0);!0===a.selectingRows&&(b.selectingRows=!0);a.offsets&&(b.offsets={left:a.offsets.left,top:a.offsets.top,right:a.offsets.right,bottom:a.offsets.bottom});break;case 'rect':b=new OIT.RectRange(a.embedId,a.page,a.left,a.top,a.right,a.bottom,a.units,a.section);}return b;};b.consolidate=
function(a){if(a&&1<a.length){a.sort(m);for(var b=[],c,d=0;d<a.length;d++){var h=a[d];c&&3>h.acc-c.accend?h.accend>c.accend&&(c.accend=h.accend):(c=h,b.push(h));}a=b;}return a;};b.consolidateDOMRanges=function(a){if(1===a.length)return a[0];if(1<a.length){var b=a[0];a=a[a.length-1];var c=document.createRange();c.setStart(b.startContainer,b.startOffset);c.setEnd(a.endContainer,a.endOffset);return c;}};b.isEmpty=function(a){if(a=b.validateRange(a))switch(a.type){case 'text':return a.acc==a.accend;case 'cell':return!1;
case 'rect':return a.left==a.right||a.top==a.bottom;}return!0;};}});OIT.extend('mod','display',{events:{displayload:{},displayunload:{}},install:function(a,b){var d=a.glob,c=a.util,f=null,e=null,l=!1,p;b.loadDisplay=function(c){b.unloadDisplay();if(f=a.fmt.createDisplay(c.type))e=c.overlay,d.deType=c.type,d.deFeatures=a.fmt.features(c.type),d.drawing.resetOrigin(),f.init(c),b.on.displayload.dispatch(e.firstPage,e.lastPage);};b.unloadDisplay=function(){f&&(b.on.displayunload.dispatch(e.firstPage,e.lastPage),f.unload(),e=f=null,d.deType=null);d.item('deFeatures').reset();};
b.isSelectionModeSupported=function(a){var b=!1;switch(a){case 'none':b=!0;break;case 'text':d.deFeatures.textselection&&(b=!0);break;case 'rect':d.deFeatures.rectselection&&(b=!0);break;case 'cell':d.deFeatures.cellselection&&(b=!0);}return b;};b.isHighlightModeSupported=function(a){var c=b.isSelectionModeSupported(a);if(!c&&'text'===a&&('worksheet'===d.deType||'database'===d.deType))c=!0;return c;};b.topPageIndex=function(){if(f)return f.topPageIndex();};b.bottomPageIndex=function(){if(f)return f.bottomPageIndex();};
b.maxPageWidth=function(){if(f)return f.maxPageWidth();};b.maxPageHeight=function(){if(f)return f.maxPageHeight();};b.padding=function(){if(f)return f.padding();};b.margin=function(){if(f)return f.margin();};b.scrollOffset=function(){if(f)return f.scrollOffset();};b.keydown=function(a){return f?f.keydown(a):!0;};b.showHidden=function(a){f&&f.showHidden(a);};b.loadRange=function(a,b){f&&f.loadRange(a,b);};b.moveto=function(a,b,c){return f?f.moveto(a,b,c||{}):!1;};b.getSelectedText=function(){return f?f.getSelectedText():
'';};b.select=function(a){return f?f.select(a):!1;};b.pageRange=function(a,b){if(f&&e.containsPage(a))return f.pageRange(a,b);};b.pageRect=function(a,b){if(f&&e.containsPage(a))return f.pageRect(a,b);};b.rangeRect=function(a,b,c){if(f&&('text'===a.type||e.containsPage(a.page)))return f.rangeRect(a,b,c);};b.rangeFromRect=function(a,b,c,d,l,p,t,v){if(f&&e.containsPage(a))return f.rangeFromRect(a,b,c,d,l,p,t,v);};b.extendRange=function(a,b,c,d){if(f)return f.extendRange(a,b,c,d);};b.moveAnchor=function(a,b,
c,d){return f?f.moveAnchor(a,b,c,d):!1;};b.incrementSelection=function(a,b,c,d,e){return f?f.incrementSelection(a,b,c,d,e):!1;};b.suspendUpdate=function(){l||(l=!0);};b.resumeUpdate=function(){l&&(l=!1,b.update());};b.layoutChanged=function(a){f&&f.layoutChanged(a);};b.update=function(a,d){if(!l)if(!0===d)p&&c.clearTimeout(p),p=c.setTimeout(b.update,50,this,a,!1);else if(f)return f.update(a);return!1;};a.on('document','reset',b.unloadDisplay);a.on('util','fontload',function(){b.update(!0);});}});OIT.extend('mod','selection',{events:{beginselection:{},selectionchanged:{}},install:function(a,b){var d=a.opt,c=a.glob,f=a.doc,e=a.css,l=a.range,p=a.util,h=a.display,q=a.highlights,m=a.pages,k=null,z=!0,s=null,t=!0,v=!1,y=!0,w,x,u,B,n,A,g,r,C,F,I=0,J,L,E,D=0,K,H=0,M=0,P,O,R,Q,V,G,S,N=!1;b.reset=function(){b.select(null);d.selectionMode=b.validateMode(d.selectionMode);};b.style=function(a,b){t=!1===b?!1:!0;if((null===a||'string'===typeof a)&&a!==s)s=a,k=e.parse(s),T(),U();return s;};var T=function(a){if(!a&&
k){a='';k.color&&(a+='color:'+k.color+';');var b=k['background-color'];b&&(a+='background-color:'+b+';');}a&&0<a.length?(Q||(Q=f.create('style'),Q.type='text/css',f.byTagName('head')[0].append(Q)),Q.html('.oit-view ::selection { '+a+'}')):Q&&Q.html('');},U=function(){if(x){var a=x.selectionRect();a.resetStyle();k?(a.removeClass('oit-sel-rect'),a.css(k)):a.addClass('oit-sel-rect');a.update();}};b.textSelection=function(){if(u){if('text'===u.type){var a=l.clone(u);a.bSlideNote=u.bSlideNote;return a;}if('cell'===
u.type)return l.textRange(u);}};b.cellSelection=function(){if(u&&'cell'===u.type)return l.clone(u);};b.rectSelection=function(){if(u&&'rect'===u.type)return l.clone(u);};b.selectionType=function(){return u?u.type:'none';};b.hide=function(){z=!1;T('background-color: rgba(255,255,255,0);');x&&x.showSelectionRect(!1);};b.select=function(c,d,g,e){var k=!1;z=!0;if(null===c)k=null!=u,Y(),b.update();else if(c)if(p.isDOMSelection(c)||p.isDOMRange(c))k=b.select(l.textRange(c));else if((c=l.validateRange(c))&&0!=
l.compare(c,u)){var f=m.forRange(c,0,!0);f&&(k=!0,b.on.beginselection.dispatch(c),Y(),x=f,u=l.clone(c),w=l.clone(c),!0==c.bSlideNote&&(u.bSlideNote=!0),U(),b.update());}if(k||d!==S)if(b.on.selectionchanged.dispatch(u,!0),S=d,a.dispatch('document','select',u,g||null,e||null,l.isEmpty(u),d)&&u&&void 0===d)c=h.rangeRect(u,'view'),'text'===u.type&&b.update(),c&&q.activateNearest(c.left,c.top);return k;};b.startRectSelection=function(a,c){Y();h.isSelectionModeSupported('text')||q.startSelection();var d=
m.mapToPage(a,c,null,!0);b.logRect&&b.logRect(d.page,d.x,d.y,!0);B={x:a,y:c};x=d.page;A=d.x;g=d.y;r=a;C=c;z=n=!0;u=h.rangeFromRect(x.index,A,g,A,g,x,'select');'cell'===u.type&&!v&&delete u.offsets;w=l.clone(u);b.on.beginselection.dispatch(u);U();b.update();b.on.selectionchanged.dispatch(u,!1);};b.extendRectSelection=function(a,c){if(w){if(n){var d=Math.abs(a-r),g=Math.abs(c-C);if(2<d||2<g)n=!1,h.isSelectionModeSupported('text')&&q.startSelection();}$(a,c);d=m.mapToPage(a,c,x,!0);b.logRect&&b.logRect(d.page,
d.x,d.y);u=h.extendRange(w,d.x,d.y,d.page);y&&(u=l.validateRange(u,!0));b.update();b.on.selectionchanged.dispatch(u,!1);}};b.endRectSelection=function(c,g,e){ba();b.extendRectSelection(c,g);b.on.selectionchanged.dispatch(u,!0);c={x:c,y:g};g=n;S=void 0;a.dispatch('document','select',u,B,c,n)&&'rect'===d.selectionMode&&b.select(null);g&&e&&f.wrap(e.target).isDescendantOf(m.activeOverlay())&&q.deactivate();q.endSelection();};b.cancelRectSelection=function(a,c){ba();b.select(null);};b.startTouchTextSelection=
function(a,c){z=!0;V&&b.abortTouchTextSelection();};b.updateTouchTextSelection=function(){var a=window.getSelection();if(a.anchorNode&&(!G||G.anchorNode!=a.anchorNode||G.anchorOffset!=a.anchorOffset||G.focusNode!=a.focusNode||G.focusOffset!=a.focusOffset))G||(G={}),G.anchorNode=a.anchorNode,G.anchorOffset=a.anchorOffset,G.focusNode=a.focusNode,G.focusOffset=a.focusOffset,V=l.textRange(a);};b.abortTouchTextSelection=function(){V=null;};b.startTextSelection=function(a,d,g){Y();E=F=null;z=!0;B={x:a,y:d};
n=!0;r=a;C=d;if(!c.deFeatures.customtextselection)return!1;a=m.mapToPage(a,d,null,!0);!0==a.page.bNotesBar&&(N=!0);d=a.page.mapPointToText(a.x,a.y);if(!d||!d.overlaps)return!1;L=p.getTextRoot(d.node);var e;if('line'===g||'word'===g)e=a.page.findTextBoundary(d.node,d.offset,g);e?(K=g,J=e,F=J.startContainer,I=J.startOffset,E=J.endContainer,D=J.endOffset):(K=void 0,F=d.node,I=d.offset,E=d.node,D=d.offset);if(F&&E&&(b.update(),f.selectRange(F,I,E,D),g=window.getSelection(),g.anchorNode&&g.focusNode))if(g=
l.textRange(g))b.on.beginselection.dispatch(g);else return E=F=null,!1;return!0;};b.extendTextSelection=function(a,b){if(!c.deFeatures.customtextselection)return!1;if(n){var d=Math.abs(a-r),g=Math.abs(b-C);if(2<d||2<g)n=!1,h.isSelectionModeSupported('text')&&q.startSelection();}$(a,b);d=m.mapToPage(a,b,null,!0);g=d.page.mapPointToText(d.x,d.y,L);if(!g)return!1;if(g.node!=E||g.offset!=D){if(K){if(d=d.page.findTextBoundary(g.node,g.offset,K))g=d.compareBoundaryPoints(Range.START_TO_START,J),-1==g?(E=
d.startContainer,D=d.startOffset,F=J.endContainer,I=J.endOffset):(F=J.startContainer,I=J.startOffset,E=d.endContainer,D=d.endOffset);}else E=g.node,D=g.offset;F==E?I>D?f.selectRange(E,D,F,I):f.selectRange(F,I,E,D):(g=F.compareDocumentPosition(E),2==g?f.selectRange(E,D,F,I):f.selectRange(F,I,E,D));}return!0;};b.endTextSelection=function(c,e,k){ba();if('text'==d.selectionMode){var h,G=n;V?(h=V,V=null):(h=window.getSelection(),h=h.anchorNode&&h.focusNode?l.textRange(h):null);if(h){if(0!=l.compare(h,u)){var t;
if(t=!0==N?m.notesBar():m.forRange(h))n=!1,C=r=g=A=void 0,x=t,u=h,!0==N&&(u.bSlideNote=!0),w=l.clone(h),b.on.selectionchanged.dispatch(u,!0),c={x:c,y:e},S=void 0,a.dispatch('document','select',u,B,c,l.isEmpty(u));}}else Y(),q.autoHighlight()&&f.clearSelection();G&&k&&f.wrap(k.target).isDescendantOf(m.activeOverlay())&&(b.reset(),q.deactivate());F=void 0;I=0;E=J=void 0;D=0;K=void 0;}N=!1;q.endSelection();};b.incrementSelection=function(a,c,d){var g=!1;if(u&&(g=h.incrementSelection(w,u,a,c,d)))b.update(),
b.on.selectionchanged.dispatch(u,!0);return g;};b.moveAnchor=function(a,c,d){var g=!1;if(w&&(g=h.moveAnchor(w,a,c,d)))u=l.clone(w),b.update(),b.on.selectionchanged.dispatch(u,!0);return g;};b.update=function(){if(u)if('text'===u.type){f.clearSelection();b.logUpdate&&b.logUpdate(u);var a=m.findTextRange(u);a&&f.selectRange(l.consolidateDOMRanges(a));}else{if(x)if(a=h.rangeRect(u,'overlay',!0),b.logUpdate&&b.logUpdate(u,a),a){if(x.hasSelectionRect()){var c=x.selectionRect();c.move(a.left,a.top,a.width,
a.height);c.show(z&&(!n||t)&&('rect'===u.type||'cell'===u.type));}}else x.showSelectionRect(!1);}else f.clearSelection();h.select(u)&&h.update();};var Y=function(){f.clearSelection();x&&x.showSelectionRect(!1);z=!0;n=!1;C=r=g=A=void 0;u=w=x=null;T();U();};b.validateMode=function(a,d){h.isSelectionModeSupported(a)||('rect'===a?c.deFeatures.rectredaction||(a=void 0):a=void 0);a||(d?a=b.validateMode(d):h.isSelectionModeSupported('text')?a='text':h.isSelectionModeSupported('rect')?a='rect':h.isSelectionModeSupported('cell')&&
(a='cell'));return a;};var $=function(a,b){if(a!=P||b!=O){P=a;O=b;var g=c.viewNode,e=0;if(!0==d.showSlideNotes){var h=m.notesBar();h&&(e=h.getHeight());}1>=a?(H=a-1,-30<H&&(H=-30)):a>=g.clientWidth-1?(H=a-(g.clientWidth-1),30>H&&(H=30)):H=0;1>=b?(M=b-1,-30<M&&(M=-30)):b>=g.clientHeight+e-1?(M=b-(g.clientHeight+e-1),30>M&&(M=30)):M=0;H||M?R||(R=p.setInterval(ja,100)):ba();}},ja=function(){c.viewNode.dscroll(H,M);F?b.extendTextSelection(P,O):b.extendRectSelection(P,O);},ba=function(){R&&(p.clearInterval(R),
R=void 0,M=H=0);};b.enableCellOffsets=function(a){v=!!a;};b.bindSelectionToPage=function(a){y=!!a;};Y();d.onselectionMode(function(a){b.select(null);(a=m.activeOverlay())&&a.updateCSS();});a.on('document','reset',b.reset);a.on('display','displayload',b.reset);a.on('view','detach',function(){s=k=null;Q&&(Q.destroy(),Q=null);});a.on('document','zoom',function(a,c,d){b.update();});}});OIT.extend('mod','user',{events:{beginscroll:{},endscroll:{},beginpinchzoom:{},endpinchzoom:{}},install:function(a,b){var d=a.opt,c=a.glob,f=a.doc,e=a.display,l=a.selection,p=a.util,h=a.math,q=a.document,m=a.highlights,k=a.pages,z=!1,s=!1,t=!1,v=!1,y,w,x=null,u,B,n,A=null,g,r,C,F,I,J,L=!1,E,D,K,H;a.on('document','load',function(){var a=c.rootNode;a.onmousedown(O);a.onmousewheel(Q);window.addEventListener('mouseup',R,!1);window.addEventListener('keydown',M,!1);c.isMobileOrTablet&&(a=c.viewNode,a.kinetic(!0),
a.ontap(ka),a.onpress(la),a.onpressup(aa),a.onpanstart(ha),a.onpanmove(ca),a.onpanend(Z),a.onpancancel(Z),a.onpinchstart(da),a.onpinchmove(ia),a.onpinchend(fa),a.onpinchcancel(fa),a.onrotatestart(ma),a.onrotatemove(na),a.onrotateend(X),a.onrotatecancel(X),oa());});a.on('document','reset',function(){var a=c.rootNode;a&&(a.offmousedown(O),a.offmousewheel(Q));window.removeEventListener('mouseup',R);window.removeEventListener('keydown',M);if(c.isMobileOrTablet&&(a=c.viewNode))a.offtap(ka),a.offpress(la),
a.offpressup(aa),a.offpanstart(ha),a.offpanmove(ca),a.offpanend(Z),a.offpancancel(Z),a.offpinchstart(da),a.offpinchmove(ia),a.offpinchend(fa),a.offpinchcancel(fa),a.offrotatestart(ma),a.offrotatemove(na),a.offrotateend(X),a.offrotatecancel(X);});var M=function(a){b.logKeydown&&b.logKeydown(a);if(b.isViewEventTarget(a.target)||z&&a.target==document.body){var g=q.on.keydown.dispatch(a);if(g&&!c.editingComment&&(g=e.keydown(a))){var h=c.viewNode,f=m.active(),n=0,r=0;switch(a.keyCode){case 33:c.deFeatures.pages&&
(k.movetoPrev(),g=!1);break;case 34:c.deFeatures.pages&&(k.movetoNext(),g=!1);break;case 35:h.scroll(h.scrollWidth,h.scrollHeight);g=!1;break;case 36:h.scroll(0,0);g=!1;break;case 37:n=-1;break;case 38:r=-1;break;case 39:n=1;break;case 40:r=1;break;case 45:void 0!==f&&m.getOption(f,'enableUserComment')&&(m.showComment(f,{mode:'edit',removeOnCancel:!1}),g=!1);break;case 46:void 0!==f&&m.getOption(f,'enableUserDelete')&&(m.remove(),f=void 0,g=!1);break;case 48:a.ctrlKey&&(q.zoom(1),g=!1);break;case 187:a.ctrlKey&&
(q.zoomIn(),g=!1);break;case 189:a.ctrlKey&&(q.zoomOut(),g=!1);}if(n||r){var u;if(void 0!==f&&(h=m.range(f)))u=h.type;u||(u=d.selectionMode);if('cell'===u||'rect'===u)if(g=a.ctrlKey,void 0!==f){if(a.shiftKey){var N=h=0,A=0,G=0;u=d.rotation;switch(u){case 0:A=n;G=r;break;case 90:G=n;h=-r;break;case 180:h=-n;N=-r;break;case 270:N=-n,A=r;}m.move(f,h,N,A,G,g);}else{u=d.rotation;if(0!=u)switch(h=n,N=r,u){case 90:n=-N;r=h;break;case 180:n=-h;r=-N;break;case 270:n=N,r=-h;}m.move(f,n,r,n,r,g);}(h=m.range(f))&&
k.moveto(h);g=!1;}else g=a.shiftKey?!l.incrementSelection(n,r,g):!l.moveAnchor(n,r,g);}}!1===g&&p.preventDefault(a);return g;}},P=function(a){if((a.button||0)==I)b.releaseMouseCapture(),b.on.endscroll.dispatch();I=void 0;},O=function(a){z=!1;b.logMouse&&b.logMouse(a);if(!c.editingComment){var h=c.viewNode,e=h.mousePos(a);if(b.isViewEventTarget(a.target)){var f=a.button||0,n=h.inRect(e.x,e.y);if(!0==d.showSlideNotes&&!n){var m=k.notesBar();if(m){var u=m.mousePos(a),n=m.inRect(u.x,u.y);!0==n&&(e=u,L=!0);}}if(1==
f||0==f&&!n)b.on.beginscroll.dispatch(),I=f,b.setMouseCapture(null,P);else{n=!0;h.focus();z=!0;if(0===f){h=d.selectionMode;if('rect'===h||'cell'===h)t=!0,b.setMouseCapture($),l.startRectSelection(e.x,e.y),n=!1;else if('text'==h){var N,h=1;if(void 0!==g){var A;if(a.pageX||a.pageY)N=a.pageX,A=a.pageY;else if(a.clientX||a.clientY)N=a.clientX,A=a.clientY;N=Math.abs(N-r.x);A=Math.abs(A-r.y);3>=N&&3>=A&&((new Date).getTime()-g<=d.doubleClickInterval&&(h=C+1),g=void 0);}N=h;var G;2===N?G='word':N=1;if(l.startTextSelection(e.x,
e.y,G))if(v=!0,b.setMouseCapture(ja),e=N,g=(new Date).getTime(),C=e,a.pageX||a.pageY)r={x:a.pageX,y:a.pageY};else if(a.clientX||a.clientY)r={x:a.clientX,y:a.clientY};n=!1;}s=!0;}!1===n&&p.preventDefault(a);return n;}}}},R=function(a){var d;b.logMouse&&b.logMouse(a);if(w)d=w.call(x,a);else if(s){d=!0;if(!c.editingComment){var g;g=!0==L&&k.notesBar()?k.notesBar().mousePos(a):c.viewNode.mousePos(a);if(0===(a.button||0))t?(t=!1,b.releaseMouseCapture(),l.endRectSelection(g.x,g.y,a)):(v&&(v=!1,b.releaseMouseCapture()),
L&&(L=!1),l.endTextSelection(g.x,g.y,a)),d=!1;}s=!1;}!1===d&&p.preventDefault(a);return d;},Q=function(a){if(!c.editingComment&&b.isViewEventTarget(a.target))if(a.ctrlKey){if(!d.browserZoom)return 0<a.wheelDelta?OIT.document.zoomIn():0>a.wheelDelta&&OIT.document.zoomOut(),p.preventDefault(a),!1;}else b.on.beginscroll.dispatch(),void 0!==F&&p.clearTimeout(F),F=p.setTimeout(V,500);},V=function(){F=void 0;b.on.endscroll.dispatch();};b.setMouseCapture=function(a,c,d){b.releaseMouseCapture();'function'===typeof a&&
(window.addEventListener('mousemove',G,!1),y=a);'function'===typeof c&&(w=c);if(y||w)f.body.onmouseover(S),f.body.onmouseout(N);x=d;};var G=function(a){y&&y.call(x,a);},S=function(a){if(J){var b=ba(a);if(b!==J.buttons&&J.buttons&1&&!(b&1)){var b=J,c;document.createEvent?(c=document.createEvent('MouseEvent'),c.initMouseEvent('mouseup',!0,!0,window,null,b.screenX,b.screenY,b.clientX,b.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,a.relatedTarget)):c=new MouseEvent('mouseup',{screenX:b.screenX,screenY:b.screenY,
clientX:b.clientX,clientY:b.clientY,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey,button:0,buttons:a.buttons,relatedTarget:a.relatedTarget,region:a.region});R(c);}J=void 0;}},N=function(a){J={buttons:ba(a),screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY};};b.releaseMouseCapture=function(){y&&(window.removeEventListener('mousemove',y,!1),y=null);w=null;f.body.offmouseover(S);f.body.offmouseout(N);};b.setTouchCapture=function(a,c,d,g){b.releaseTouchCapture();
'function'===typeof a&&(f.listen('touchmove',T,!1),u=a);'function'===typeof c&&(f.listen('touchend',U,!1),B=c);'function'===typeof d&&(f.listen('touchcancel',Y,!1),n=d);A=g;};var T=function(a){u&&u.call(A,a);},U=function(a){B&&B.call(A,a);},Y=function(a){n&&n.call(A,a);};b.releaseTouchCapture=function(){u&&(f.unlisten('touchmove',T,!1),u=null);A=n=B=null;};var $=function(a){if(t){var b=c.viewNode.mousePos(a);l.extendRectSelection(b.x,b.y);p.preventDefault(a);return!1;}return!0;},ja=function(a){if(v){var b;
b=!0==L&&k.notesBar()?k.notesBar().mousePos(a):c.viewNode.mousePos(a);l.extendTextSelection(b.x,b.y);p.preventDefault(a);return!1;}return!0;};b.isViewEventTarget=function(a){for(var b=c.viewNode;a;){if(b.equals(a))return!0;if('TEXTAREA'===a.tagName)break;if('oit-em_allheaders'===a.id)break;if(f.hasClass(a,'oit-emheadervalues')||f.hasClass(a,'oit-em_allheaders')||f.hasClass(a,'oit-note-icons')||f.hasClass(a,'oit-ssoverlay')||f.hasClass(a,'oit-slidenotes'))return!0;if(f.hasClass(a,'oit-button')||f.hasClass(a,
'oit-note')||f.hasClass(a,'oit-expander'))break;a=a.parentNode;}return!1;};var ba=function(a){if(void 0!==a.buttons)return a.buttons;switch(a.button){case 0:return 1;case 1:return 4;case 2:return 2;case 3:return 8;case 4:return 16;}},ka=function(a){var b=a.center;m.activateNearest(b.x,b.y,a.srcEvent);},la=function(a){z=!1;if(!c.editingComment){a=a.center;c.viewNode.focus();z=!0;var b=d.selectionMode;'rect'===b||'cell'===b?(t=!0,l.startRectSelection(a.x,a.y)):'text'==b&&l.startTextSelection(a.x,a.y,'word')&&
(v=!0);}},aa=function(a){if(t||v)if(t){t=!1;var b=a.center;l.endRectSelection(b.x,b.y,a.srcEvent);}else v&&(v=!1,b=a.center,l.endTextSelection(b.x,b.y,a.srcEvent));},ha=function(a){if(!a.press)switch(a=c.viewNode,E=a.scroll(),d.scrollMode){case 'hswipe':D={prev:10>=E.left,next:a.clientWidth>=a.scrollWidth-E.left-10};break;case 'vswipe':D={prev:10>=E.top,next:a.clientHeight>=a.scrollHeight-E.top-10};break;default:D=void 0;}},ca=function(a){a.press?t?(a=a.center,l.extendRectSelection(a.x,a.y)):v&&(a=a.center,
l.extendTextSelection(a.x,a.y)):E&&(a=a.delta,c.viewNode.autoscroll(E.left-a.x,E.top-a.y));},Z=function(a){a.press||(E=void 0);},da=function(a){K=d.zoom;b.on.beginpinchzoom.dispatch();},ia=function(a){K&&q.zoom(K*a.scale,a.center,!0);},fa=function(a){K=void 0;b.on.endpinchzoom.dispatch();},ma=function(a){H=d.rotation;},na=function(a){if(void 0!==H){var b=H;a=h.normalizeAngle(h.degrees(a.rotation),'deg');60<a&&300>a&&(b=135>a?b+90:225>a?b+180:b+270);q.rotate(b);}},X=function(a){H=void 0;},ea=function(){c.viewNode.cancelKinetic();
c.viewNode.scroll(0,0);},W=function(a){if(D&&D.prev){a=k.activePage();var b=k.prev();b&&b.overlay==a.overlay&&k.moveto(b.index,ea);}},ga=function(a){if(D&&D.next){a=k.activePage();var b=k.next();b&&b.overlay==a.overlay&&k.moveto(b.index,ea);}},oa=function(){if(c.isMobileOrTablet){var a=c.viewNode,b=d.scrollMode,g='vswipe'===b;'hswipe'===b?(a.onswipeleft(W),a.onswiperight(ga)):(a.offswipeleft(W),a.offswiperight(ga));g?(a.onswipedown(W),a.onswipeup(ga)):(a.offswipedown(W),a.offswipeup(ga));}};d.onscrollMode(oa);}});OIT.extend('mod','content',{events:{data:{},add:{},first:{},last:{}},install:function(a,b){var d=a.opt,c=a.glob,f=a.doc,e=a.ajax,l=a.dialog,p=a.util,h=OIT.local,q=!1,m=!0,k=[],z=[],s,t,v,y=[],w,x,u=!1,B=0,n=!1,A=function(){w&&(w.hide(),w=null);},g=function(a){a&&(y.push(a),q&&setTimeout(L,0),(a=k.shift())&&a.destroy());};b.isPending=function(){return 0<z.length||0<y.length;};b.initializeContent=function(a,b,d){OIT.content&&(g(OIT.content),delete OIT.content);d?(c.singlePageIndex=Number(d),b&&c.dynamicContent&&
C(b)):b?(c.dynamicContent=!0,C(b)):a&&'none'!==a&&(c.dynamicContent=!0,F(a));q=!0;0<y.length&&setTimeout(L,0);};var r=function(a){if(!x&&a){if((void 0==d.outputBaseUrl||null==d.outputBaseUrl||''==d.outputBaseUrl)&&d.detectBaseUrl&&'/'!=a[0]&&0!=a.search(/http/i)){var b=c.URL.lastIndexOf('/');if(-1!=b){b=c.URL.substr(0,b+1);if(0==b.search(/http/i)){var g=document.createElement('a');g.href=b;b=g.pathname||g.pathName;'/'!=b[0]&&(b='/'+b);}0!=a.indexOf(b)&&(c.baseURL=b||null);}}x=c.baseURL;}return x;},C=function(a,
b){if(a){var d=r(a);d&&'/'!=a.charAt(0)&&(a=p.concatURL(d,a));0==c.URL.indexOf('file://')?(d=f.create('script'),d.attr('src',a),f.head.append(d),k.push(d)):(z.push({url:a,lastContent:b,cache:!0}),J());}},F=function(a){if(a&&'none'!==a){var b=r(a);b&&'/'!=a.charAt(0)&&(a=p.concatURL(b,a));z.push({url:a,cache:!0});J();}},I=function(a,c,g,e){s=void 0;404===e&&(g='');200===e||404==e?0==g.length||0==g.indexOf('%')?!0===z[0].lastContent?(z.shift(),J()):(g!==v&&(v=g,t=0),t>d.contentTimeout?(A(),l.showMessage(h.DOCUMENT_ERROR),
b.logFatalError(null,'Fatal error in view: Timed out waiting for document data from the server (error '+e+')'),z=[]):(m?w||(w=l.createProgressDialog(h.PLEASE_WAIT_INITIALIZING,!1)):l.showMessage(h.PLEASE_WAIT_CONVERTING),z[0].cache=!1,t+=1E3,p.setTimeout(J,1E3))):(z.shift(),b.processContentData(g),J(),A()):0!=e&&(A(),l.showMessage(h.DOCUMENT_ERROR),b.logFatalError(null,'Fatal error in view: unable to retrieve document data from the server (error '+e+')'),z=[]);},J=function(){0<z.length?void 0===s&&
(t=0,v='',s=e.start({url:z[0].url,cache:z[0].cache,complete:I})):A();};b.isICD=function(a){return'if(window.OIT&&OIT.icd)OIT.icd('==a.substring(0,31);};b.processContentData=function(a){var c=a.indexOf('else OIT.content={');if(-1!=c){var c=c+18,d=a.lastIndexOf('}');-1!=d&&(a='{'+a.substring(c,d)+'}');}else b.isICD(a)&&(c=31,d=a.lastIndexOf(');'),-1!=d&&(a=a.substring(c,d)));try{var g=JSON.parse(a);}catch(h){return;}y.push(g);L();};var L=function(){if(q&&!n&&0<y.length){for(var a=m,d=!1;0<y.length;){var g=
y.shift();if(g.guid)if(c.guid){if(g.guid!==c.guid){b.logFatalError(null,'Fatal error in view: Document data is corrupt');break;}}else c.guid=g.guid;if(g.info&&g.info.version){var h=g.info.version.split('.'),e=parseInt(h[0]),k=parseInt(h[1]),h=parseInt(h[2]);0<e&&(0<=k&&9>=k&&0<=h&&9>=h)&&(B=e+k/10+h/100);}b.on.data.dispatch(g,m,B);void 0===c.singlePageIndex?(g.lastContent&&!u&&(u=!0,(g.nextContent||g.nextData)&&C(g.lastContent,!0)),g.nextContent?C(g.nextContent):g.nextData?F(g.nextData):d=!0):d=!0;
m=!1;}a&&b.on.first.dispatch();b.on.add.dispatch();d&&(l.hideMessage(),b.on.last.dispatch());}};a.on('document','reset',function(){A();q=!1;m=!0;k=[];z=[];v=t=s=void 0;y=[];x=void 0;u=!1;B=0;n=!1;c.singlePageIndex=void 0;b.on.add.reset();});a.on('user','beginscroll',function(){n=!0;});a.on('user','endscroll',function(){n=!1;L();});a.export('icd',g);}});OIT.extend('mod','document',{exports:'cellRange cellSelection externalData externalValue find findAll getRawText getSelectedText highlight properties rectRange rectSelection removeExtraEmailHeaders rotate select selection selectionMode selectionStyle selectionType setOptions showHidden textRange textSelection updateViewSize zoom zoomIn zoomOut'.split(' '),events:{load:{pub:!0,detail:function(){return{url:this.glob.URL};},onAdd:function(a,b){this.glob.documentLoaded&&this.util.setTimeout(function(){a.dispatchTo(b);},
0);}},reset:{},unload:{pub:!0},zoom:{pub:!0,detail:function(a,b,d){return{zoom:a,mode:b};}},rotate:{pub:!0,detail:function(a){return{angle:a};}},resize:{},idle:{pub:!0,onListen:function(){this.document.resetIdleTimer();},onUnlisten:function(){this.document.resetIdleTimer();},onAdd:function(){this.document.resetIdleTimer();},onRemove:function(){this.document.resetIdleTimer();}},error:{pub:!0,detail:function(a){return{message:a};}},select:{pub:!0,detail:function(a,b,d,c,f){a={selection:a,empty:c};b&&d&&(a.start=
b,a.end=d);void 0!==f&&(a.highlightid=f);return a;}},scroll:{pub:!0,detail:function(a,b,d,c){b=this.glob.viewNode;d=this.pages;a=d.mapToPage(0,0);b=d.mapToPage(b.clientWidth,b.clientHeight);return a&&b?{viewUpperLeft:{pageIndex:a.page.index,x:a.x,y:a.y},viewLowerRight:{pageIndex:b.page.index,x:b.x,y:b.y}}:{viewUpperLeft:{pageIndex:0,x:0,y:0},viewLowerRight:{pageIndex:0,x:0,y:0}};}},scrollupdate:{delay:200},keydown:{pub:!0,detail:function(a){return{srcEvent:a};}},optionschanged:{pub:!0,detail:function(a){return a;}},
showmessage:{pub:!0,detail:function(a,b,d){return{message:a||'',modal:b||!1,progress:d||!1};}},progress:{pub:!0,detail:function(a){return{percentDone:a||0};}},hidemessage:{pub:!0},done:{pub:!0}},install:function(a,b){var d=a.opt,c=a.glob,f=a.doc,e=a.display,l=a.util,p=a.math,h=a.rawtext,q=a.content,m=a.dialog,k=a.selection,z=a.range,s=a.highlights,t=a.pages,v=a.view,y=a.ajax,w=OIT.local,x=[0.1,0.25,0.5,0.75,1,1.25,1.5,2,3,5,10,20,40],u=x[0],B=x[x.length-1],n=['rows','columns','all','none'],A=!1,g,r,
C,F={},I={},J,L,E;b.properties=function(){if(c.documentLoaded)return l.clone(F);};b.externalValue=function(a){if(c.documentLoaded)return I[a];};b.externalData=function(){if(c.documentLoaded)return I;};b.setOptions=function(a){if(a){var c=!1,g={},h;for(h in a)d.isPublic(h)&&(d[h]=a[h],g[h]=a[h],c=!0);a.emailHeaderFontSize&&d.item('emailHeaderStyle').setProperty('fontSize',a.emailHeaderFontSize);c&&b.on.optionschanged.dispatch(g);}};a.on('user','beginpinchzoom',function(a,b){A=!0;});a.on('user','endpinchzoom',
function(){A=!1;H(!1);});var D=function(a){a<u?a=u:a>B&&(a=B);return a;};b.zoom=function(a,c,g){if('number'===typeof a){var h=D(a);h!=a&&(g||b.invalidArg('zoom','zoom',a,'using fallback zoom factor '+h,!1),a=h);if(d.zoomMode||a!=d.zoom)d.zoom=a,d.zoomMode=null,H(!1,c);}else'string'===typeof a?a!=d.zoomMode&&(d.zoomMode=a,H(!1,c)):'undefined'!==typeof a&&!g&&b.invalidArg('zoom','zoom',a);return d.zoom;};b.zoomIn=function(){for(var a=0;a<x.length;a++)if(x[a]>d.zoom){b.zoom(x[a]);break;}return d.zoom;};b.zoomOut=
function(){for(var a=x.length-1;0<=a;a--)if(x[a]<d.zoom){b.zoom(x[a]);break;}return d.zoom;};b.rotate=function(a){'number'===typeof a?d.rotation=p.normalizeAngle(a,'deg'):void 0!==a&&b.invalidArg('rotate','angle',a,'Angle must be an integer multiple of 90 degrees.');return d.rotation;};b.showHidden=function(a){c.documentLoaded&&c.deFeatures.showhidden&&(void 0!==a&&-1==n.indexOf(a)?b.invalidArg('showHidden','mode',a,'Must be one of '+JSON.stringify(n)):e.showHidden(a));};b.find=function(a,d,g,h,e){c.documentLoaded&&
('up'!==h&&(h='down'),!1!==g&&(g=!0),'string'!==typeof a?b.invalidArg('find','searchTerm',a,'must be a string'):l.isFunction(d)?l.setTimeout(O,0,{searchTerm:a,callbackFn:d,caseSensitive:g,direction:h,startACC:e}):b.invalidArg('find','callbackFn',d,'must be a function'));};b.findAll=function(a,d,g){if(c.documentLoaded)if(!1!==g&&(g=!0),'string'!==typeof a)b.invalidArg('findAll','searchTerm',a,'must be a string');else if(l.isFunction(d)){var e=h.firstACC();l.setTimeout(R,0,{searchTerm:a,callbackFn:function(a){var b=
!0;a?d&&(b=d.call(null,a)):(d&&d.call(null),b=!1);!1!==b&&(b=!0);return b;},startIterationFn:null,endIterationFn:null,caseSensitive:g,startACC:e});}else b.invalidArg('findAll','callbackFn',d,'must be a function');};b.getRawText=function(a){c.documentLoaded&&(l.isFunction(a)?l.setTimeout(Q,0,{callbackFn:a,textBlockIndex:0}):b.invalidArg('getRawText','callbackFunction',a,'must be a function'));};b.highlight=function(a,d,g,k,f){if(c.documentLoaded)if(!1===h.hasRawText())b.logError('highlight','Search functionality has been disabled for this document');
else if(s)if(!1===c.deFeatures.highlights)b.logError('highlight','Highlighting functionality is not available for this document type');else if(!1!==k&&(k=!0),'string'!==typeof a)b.invalidArg('highlight','searchTerm',a,'must be a string');else if('string'!==typeof d)b.invalidArg('highlight','style',d,'must be a string');else if(g&&!l.isFunction(g))b.invalidArg('highlight','callbackFn',g,'must be a function');else{var n=h.firstACC(),r=m.createProgressDialog(w.PLEASE_WAIT,!0);s.beginBatch();l.setTimeout(R,
0,{searchTerm:a,callbackFn:function(a){var b=!0;if(a){var c=s.add(d,a,f);g&&(b=g.call(null,a,c));}else g&&g.call(null),b=!1;!1!==b&&(b=!0);b||(s.endBatch(),r.hide());return b;},startIterationFn:function(a){0<a&&(q.isPending()?r.update(10):r.update(a));e.suspendUpdate();},endIterationFn:e.resumeUpdate,caseSensitive:k,startACC:n});}else b.logError('highlight','Highlighting functionality has been disabled for this document');};b.select=function(a,d){if(c.documentLoaded){var g=!1;if(!1===h.hasRawText())b.logError('select',
'Javascript selection functionality has been disabled for this document');else if(null===a)g=k.select(null);else if(l.isDOMSelection(a)||l.isDOMRange(a))g=k.select(a);else{var e=z.validateRange(a,!0,!0);e?(g=b.selection(),g=0!=z.compare(e,g),!1!==d?t.moveto(e,function(){k.select(e);}):k.select(e)):b.invalidArg('select','range',a,'must be a valid text range, cell range, or rect range');}return g;}};b.selectionType=function(){if(c.documentLoaded)return k.selectionType();};b.selectionMode=function(a){a&&
(d.selectionMode=a);return d.selectionMode;};b.selectionStyle=function(a){if(void 0!==a&&null!==a&&'string'!==typeof a)b.invalidArg('selectionStyle','style',a,'Must be a valid CSS string');else return k.style(a);};b.selection=function(){if(c.documentLoaded)switch(k.selectionType()){case 'text':return k.textSelection();case 'cell':return k.cellSelection();case 'rect':return k.rectSelection();}};b.textSelection=function(){if(c.documentLoaded)return k.textSelection();};b.cellSelection=function(){if(c.documentLoaded)return k.cellSelection();};
b.rectSelection=function(){if(c.documentLoaded)return k.rectSelection();};b.getSelectedText=function(){if(c.documentLoaded)return e.getSelectedText();};b.textRange=function(){return z.textRange.apply(this,arguments);};b.cellRange=function(){return z.cellRange.apply(this,arguments);};b.rectRange=function(){return z.rectRange.apply(this,arguments);};b.updateViewSize=function(){v.dispatchResize();};var K=function(){if(c.deFeatures.fitpage){var a=90==d.rotation||270==d.rotation,b,g=e.padding();b=e.margin();
var h=g.left+g.right+b.left+b.right,g=g.top+g.bottom+b.top+b.bottom;a?(a=e.maxPageHeight(),b=e.maxPageWidth()):(a=e.maxPageWidth(),b=e.maxPageHeight());var k=c.viewNode;return{w:D((k.clientWidth-h)/a),h:D((k.clientHeight-g)/b)};}},H=function(a,g){!1!==a&&(a=!0);if(c.documentLoaded){var h;if(d.zoomMode){h=1;var k=K();if(k){switch(d.zoomMode){case 'page':h=Math.min(k.w,k.h);break;case 'pagewidth':h=k.w;break;case 'pageheight':h=k.h;break;case 'mobile':'worksheet'!==c.deType&&'database'!==c.deType&&(h=
k.w);}h=D(h);}d.zoom=h;}else if(c.nochrome||c.isMobile)if(k=K())h=Math.min(k.w,k.h),d.zoom<h&&(d.zoom=h);h=d.zoom;var k=J!=h||L!=d.zoomMode,f=E!=d.rotation;if(a||k||f)e.layoutChanged(g),c.drawing&&c.drawing.update(!0);if(a||k)J=h,L=d.zoomMode,b.on.zoom.dispatch(h,d.zoomMode,A);if(a||f)E=d.rotation,b.on.rotate.dispatch(d.rotation);v.dispatchScroll(a);}},M=function(){H(!0);};b.dispatchPageEvents=H;b.resetIdleTimer=function(){if(b.on.idle.hasListeners()){if(g)l.clearInterval(g);else{var c=b.resetIdleTimer;
f.listen('mousemove',c,!0);f.listen('touchmove',c,!0);f.listen('keydown',c,!0);a.on('document','scroll',c);}g=l.setInterval(b.on.idle.dispatch,200,b.on.idle);}else g&&(l.clearInterval(g),g=null,c=b.resetIdleTimer,f.unlisten('mousemove',c),f.unlisten('touchmove',c),f.unlisten('keydown',c),a.off('document','scroll',c));};a.on('content','first',function(){t.on.change.disable();var a=t.firstPage();a?a.load(!0,!0,P):b.logFatalError(null,'Fatal error in view: Document data is corrupt');});var P=function(){t.moveto(t.firstPage().index);
c.documentLoaded=!0;c.documentLoading=!0;b.on.load.dispatch();c.documentLoading=!1;t.on.change.enable();t.dispatchChange(void 0,!0);H(!0);c.documentComplete&&b.on.done.dispatch();};b.installDocument=function(a,d){var g=!0,h=f.create('div');h.html(d);(h=h.byClass('oit-view-root'))&&0<h.length&&(h=h[0]);var e,k,n;h&&(e=h.data('icd'),k=h.data('json'),n=h.data('page'));if(!e&&!k||'none'==k)g='This document can\'t be loaded into the web view.',v.invalidArg('load','url',a,'none'==k?g+' \nThe html file must be created in Ajax mode.':
g+' \nThe html file does not appear to have been created by Web View Export.'),g=!1;else{if(l.isRelativeURL(a)){var h=document.URL,r=h.indexOf('//');if(-1===r)c.URL=a;else{var r=r+2,m=h.lastIndexOf('/'),h=-1!=m&&m>r?h.substr(0,m+1):h+'/';'/'===a[0]&&(r=h.indexOf('/',r)+1,h=h.substr(0,r));c.URL=l.concatURL(h,a);}}else c.URL=a;q.initializeContent(k,e,n);b.initializeDocument();}return g;};b.unload=function(){var a=c.documentLoaded;c.documentLoaded=!1;c.documentComplete=!1;k.reset();s.clear();l.abortTimers();
y.abort();b.on.reset.dispatch();a&&b.on.unload.dispatch();d.zoom=1;d.zoomMode=null;A=!1;g&&(l.clearInterval(g),g=null);F={};I={};c.documentLoading=!1;c.drawing&&(c.drawing.destroy(),c.drawing=void 0);r&&(r.destroy(),r=void 0);C&&(C.destroy(),C=void 0);(a=c.viewNode)&&a.html('');c.URL=document.URL;};b.initializeDocument=function(){c.viewNode&&(c.drawing=new a.Drawing(c.viewNode),C=new a.DynamicStyleSheet('screen'),0<t.count()&&b.updateViewSize());};b.screenCSS=function(a,b){if(C)if(null==b)C.deleteRule(a);
else if('string'==typeof b)C.setRule(a+'{'+b+'}',a);else if('object'==typeof b){var c=a+'{',d;for(d in b)c+=d+':'+b[d]+';';C.setRule(c+'}',a);}};b.printCSS=function(b,c){r||(r=new a.DynamicStyleSheet('print'));if(null==c)r.deleteRule(b);else if('string'==typeof c)r.setRule(b+'{'+c+'}',b);else if('object'==typeof c){var d=b+'{',g;for(g in c)d+=g+':'+c[g]+';';r.setRule(d+'}',b);}};var O=function(){void 0===this.startACC&&('up'===this.direction?q.isPending()||(this.startACC=h.lastACC()):this.startACC=
h.firstACC());var b;b=void 0!=this.startACC?h.find(this.startACC,this.searchTerm,this.caseSensitive,this.direction):null;!b&&(q.isPending()||h.isPending())?(a.on('content','add',this,O),a.on('rawtext','add',this,O)):(b?this.callbackFn.call(null,b):this.callbackFn.call(null),a.off('content','add',O),a.off('rawtext','add',O));},R=function(b,c,d,g,e,k){b=!0;c=!1;void 0===this.startACC&&(this.startACC=h.firstACC());this.startIterationFn&&(d=100*this.startACC/h.lastACC(),this.startIterationFn(d));for(g=
0;100>g;g++)if(d=null,void 0!=this.startACC&&(d=h.find(this.startACC,this.searchTerm,this.caseSensitive)),d){if(!1===this.callbackFn.call(null,d)){b=!1;c=!0;break;}this.startACC=d.acc+1;}else{!q.isPending()&&!h.isPending()&&(this.callbackFn.call(null),c=!0);b=!1;break;}if(b)l.setTimeout(R,50,this);else if(c)a.off('content','add',R),a.off('rawtext','add',R);else if(q.isPending()||h.isPending())h.isPending()&&h.find(this.startACC,this.searchTerm,this.caseSensitive),a.on('content','add',this,R),a.on('rawtext',
'add',this,R);this.endIterationFn&&this.endIterationFn();},Q=function(){for(var b=!0,c=!1,d=0;10>d;d++){var g=h.getRawTextBlock(this.textBlockIndex);if(g)if(g.text){if(!1===this.callbackFn.call(null,g.text,g.range.acc)){b=!1;c=!0;break;}this.textBlockIndex++;}else{b=!1;break;}else{q.isPending()||(this.callbackFn.call(null),c=!0);b=!1;break;}}b?l.setTimeout(Q,50,this):c?(a.off('content','add',Q),a.off('rawtext','add',Q)):(a.on('content','add',this,Q),a.on('rawtext','add',this,Q));};b.removeExtraEmailHeaders=
function(){d.removeExtraEmailHeaders=!0;};a.on('content','data',function(b,c,d){if(b.properties)for(var g in b.properties)F[g]=b.properties[g];if(b.external)for(g in b.external)I[g]=b.external[g];if(b.options)for(var h in b.options)if(c=b.options[h],d=h.indexOf('.'),0<d&&(g=h.substring(0,d),h=h.substring(d+1),'glob'==g||'opt'==g))d=a[g],d.hasOwnProperty(h)&&(d[h]=c);});a.on('content','add',function(){var a=e.pageRect(t.count()-1,'overlay');a&&(a=a.bottom-20*(t.count()-1),b.printCSS('.oit-view-root',
'height:'+a+'px;'));});a.on('content','last',function(){c.documentComplete=!0;c.documentLoaded&&b.on.done.dispatch();});a.on('view','resize',function(){c.editingComment?s.alignComment():H(!0);});a.on('pages','change',function(){(1==t.activeOverlay().length||'vertical'!=d.scrollMode)&&H(!0);});d.oncenterPages(M);d.onrotation(M);}});OIT.extend('mod','pages',{exports:'count current info moveto movetoNext movetoPrev pageName ranges'.split(' '),events:{change:{pub:!0,detail:function(a){return this.pages.info(a.index);}},add:{pub:!0,detail:function(a){return{startPage:a};}},pageload:{},pageunload:{}},install:function(a,b){var d=a.opt,c=a.glob,f=a.doc,e=a.util,l=a.range,p=a.content,h=a.display,q=a.dialog,m=a.selection,k=a.highlights,z=a.math,s=OIT.local,t=[],v=[],y=null,w=null,x=null,u=0,B=1,n,A,g,r=0,C=0,F,I,J,L={},E={};b.firstPage=
function(){for(var a in v)return v[a];};b.current=function(){return!w?0:w.index;};b.pageName=function(a){void 0===a&&(a=b.current());if(a=v[a])return a.name;};b.count=function(){return v.length;};b.each=function(a,b){e.eachArgs(v,arguments);};b.moveto=function(a,c){var d;e.isFunction(c)&&(d={callbackFn:c});if('object'===typeof a){if(f.isElement(a)||f.isText(a))return d.gotoNode=a,M(d);var g=l.validateRange(a);if(g)if(d.range=l.clone(g),g=b.nearestForRange(d.range),d.pageIndex=g.index,g.dataRequest)e.setTimeout(b.moveto,
200,null,a,c);else return b.movetoEx(a,d);}else return b.movetoEx(a,d);};var D=function(a){b.updateActivePage(a.pageIndex);a.callbackFn&&a.callbackFn.call(null,w.index);};b.movetoEx=function(a,d){d=d||{};c.viewNode.cancelKinetic();if('number'===typeof a)return d.pageIndex=a,H(d);if('object'===typeof a){if(f.isElement(a)||f.isText(a))return d.gotoNode=a,M(d);var g=l.validateRange(a);if(g)return d.range=l.clone(g),P(d);if('number'===typeof a.left&&'number'===typeof a.top&&'number'===typeof a.right&&'number'===
typeof a.bottom)return d.rect=a,O(d);}b.logError('moveto','Invalid destination: '+e.stringify(a));return w.index;};var K=function(a,d){var g=a.overlay,e=g!==y;if(!d&&!e)return!1;if(e){k.deactivate();m.select(null);h.unloadDisplay();var f=y,n=c.viewNode;f&&(f.saveScroll=n.scroll(),f.hide());g.show();}a.isLoaded()&&(y=g,b.updateActivePage(a.index),h.loadDisplay(a));g.hasClass('oit-pagestream')?c.viewNode.addClass('oit-pagestream'):c.viewNode.removeClass('oit-pagestream');g.saveScroll?(n.scroll(g.saveScroll),
delete g.saveScroll):e&&n.scroll(0,0);b.updateActivePage();return!0;},H=function(a){var g=a.pageIndex;if(v[g])if(a.force||a.gotoNode||!w||g!=w.index){var e=v[g];V(g);if(e.isPending())e.load(!0,!0,function(){a.force=!0;H(a);}),'email'!==e.type&&e.overlay===y?h.moveto(e.index,null,{animate:!1}):y||K(e);else{g=K(e,a.force);if('vertical'!=d.scrollMode||g)a.animate=!1;b.updateActivePage(e.index);('email'===e.type||!h.moveto(w.index,D,a))&&D(a);}}else D(a);else 0<=g&&p.isPending()?(q.showMessage(s.PLEASE_WAIT_DOWNLOADING),
p.on.add.listenOnce(function(){q.hideMessage();H(a);})):(b.logError('moveto','Invalid page index: '+g),void 0!==c.singlePageIndex&&(a.pageIndex=c.singlePageIndex),D(a));if(w)return w.index;},M=function(a){var c=b.forNode(a.gotoNode);c?(a.pageIndex=R(c.index),a.pageIndex!=c.index&&(a.gotoNode=null),H(a)):(b.logError('moveto','The specified node was not found on any page in the document.'),D(a));return w.index;},P=function(a){if(c.documentLoading)e.setTimeout(P,0,null,a);else{var g=b.nearestForRange(a.range);
g?g.isPending()?(K(g),g.load(!0,!0,function(){P(a);})):!w||g.overlay!==w.overlay||'vertical'!=d.scrollMode&&g!==w?H({pageIndex:g.index,callbackFn:function(){P(a);}}):h.loadRange(a.range,function(){if(!h.moveto(a.range,D,a)){var b=h.rangeRect(a.range,'view');b&&void 0===a.range.bSlideNote?(a.rect=b,O(a)):(a.pageIndex=g.index,H(a));}}):p.isPending()?(q.showMessage(s.PLEASE_WAIT_DOWNLOADING),p.on.add.listenOnce(function(){q.hideMessage();P(a);})):(b.logError('moveto','The specified range was not found in the document: '+
e.stringify(a.range)),D(a));}return w.index;},O=function(b){var d=b.rect,g=c.viewNode,h=g.scroll(),e=d.left+h.left,k=d.right+h.left,f=d.top+h.top,n=d.bottom+h.top,l=h.left,r=h.left+g.clientWidth,m=h.top,u=h.top+g.clientHeight,d=h.left,A=h.top;!0===b.moveToTop?A=f:f<m?(n-=g.clientHeight,0>n&&(n=0),A=f-20,A<n&&(A=n)):n>u&&(A=n+20-g.clientHeight,A>f&&(A=f));e<l?(k=e-g.clientWidth,0>k&&(k=0),d=e-20,d<k&&(d=k)):k>r&&(d=k+20-g.clientWidth,d>e&&(d=e));d!=h.left||A!=h.top?(a.disableEvent('document','scrollupdate'),
h=c.deType,h=!b.moveToTop&&'worksheet'!=h&&'database'!=h?150:0,g.abortAnimation(),g.animate({scrollLeft:d,scrollTop:A,time:h,endFn:function(){a.enableEvent('document','scrollupdate');a.dispatch('document','scrollupdate');D(b);}})):D(b);return w.index;};b.movetoPrev=function(a){var c=b.prev();c&&b.moveto(c.index,a);return w.index;};b.movetoNext=function(a){var c=b.next();c&&b.moveto(c.index,a);return w.index;};b.info=function(a){void 0===a&&(a=b.current());if(v[a])return v[a].info();};b.next=function(a){void 0===
a&&(a=w.index);a+=1;if(v[a]){if('slideshow'!=d.presentationMode)return v[a];for(;a<v.length;a++){var b=v[a];if(b&&b.isEnabled())return b;}}};b.prev=function(a){void 0===a&&(a=w.index);a-=1;if(v[a]){if('slideshow'!=d.presentationMode)return v[a];for(;0<=a;a--){var b=v[a];if(b&&b.isEnabled())return b;}}};var R=function(a){if('slideshow'!=d.presentationMode||'slide'!=v[a].type)return a;for(var b=a;b<v.length;b++)if(v[b]&&v[b].isEnabled())return b;for(b=a;0<b;b--)if(v[b]&&v[b].isEnabled())return b;return 0;};
b.loadNextPageFromServer=function(){var a,c=b.top(),d=b.bottom();0>B?(c-=3,d+=1):d+=3;0>c&&(c=0);d>=v.length&&(d=v.length-1);if(0>B){if(void 0===n||n>d)n=d;for(;n>=c;n--){var g=v[n];if(g&&g.overlay===y&&g.isPending()){g.load(!0,!1);a=n--;break;}}}else{if(void 0===n||n<c)n=c;for(;n<=d;n++)if((g=v[n])&&g.overlay===y&&g.isPending()){g.load(!0,!1);a=n++;break;}}return a;};b.updateActivePage=function(a){if(y){var g=w,e=c.viewNode.scroll().top;if(void 0!==a)g=b.page(a)||w;else if(1==y.length)g=y.firstPage;
else if('vertical'==d.scrollMode&&void 0===c.singlePageIndex&&e!=u&&(a=b.mapToPage(10,20)))g=a.page;e!=u&&(B=e<u?-1:1,u=e);if(g!=w&&!0!=g.bNotesBar){w=g;y=w.overlay;e=h.topPageIndex();for(g=h.bottomPageIndex();e<=g;e++)V(e);b.dispatchChange(w);}}};b.page=function(a){return v[a];};b.byName=function(a){for(var b in v)if(v[b].name===a)return v[b];};b.forNode=function(a){return f.wrap(a).ancestorData('page');};b.nearestForRange=function(a){var c,d=b.pagesForRange(a);if(!d&&'text'===a.type)for(var g=0;g<v.length;g++){var e=
v[g];if(e&&'drawing'===e.type&&a.accend>=e.acc&&a.acc<=e.accend){d=[e];break;}}if(d)if(1==d.length)d[0].isEnabled()&&(c=d[0]);else for(var k=b.top(),f=b.bottom(),n,g=0;g<d.length;g++)if(e=d[g],e.isEnabled()){var l=e.index,r=0;l<k?r=k-l:l>f&&(r=l-f);if(!c||r<n)c=e,n=r;else if(0==r&&(l=h.rangeRect(a,c))&&0>l.bottom)c=e,n=r;}return c;};b.forRange=function(a,b,c){b=b||0;!0!==c&&(c=!1);switch(a.type){case 'text':for(;b<v.length;b++){var d=v[b];if(d&&a.accend>=d.acc&&a.acc<=d.accend){if(!0===c&&('worksheet'===
d.type||'database'===d.type||'email'===d.type))d.isLoaded()||d.load(!1);if(d.containsRange(a))return d;}}break;case 'cell':case 'rect':if(a.page>=b&&a.page<v.length)return v[a.page];}};b.pagesForRange=function(a,c){for(var d,g=0;g<v.length;){g=b.forRange(a,g,c);if(!g)break;d||(d=[]);d.push(g);g=g.index+1;}return d;};b.top=function(){return h.topPageIndex();};b.bottom=function(){return h.bottomPageIndex();};b.mapToPage=function(a,h,e,k){var f;if(e)f=e.pageRect('view');else if(!0==d.showSlideNotes&&g&&g.inRect(a,
h))e=g;else if(w){e=w;var n=!0;!0!==k&&'email'==e.type&&(n=!1,0==e.index&&(e=2<=v.length?v[1]:null));e&&(f=e.pageRect('view'));if('vertical'==d.scrollMode&&void 0===c.singlePageIndex&&1<y.length)for(;f;)if(h<f.top){k=b.prev(e.index)||e;if(0==e.index||!n&&0==k.index)break;if(k.overlay!=e.overlay)break;var l=k.pageRect('view');if(h>l.bottom){f.top-h>h-l.bottom&&(e=k,f=l);break;}e=k;f=l;}else if(h>f.bottom){if(e.index==v.length-1)break;k=b.next(e.index)||e;if(k.overlay!=e.overlay)break;l=k.pageRect('view');
if(h<l.top){l.top-h<h-f.bottom&&(e=k,f=l);break;}e=k;f=l;}else break;}if(e){f&&(a-=f.left,h-=f.top);c.deFeatures.zoom&&(f=d.zoom,1!=f&&(a=z.round(a/f),h=z.round(h/f)));if(c.deFeatures.rotate&&(n=d.rotation,0!=n))switch(f=e.pageRect(),k=a,l=h,n){case 90:a=f.width-l;h=k;break;case 180:a=f.width-k;h=f.height-l;break;case 270:a=l,h=f.height-k;}return{page:e,x:a,y:h};}};b.elementRect=function(b,d){var g=new a.Rectangle(b.rect(c.viewNode),'view');g.origin=d;return g;};b.findTextRange=function(a){if('text'===
a.type){var b;if('vertical'!=d.scrollMode||void 0!==c.singlePageIndex)void 0!==w.acc&&(a.acc<=w.accend&&a.accend>=w.acc)&&(b=w.findTextRange(a));else for(var g in v){var h=v[g];if(h.overlay===y&&(h.isLoaded()&&h.isEnabled()&&void 0!==h.acc&&a.acc<=h.accend&&a.accend>=h.acc)&&(h=h.findTextRange(a)))if(b)for(var e=0;e<h.length;e++)b.push(h[e]);else b=h;}return b;}};b.isDocumentText=function(a,c){return b.forRange(l.textRange(a,c),0,!0)?!0:!1;};b.maxWidth=function(){if(y)return'vertical'!=d.scrollMode||
void 0!==c.singlePageIndex?w.width:y.maxWidth;};b.maxHeight=function(){if(y)return'vertical'!=d.scrollMode||void 0!==c.singlePageIndex?w.height:y.maxHeight;};b.decomposeRange=function(a,b){var c;if(void 0!==a.page){var d=v[a.page];if(d){if('rect'===a.type)c=d.mapRectRangeToText(a);else if('cell'===a.type){var g=d.spreadsheetModel();g&&(c=g.decomposeRange(a,b));}(d=d.mapRangeToEmbeds(a))&&(c=c?c.concat(d):d);}}return c;};b.ranges=function(a){var c={};void 0===a&&(a=b.current());if(v[a]&&(a=v[a].textRanges())&&
0<a.length)c.text=a;return c;};b.notesBar=function(){return g;};var Q=function(){if(c.dynamicContent){switch(d.memoryModel){case 'none':C=0;break;case 'large':C=5242880;break;case 'small':C=1048576;break;case 'micro':C=524288;break;default:C=c.isMobile?1048576:5242880;}b.applyMemoryLimit();}else C=0;};b.applyMemoryLimit=function(a){void 0!==a&&(r+=a,b.logMemory&&b.logMemory(r,C));if(0<C&&r>C){if(F){var c=F;a=b.top();for(var d=b.bottom();c;){var g=c.nextNewer;if(0<c.loadedSize&&!c.locked&&(c.index<a||c.index>
d))if(r-=c.loadedSize,c.unload(),r<=C)break;c=g;}}b.logMemory&&b.logMemory(r,C);}};var V=function(a){if((a=v[a])&&a!=I)void 0===I?F=a:(a==F&&(F=a.nextNewer),a.nextNewer&&(a.nextNewer.nextOlder=a.nextOlder),a.nextOlder&&(a.nextOlder.nextNewer=a.nextNewer),I.nextNewer=a,a.nextOlder=I,a.nextNewer=void 0),I=a;},G=function(){var d=b.firstPage(),d=d&&d.isSpreadsheet();if(void 0===c.singlePageIndex&&(d||1<t.length)){A||(A=new a.TabBar,A.addPrevNext(b.movetoPrev,b.movetoNext));for(d=A.length();d<t.length;d++){var g=
t[d],h=g.firstPage;if(!h)break;A.addTab(g.name,b.moveto,h.index);}A.show();y&&A.setActiveTab(y.index);}else A&&(A.destroy(),A=null);};b.dispatchChange=function(a,c){a||(a=w);if(a==x&&!c)return!0;x=a;A&&A.setActiveTab(a.overlay.index);if(g){var d=g.getPageNumber();-1!=d&&g.removeHighlightsFromPage(d);(d=a.byClass('oit-slidenote'))?(d=d[0].html(),g.setContents(d),g.setPageNumber(a.index),g.addHighlightsToPage(a.index)):(g.setContents(''),g.setPageNumber(-1));}return b.on.change.dispatch(a);};b.overlayById=
function(a){return e.byProperty(t,'id',a);};b.pageById=function(a){return e.byProperty(v,'id',a);};b.activeOverlay=function(){return y;};b.activePage=function(){return w;};var S=function(){G();u=void 0;};d.onmemoryModel(Q);d.onnochrome(S);d.onscrollMode(function(){u=void 0;});d.onshowSlideNotes(function(b){if(void 0!==b)if(!g&&!0==b){if(w&&'slide'==w.type&&(g=new a.NotesBar)){if(b=w.byClass('oit-slidenote'))b=b[0].html(),g.setContents(b),g.setPageNumber(w.index);g.show();}}else!0==b?g.show():g&&((b=m.textSelection())&&
!0==b.bSlideNote&&m.select(null,null),g.hide());});a.on('document','reset',function(){for(var a in v){var b=v[a],c=b;r-=c.loadedSize;c.unload();b.destroy();}v=[];e.each(t,'destroy');t=[];x=w=y=null;u=0;B=1;A&&(A.destroy(),A=null);g&&(g.destroy(),g=null);J&&(J.destroy(),J=void 0,L={},E={});C=r=0;I=F=n=void 0;});a.on('content','data',function(h,e,k){var f;if(k=h.style){J||(J=new a.DynamicStyleSheet);var n=[],l=[];for(e=0;e<k.length;e++){var r=k[e];if('string'===typeof r)l.push(r);else if(r.s&&r.p){var m=
r.s,r=r.p;'@font-face'===m?L.hasOwnProperty(r)||(L[r]=!0,n.push(m,'{',r,'}')):E.hasOwnProperty(m)||(E[m]=!0,l.push(m,'{',r,'}'));}}0<n.length&&J.addCSSText(n.join(''));0<l.length&&J.addCSSText(l.join(''));}if(h.overlays)for(e=0;e<h.overlays.length;e++)k=h.overlays[e],b.overlayById(k.oid)||t.push(new a.Overlay(t.length,k));if(h.pages){f=v.length;for(e=0;e<h.pages.length;e++){k=h.pages[e];n=null;'email'===k.type&&(c.singlePageIndex=void 0);if(void 0!==k.index){if(l=parseInt(k.index),void 0===c.singlePageIndex||
c.singlePageIndex===l)v[l]||(v[l]=new a.Page(l,k.type,k.id)),n=v[l];}else n=new a.Page(v.length,k.type,k.id),v.push(n);n&&n.processData(k);}b.applyMemoryLimit();}G();(h=b.firstPage())&&'slide'==h.type&&!0==d.showSlideNotes?g||(g=new a.NotesBar):g&&(g.destroy(),g=null);void 0!==f&&v.length>f&&b.on.add.dispatch(f);});a.on('content','add',b.updateActivePage);a.on('document','scrollupdate',b.updateActivePage);a.on('document','load',function(){Q();S();});a.on('user','endscroll',b.updateActivePage);}});OIT.extend('mod','highlights',{exports:'activate active add addNote addStamp apply autoHighlight autoHighlightOptions clear comment current deactivate defineStamp first getJSON hide hideComment isHidden label last moveto movetoNext movetoPrev next prev properties property range redact remove pageTryReset serialize setOptions show showComment style type validateStyles'.split(' '),events:{activate:{pub:!0,detail:function(a,b,d){return{highlightid:a?a.id:void 0,before:b,after:d};}},add:{pub:!0,detail:function(a){return{highlightid:a.id};}},
remove:{pub:!0,detail:function(a){return{highlightid:a.id};}},move:{pub:!0,detail:function(a){return{highlightid:a.id};}},comment:{pub:!0,detail:function(a){return{highlightid:a.id};}},mode:{pub:!0,detail:function(a){return{autohighlight:a,autooptions:this.highlights.autoHighlightOptions(),selectionmode:this.document.selectionMode()};}}},userEventDef:{pub:!0,detail:function(a,b,d){return{highlightid:d.id,srcEvent:b};}},install:function(a,b){var d=a.opt,c=a.glob,f=a.doc,e=a.util,l=a.range,p=a.display,h=
a.document,q=a.css,m=a.selection,k=a.pages,z=a.view,s={},t=function(a){var b=a.toLowerCase();s[a]={w:'border'+a+'Width',c:'border'+a+'Color',wp:'border-'+b+'-width',cp:'border-'+b+'-color',sp:'border-'+b+'-style'};};t('Top');t('Right');t('Bottom');t('Left');var v=!1,y=[],w=0,x,u,B,n,A=-1,g=-1,r,C,F,I=!1,J=!1,L=!1,E,D={comment:null,label:null,sticky:!1,style:null,stamp:null,properties:null,enableUserDelete:!0,enableUserComment:!0,enableUserResize:!0,enableUserMove:!0},K=!0,H=[],M,P={x:0,y:0},O=[];b.add=
function(){var a=arguments,b=1,c={};oa(0,a,c,'add');c.invalid||(b=ga(b,a,c,'add'));c.invalid||(e.isDOMRange(c.range)||e.isDOMSelection(c.range)?c.type='hl-text':c.type='hl-'+c.range.type,sa(0,a,c,'add'));c.invalid||(b=pa(b,a,c,'properties','add'),b=qa(b,a,c,'comment','add'));c.invalid||ra(b,a,c,'add');if(!c.invalid)return da(c);};b.addNote=function(){var a=arguments,c=1,d={type:'note'};oa(0,a,d,'addNote');d.invalid||(c=ga(c,a,d,'addNote'));d.invalid||('cell'!==d.range.type&&'rect'!==d.range.type&&
(b.invalidArg('addNote','range',d.range,'Anchored notes may only be added to rect or cell ranges'),d.invalid=!0),sa(0,a,d,'addNote'));d.invalid||(c=pa(c,a,d,'properties','addNote'),c=qa(c,a,d,'comment','addNote'));d.invalid||ra(c,a,d,'addNote');if(!d.invalid)return da(d);};b.redact=function(){var a,b=arguments,c={type:'redaction'};a=ga(0,b,c,'redact');c.invalid||(a=pa(a,b,c,'properties','redact'),a=qa(a,b,c,'label','redact'));c.invalid||ra(a,b,c,'redact');if(!c.invalid){if('compound'===d.redactionMode||
'hybrid'===d.redactionMode&&'cell'===c.range.type)c.compound=!0;a:{a=c;b=!1;a.range.embedId?b=!1:'hybrid'===d.redactionMode?b='rect'===a.range.type:'simple'===d.redactionMode&&(b='rect'===a.range.type||'cell'===a.range.type);if(b){var g=k.decomposeRange(a.range);if(g){var b=[],c=a.range,h=k.page(c.page),e=p.rangeRect(c,h),f=a.activate;a.activate=!1;for(var n=0;n<g.length;n++)a.range=g[n],b.push(ia(a));if('drawing'===h.type||'slide'===h.type||'chart'===h.type){g=0===b.length;if(!g)for(n=0;n<b.length;n++){var l=
y[b[n]].range;if('rect'!==l.type){g=!0;break;}else if(l=p.rangeRect(l,h),!l||!l.equals(e)){g=!0;break;}else if(l.equals(e)){g=!0;break;}}g&&(a.range=c,b.unshift(ia(a)));}if(0<b.length){f&&X(b[0]);1==b.length&&(b=b[0]);a=b;break a;}}}a=da(a);}return a;}};b.apply=function(a,d){if(!Array.isArray(a)){try{a=JSON.parse(a);}catch(g){b.invalidArg('apply','highlights',a,'Error parsing JSON string: '+g.message);return;}a&&(a.range&&'object'==typeof a.range)&&(a=[a]);}if(Array.isArray(a))if(c.documentLoaded){d=e.isFunction(d);
for(var h={filterFn:null,highlightIndex:null},k=0;k<a.length;k++){var f=a[k];if('sdef'==f.type)b.defineStamp(f.stamp,f.url);else if(h.filterFn=d,h.highlightIndex=k,l.validateRange(f.range)){var n=[];if('stamp'==f.type){var r={name:f.stamp};f.opacity&&(r.opacity=f.opacity);f.sizing&&(r.sizing=f.sizing);n.push(r);n.push(f.range);f.hasOwnProperty('properties')&&n.push(f.properties);f.hasOwnProperty('comment')&&n.push(f.comment);b.addStamp.apply(void 0,n);}else da(f,h);}}}else x=x?a.concat(x):a;};b.remove=
function(a,b){var c=W(a,r,'remove');c&&R(c,b);};var R=function(a,c){var d=a.id;void 0===c&&(c=!0);b.on.remove.dispatch(a);var g,h=!1,e=!1;d==r?(X(void 0,!1,!1,c),r=void 0,void 0!=a.prevId?(g=a.prevId,e=!0):void 0!=a.nextId&&(g=a.nextId,h=!0)):c=!1;b.hideComment(d);b.unmap(a);a.destroy();y[d]=null;d<w&&(w=d);void 0!==g&&X(g,h,e,c,!1,!1);};b.removeFromRange=function(a){Array.isArray(a)?e.each(a,b.removeFromRange):'text'===a.type&&b.each(Q,null,a);};var Q=function(a,c){var d=a.range;'text'===d.type&&d.accend>=
c.acc&&d.acc<=c.accend&&b.remove(a.id,!1);};b.clear=function(a){a=e.isFunction(a);b.each(R,a,!1);a||(r=void 0,y=[],w=0,O=[]);};t=function(){var a=d.highlightLabelFontFamily,c=d.highlightLabelFontSize,g='';a&&(g+='font-family:'+a+';');c&&(g+='font-size:'+c+';');h.screenCSS('.oit-highlight-label',g);b.each('showLabel',null,d.showHighlightLabels);};b.setOptions=function(a,b){b&&ea(a,r,'setOptions',null,[b]);};b.getOption=function(a,b){return ea(a,r,'getOption',null,[b]);};b.style=function(a,c){var d=W(a,
r,'style');if(d){if(!c)return d.style();var g=la(c,'hl-text'!=d.type);if(g)return d.style(g);b.invalidArg('style','style',c);}};b.comment=function(a,c,d){if(a=W(a,r,'comment')){var g=a.comment();void 0!==c&&c!==g&&(!d&&a.id===b.active()&&!a.isNote()?(b.hideComment(),g=a.comment(c),b.showComment()):g=a.comment(c),b.on.comment.dispatch(a));return g;}};var V=function(a){if('scale'==a||'stretch'==a||'image'==a)return a;},G=function(a){if(a&&!isNaN(a)&&(a=Number(a),0<=a&&1>=a))return a;},S=function(a){if(a&&
!isNaN(a.x)&&!isNaN(a.y))return{x:Math.round(a.x),y:Math.round(a.y)};},N=function(a){a.img=new Image;a.img.src=a.url;a.img.onload=function(){a.height=this.height;a.width=this.width;a.defaultSize&&(this.style.width=a.defaultSize.x,this.style.height=a.defaultSize.y);delete a.img;};};b.stamp=function(a){if(n)return n[a];};b.label=function(a,b){return ea(a,r,'label',null,[b]);};b.defineStamp=function(a,b,c){n||(n={});b?(c=c||{},b={url:b},c.sizing&&(b.sizing=V(c.sizing)),c.opacity&&(b.opacity=G(c.opacity)),
c.defaultSize&&(b.defaultSize=S(c.defaultSize)),n[a]=b,N(n[a])):delete n[a];};var T=function(a){if(a){var b;if(a instanceof String||'string'==typeof a)b={name:a};else{b={};for(var c in a)b[c]=a[c];}if(b.name&&n&&n[b.name])return b.type='stamp',b.stamp=n[b.name],b;}};b.addStamp=function(){var a=arguments,c=T(a[0]);if(c){c.sizing=V(c.sizing)||c.stamp.sizing||'scale';c.opacity=G(c.opacity)||c.stamp.opacity||1;c.defaultSize=S(c.defaultSize)||c.stamp.defaultSize;var d;d=ga(1,a,c,'addStamp');var g=c.range;
g&&'rect'!=g.type&&'cell'!=g.type?(b.invalidArg('addStamp','range',g),c.invalid=!0):'rect'===g.type&&l.isEmpty(g)?c.range=ba(g.left,g.top,'rect',c):'cell'===g.type&&(g.c1==g.c2&&g.r1==g.r2)&&(c.range=ba(g.c1,g.r1,'cell',c));c.invalid||(d=pa(d,a,c,'properties','addStamp'),d=qa(d,a,c,'comment','addStamp'));ra(d,a,c,'addStamp');if(!c.invalid)return da(c);}else b.invalidArg('addStamp','stamp',a[0],'Must be the name of a defined stamp');};b.getJSON=function(a){if(a=W(a,r,'getJSON'))return JSON.stringify(a.serialize());};
b.serialize=function(a){var c=[],d,g;e.isFunction(a)?d=a:Array.isArray(a)?g=a:'number'===typeof a&&(g=[a]);b.each(U,d,c,{},g);return JSON.stringify(c,null,!1);};var U=function(a,b,c,d){if(!d||-1!=d.indexOf(a.id))a=a.serialize(),a.stamp&&!c[a.stamp]&&(b.push({type:'sdef',stamp:a.stamp,url:n[a.stamp].url}),c[a.stamp]=!0),b.push(a);};b.properties=function(a,b){return ea(a,r,'properties',null,[b]);};b.property=function(a,b,c){return ea(a,r,'property',null,[b,c]);};b.current=function(){return r;};b.active=
function(){if(!I&&!J)return r;};b.moveto=function(a){(a=W(a,r,'moveto'))&&X(a.id,!1,!1,!0,!0,!0);return r;};b.movetoNext=function(a){if(void 0===r)void 0!==u&&b.moveto(u);else{var c=r;if(I&&y[c].filter(a)&&ka(c))return b.moveto(c);for(;;){var d=y[c].nextId;if(void 0===d)break;c=y[d];if(c.filter(a)&&(c=k.nearestForRange(c.range)))return c.isLoaded()?X(d):k.moveto(c.index,function(){X(d);}),d;c=d;}}return r;};b.movetoPrev=function(a){if(void 0===r)void 0!==B&&b.moveto(B);else{var c=r;if(J&&y[c].filter(a)&&
ka(c))return b.moveto(c);for(;;){c=y[c].prevId;if(void 0===c)break;var d=y[c];if(d.filter(a)&&(d=k.nearestForRange(d.range)))return d.isLoaded()?X(c):k.moveto(d.index,function(){b.movetoPrev(a);}),c;}}return r;};b.type=function(a){if(a=W(a,r,'type'))switch(a.type){case 'note':case 'redaction':case 'stamp':return a.type;default:return'highlight';}};b.range=function(a){if(a=W(a,r,'range'))return a.range;};b.show=function(a){void 0===a||e.isFunction(a)?b.each('show',a):ea(a,r,'show');};b.hide=function(a){void 0===
a||e.isFunction(a)?b.each('hide',a):ea(a,r,'hide');b.alignHighlight();};b.isHidden=function(a){return ea(a,r,'isHidden');};b.showComment=function(a,c){Array.isArray(a)&&(a=a[0]);var d=W(a,r,'showComment');if(d){c=c||{};c.mode||(c.mode='view');var g=b.active();if(void 0!==g&&(g=y[g],g.isNote()&&g.isEditing()))return;if(d.isNote())switch(c.mode){case 'view':d.show();d.endEditText(!0);break;case 'edit':d.beginEditText(!1);break;case 'new':d.beginEditText(!0);}else d.dialog(c.mode);}};b.hideComment=function(a){(a=
W(a,r,'hideComment'))&&(a.isNote()?a.collapse():a.hideDialog());};var Y=function(a){(a=W(a))&&a.loadPage();};b.first=function(){Y(u);return u;};b.last=function(){Y(B);return B;};b.next=function(a){if(a=W(a,r,'next'))return Y(a.nextId),a.nextId;};b.prev=function(a){if(a=W(a,r,'prev'))return Y(a.prevId),a.prevId;};b.activate=function(a){(a=W(a,r,'activate'))&&X(a.id);};b.deactivate=function(){X(void 0,!1,!1,!0);};var $=function(a){if(a)for(var c in D)void 0!==a[c]&&(D[c]=a[c]);m.enableCellOffsets('note'===
L||'stamp'===L);ja();b.on.mode.dispatch(L);};b.autoHighlightOptions=function(a){void 0!==a&&$(a);a={};for(var b in D)a[b]=D[b];return a;};b.autoHighlight=function(a,d){if(!1===a){m.select(null);if(E){var g=c.deFeatures;switch(E){case 'text':g.textselection||(E=null);break;case 'rect':g.rectselection||(E=null);break;case 'cell':g.cellselection||(E=null);break;default:E=null;}E&&(h.selectionMode(E),E=null);}L=!1;$();}else if('selection'===a||'note'===a||'redaction'===a||'stamp'===a){d=d||{};D.comment=null;
D.sticky=!1;D.properties=null;m.select(null);if('stamp'===a){if(!T(d.stamp))return b.invalidArg('autoHighlight','options.stamp',d.stamp),L=!1;}else if(('selection'===a||'note'===a)&&!la(d.style,!0))return b.invalidArg('autoHighlight','options.style',d.style),L=!1;L=a;E||(E=h.selectionMode());if('note'===a||'redaction'===a||'stamp'===a)g=c.deFeatures,g.rectselection||'redaction'===a&&g.rectredaction?h.selectionMode('rect'):g.cellselection&&h.selectionMode('cell');$(d);}return L;};b.beginBatch=function(){v=
!0;};b.endBatch=function(){v&&(v=!1,ma(A,g));};var ja=function(){if('selection'===L||'note'===L)m.style(D.style,!1);else if('redaction'===L){var a;d.redactionFillColor&&'compound'===d.redactionMode&&'rect'===h.selectionMode()?a=d.redactionFillColor:(a=q.stringToColor(d.redactionColor),0.7<a.a&&(a.a=0.7),a=q.colorToString(a.r,a.g,a.b,a.a));m.style('background-color:'+a+';',!1);}else if('stamp'===L)if(n&&(a=n[D.stamp]),a){var b='background:url('+a.url+') no-repeat';'number'===typeof a.opacity&&1!=a.opacity&&
(b+=';opacity:'+a.opacity);'scale'==a.sizing?b+=';background-size:contain':'stretch'==a.sizing&&(b+=';background-size:100% 100%');m.style(b);}else m.style(null);else m.style(null);},ba=function(a,b,c,d){var g,h;d&&(d.defaultSize&&(g=d.defaultSize.x,h=d.defaultSize.y),g||(g=d.width),h||(h=d.height));g||(g=200);h||(h=200);a=k.mapToPage(a,b);d&&(a.x-=Math.floor(g/2),a.y-=Math.floor(h/2));return p.rangeFromRect(a.page.index,a.x,a.y,a.x+g,a.y+h,a.page,'move');},ka=function(a){return'slideshow'!=d.presentationMode?
!0:(a=l.validateRange(y[a].range))&&k.nearestForRange(a)?!0:!1;};b.startSelection=function(){F=b.active();X(void 0,!1,!1,!1);};b.endSelection=function(){F=void 0;};a.on('document','select',function(a,d,g,h,e){var k=!0;if(a&&L){var f=a,n='note'===L,l='stamp'===L;if(n&&!c.deFeatures.anchorednotes||(n||l)&&'text'===f.type&&!h)return!0;a=n||!0===D.comment;if(h)if((n||l)&&g&&void 0===F){var r;l&&((d=T(D.stamp))?r=d.stamp:f=null);f&&(d=c.deFeatures,f=d.rectselection?ba(g.x,g.y,'rect',r):d.cellselection?ba(g.x,
g.y,'cell',r):null);f||m.select(null);}else m.select(null),f=null;else n&&(d&&g)&&'rect'===f.type&&(r=f.bottom-f.top,100>f.right-f.left&&(d.x<g.x?f.right=f.left+100:f.left=f.right-100),80>r&&(d.y<g.y?f.bottom=f.top+80:f.top=f.bottom-80));if(f&&void 0===e){var u;'text'===f.type&&(f=document.getSelection());'redaction'===L?u=b.redact(f,D.properties,D.label):l?T(D.stamp)&&('rect'===f.type||'cell'===f.type)?u=b.addStamp(D.stamp,f,D.properties):m.select(null):n?'rect'===f.type||'cell'===f.type?u=b.addNote(D.style,
f,D.properties):m.select(null):u=b.add(D.style,f,D.properties);if(void 0!==u){g=Array.isArray(u)?u:[u];e='string'===typeof D.comment?D.comment:void 0;for(k=0;k<g.length;k++)u=y[g[k]],u.setOptions(D),e&&u.comment(e);m.select(null);b.activate(g[0]);a&&b.showComment(g,{mode:'new'});k=!1;D.sticky||b.autoHighlight(!1);}}}return k;});b.alignComment=function(){b.each('alignDialog');};a.on('display','displayload',function(a,c){A=a.index;g=c.index;b.each('addToPage',null,A);g>A&&ma(A+1,g);});a.on('display','displayunload',
function(a,c){b.each('destroyDialog');g=A=-1;});a.on('pages','pageload',function(a){-1!=g&&a.index>g&&(g=k.activeOverlay().lastPage.index);0<y.length&&(a.index>=A&&a.index<=g)&&b.each('addToPage',null,a.index);});a.on('pages','pageunload',function(a){a.index>=A&&a.index<=g&&(b.each('removeFromPage',null,a.index),a.highlightLayer=void 0);});b.onEmailTabActivate=function(){b.each('addToPage',null,0);b.positionAll();};b.alignHighlight=function(){void 0!=r&&(!I&&!J)&&X(r,!1,!1,!1,!1,!0);};b.move=function(a,
b,c,d,g,h){b=b||0;d=d||0;c=c||0;g=g||0;h=h||!1;if((a=W(a))&&(b||d||c||g)&&a.getOption('enableUserMove')){var e=l.clone(a.range);if('rect'===e.type){var k=h?1:10;h=p.pageRange(e.page,e.type);e.left+=b*k;e.top+=c*k;e.right+=d*k;e.bottom+=g*k;var k=e.right-e.left,f=e.bottom-e.top;b&&(0>e.left?(e.left=0,d&&(e.right=k)):e.left>=e.right&&(e.left=e.right-1));d&&(e.right<=e.left?e.right=e.left+1:e.right>h.right&&(e.right=h.right,b&&(e.left=e.right-k,0>e.left&&(e.left=0))));c&&(0>e.top?(e.top=0,g&&(e.bottom=
e.top+f)):e.top>=e.bottom&&(e.top=e.bottom-1));g&&(e.bottom<=e.top?e.bottom=e.top+1:e.bottom>h.bottom&&(e.bottom=h.bottom,c&&(e.top=e.bottom-f,0>e.top&&(e.top=0))));}else'cell'===e.type&&(h=p.pageRange(e.page,e.type),e.c1+=b,e.r1+=c,e.c2+=d,e.r2+=g,k=e.c2-e.c1,f=e.r2-e.r1,b&&(e.c1<h.c1?(e.c1=h.c1,d&&(e.c2=e.c1+k)):e.c1>e.c2&&(e.c1=e.c2)),d&&(e.c2<e.c1?e.c2=e.c1:e.c2>h.c2&&(e.c2=h.c2,b&&(e.c1=e.c2-k,e.c1<h.c1&&(e.c1=h.c1)))),c&&(e.r1<h.r1?(e.r1=h.r1,g&&(e.r2=e.r1+f)):e.r1>e.r2&&(e.r1=e.r2)),g&&(e.r2<
e.r1?e.r2=e.r1:e.r2>h.r2&&(e.r2=h.r2,c&&(e.r1=e.r2-f,e.r1<h.r1&&(e.r1=h.r1)))));a.setRange(e);}};var la=function(a,b){if(!K)return a;var c;if('string'==typeof a){c=[];var d=q.get(a,'color');d&&c.push('color:',d,';');(d=q.get(a,'background-color'))&&c.push('background-color:',d,';');if(b){if(b&&-1!=a.indexOf('border')){d=f.create('div');d.attr('style',a);d.css('display','none');f.body.append(d);var g=d.computedStyle(d),e=aa(g,'Top'),h=aa(g,'Left'),k=aa(g,'Bottom'),n=aa(g,'Right');e.w&&e.w==k.w&&e.w==
h.w&&e.w==n.w&&e.c==k.c&&e.c==h.c&&e.c==n.c?c.push('border:',e.w,' solid ',e.c,';'):(ha(g,e,c),ha(g,h,c),ha(g,k,c),ha(g,n,c));d.destroy();}}else(d=q.get(a,'text-decoration'))&&c.push('text-decoration:',d,';');c=0==c.length?void 0:c.join('');}return c;},aa=function(a,b){b=s[b];return{e:b,w:a[b.w],c:a[b.c]};},ha=function(a,b,c){b.w&&c.push(b.e.wp,',',b.w,';',b.e.sp,':solid;',b.e.cp,':',b.c,';');};b.map=function(a){if('text'===a.range.type){var b=O[a.range.acc];void 0!==b?b instanceof Array?b.push(a.id):
O[a.range.acc]=[b,a.id]:O[a.range.acc]=a.id;}};b.unmap=function(a){if('text'===a.range.type){var b=O[a.range.acc];void 0!==b&&(b instanceof Array?1==b.length&&b[0]==a.id?delete O[a.range.acc]:e.remove(b,a.id):b===a.id&&delete O[a.range.acc]);}};b.pageTryReset=function(){ca.length=0;Z.length=0;};var ca=[],Z=[],da=function(b,c){var d=b.range.page,g=a.pages.page(d);if(9999!=ca[d]&&!g&&void 0!=d)ca[d]?100<=(new Date).getTime()-Z[d]&&(ca[d]+=1,Z[d]=(new Date).getTime()):(ca[d]=1,Z[d]=(new Date).getTime()),
100<ca[d]&&(ca[d]=9999),setTimeout(function(){da(b,c);},100);else{ca[d]=9999;if(e.isDOMRange(b.range)||e.isDOMSelection(b.range)){d=l.fromDOM(b.range);if(!d)return;if(!Array.isArray(d))return b.range=d,da(b,c);b.compound=d;for(var h=d[0].acc,f=d[0].accend,g=1;g<d.length;g++){var n=d[g];n.acc<h&&(h=n.acc);n.accend>f&&(f=n.accend);}b.range=l.textRange(h,f);}if('text'===b.range.type){if(n=k.pagesForRange(b.range),2<=n.length&&n[0].isEmailHeader()&&(d=n[1],d.acc>=b.range.acc&&d.acc<=b.range.accend&&(b.range.acc=
d.acc,b.compound.length=0,b.compound.push(b.range))),n&&2<=n.length){for(var h=b.range,f=[],r,m,g=0;g<n.length;g++)d=n[g],d.overlay!=m?(r=l.textRange(d.acc,d.accend),f.push(r),m=d.overlay):(d.acc<r.acc&&(r.acc=d.acc),d.accend>r.accend&&(r.accend=d.accend));if(1<f.length){r=[];for(g=0;g<f.length;g++)b.range=f[g],b.range.acc<h.acc&&(b.range.acc=h.acc),b.range.accend>h.accend&&(b.range.accend=h.accend),r.push(ia(b,c));return r;}}}else if('rect'===b.range.type&&(d=k.page(b.range.page))&&d.isEmailHeader())return;
return ia(b,c);}},ia=function(c,d){var g;if('text'===c.range.type){var e=c.properties,h=c.comment,f=c.label;null===e&&(e=void 0);null===h&&(h=void 0);null===f&&(f=void 0);var n=O[c.range.acc];if(void 0!==n)if(n instanceof Array)for(var l=0;l<n.length;l++){var r=y[n[l]];if(r.matches(c.style,c.range,e,h,f)){g=r;break;}}else r=y[n],r.matches(c.style,c.range,e,h,f)&&(g=r);}else g=void 0;if(!g){'text'===m.selectionType()&&m.select(null);for(e='rect'===c.range.type||'cell'===c.range.type;w<y.length&&y[w];)w++;
w>=y.length&&(w=y.length,y.push(null));h=w;if(d&&(f=d.filterFn,n=d.highlightIndex,null!=f&&!f(h,c.properties))){b.invalidArg('apply','highlight['+n+']',c);return;}switch(c.type){case 'redaction':g=new a.Redaction(h,c);break;case 'note':e&&(g=new a.Note(h,c));break;case 'stamp':e&&(g=new a.Stamp(h,c));break;default:g=new a.Highlight(h,c);}if(!g)return;e=y[h]=g;v||e.addToDocument();if((h=z.info())&&1557===h.fi&&'text'==e.range.type){h=k.count();for(f=0;f<h;f++)(n=k.page(f))&&(!n.isLoaded()&&n.containsRange(e.range))&&
H.push({pageIndex:f,highlight:e,loadPage:!0});fa();}b.link(g);}b.on.add.dispatch(g);!0===c.activate?X(g.id):P&&(b.activateNearest(P.x,P.y,null,!1),P=null);return g.id;},fa=function(){!M&&0<H.length&&(M=e.setInterval(na,20));},ma=function(a,b){if(!(0==y.length||v)){for(var c=a;c<=b;c++){var d=k.page(c);d&&d.isLoaded()&&H.push({pageIndex:c});}fa();}},na=function(){p.suspendUpdate();for(var a=0;100>a&&0<H.length;a++){var b=H.shift(),c=k.page(b.pageIndex);if(c.isLoaded())if(void 0===b.highlight){if(c&&c.isLoaded())for(var d=
0;d<y.length;d++){var g=y[d];g&&c.containsRange(g.range)&&H.push({pageIndex:b.pageIndex,highlight:g});}}else b.highlight.addToPage(b.pageIndex);else if(!0===b.loadPage){var h=b;c.load(!0,!1,function(){H.unshift(h);fa();});}}0==H.length&&(e.clearInterval(M),M=void 0);p.resumeUpdate();};b.activateNearest=function(a,b,c,d){var g=r,e=J,h=I;!1!==d&&(d=!0);if(void 0===u)P&&(P.x=a,P.y=b);else{var f=k.mapToPage(a,b,null,!0);if(f){var n=f.page;a=f.x;b=f.y;for(var g=void 0,h=e=!1,l,m,A,f=0;f<y.length;f++){var q=
y[f];if(q&&!q.isHidden()&&q.isOnPage(n.index)){var t=q.distanceFromPoint(n.index,a,b);if(void 0!==t)if(0===t)l||(l=[]),l.push(q);else if(!l&&(void 0===m||Math.abs(t)<Math.abs(m)))m=t,A=q;}}if(l){n=void 0!==r?r:C;if(0<l.length&&void 0!==n)for(f=0;f<l.length;f++)if(l[f].id==n){++f>=l.length&&(f=0);g=l[f].id;break;}void 0===g&&(g=l[0].id);}else if(A)g=A.id,h=0>m,e=0<m;else{for(var v,g=u;void 0!==g;g=y[g].nextId)if((l=k.forRange(y[g].range))&&l.index>=n.index){v=l;break;}v||(g=B,v=k.forRange(y[g].range));
v.index<n.index?e=!0:h=!0;}}}if(g!=r||e!=J||h!=I)!1===d&&!h&&!e?h=!0:!c&&(!h&&!e)&&(h=!0),X(g,h,e);return r;};var X=function(a,d,g,e,h,f){var n=W(a);a=n?n.id:void 0;!0!==d&&(d=!1);!0!==g&&(g=!1);!1!==h&&(h=!0);(n=a!=r||d!=I||g!=J)&&(f=!1);if(n||f){if(!f){if(n=y[r])n.hideDialog(),n.deactivate();void 0!==r&&(C=r);r=a;void 0!==C&&(y[C]&&y[C].isEmptyRedaction())&&(b.remove(C,!0),C=void 0);I=d;J=g;}if(void 0!==r&&!d&&!g&&y[r]){n=y[r];if(h){k.moveto(n.range,function(){X(a,d,g,e,!1,!0);});return;}n.isNote()?
m.select(null):(m.select(n.range,n.id),m.hide());c.viewNode.focus();n.activate(f);n.comment()&&!n.isNote()&&b.showComment(n.id,{mode:'view'});}!1!==e&&(n=W(r),b.on.activate.dispatch(n,I,J));}},ea=function(a,b,c,d,g){d=d||c;if(a=W(a,b,c))return'string'==typeof d?a[d].apply(a,g):d.apply(null,g);},W=function(a,c,d){void 0===a&&(a=c);if('number'===typeof a&&y[a])return y[a];d&&b.invalidArg(d,'id',a);};b.link=function(a,c){var d=a.id;b.unlink(a);var g=a.generateKey(c);if(g)if(void 0===u)B=u=d;else for(var e=
u;;){var h=y[e],k=h.key,f=!1;g.page<k.page?f=!0:g.page==k.page&&(g.y<k.y?f=!0:g.y==k.y&&g.x<k.x&&(f=!0));if(f){e===u?u=d:(a.prevId=h.prevId,y[a.prevId].nextId=d);a.nextId=e;h.prevId=d;break;}if(e===B){a.prevId=e;B=h.nextId=d;break;}e=h.nextId;}};b.unlink=function(a){if(void 0!==a.prevId||void 0!==a.nextId||u==a.id){var b=void 0!==a.prevId?y[a.prevId]:null,c=void 0!==a.nextId?y[a.nextId]:null;b?b.nextId=a.nextId:u=a.nextId;a.nextId=void 0;c?c.prevId=a.prevId:B=a.prevId;a.prevId=void 0;}};b.positionAll=
function(a){b.each('positionAll',a);b.alignHighlight();};b.validateStyles=function(a){a!==unknown&&(K=!1!==a);return K;};b.each=function(a,b){e.eachArgs(y,arguments);};var ga=function(a,c,d,g){a<c.length&&(c=c[a],e.isDOMRange(c)||e.isDOMSelection(c)?d.range=c:d.range=l.validateRange(c),d.range&&a++);d.range||('text'===h.selectionType()&&(d.range=document.getSelection(),d.range&&d.range.isCollapsed&&(d.range=void 0)),d.range||(d.range=h.selection()),d.range?d.activate=!0:(b.invalidArg(g,'range',null,
'A range was not specified and nothing is currently selected'),d.invalid=!0));return a;},oa=function(a,c,d,g){if(1>c.length||'string'!==typeof c[0])b.invalidArg(g,'style',null,'A highlight style must be specified'),d.invalid=!0;},sa=function(a,c,d,g){var e;a<c.length&&'string'===typeof c[a]&&(e=c[a]);d.style=la(e,'hl-text'!=d.type);d.style?a++:(b.invalidArg(g,'style',e),d.invalid=!0);return a;},pa=function(a,b,c,d,g){a<b.length&&(b=b[a],b instanceof Object||'object'==typeof b?(c[d]=b,a++):(null===b||
void 0===b)&&a++);return a;},qa=function(a,b,c,d,g){a<b.length&&(b=b[a],b instanceof String||'string'==typeof b?(c[d]=b,a++):(null===b||void 0===b)&&a++);return a;},ra=function(a,c,d,g){for(;a<c.length&&void 0===c[a];)a++;a<c.length&&(b.invalidArg(g,null,null,'Unexpected argument(s)'),d.invalid=!0);return a;},ta=function(){b.each('updateStyle','isRedaction');ja();};d.onredactionColor(ta);d.onredactionFillColor(ta);d.onnochrome(function(){b.positionAll();});d.onshowHighlightLabels(function(a){b.each('showLabel',
null,a);});d.onhighlightLabelFontFamily(t);d.onhighlightLabelFontSize(t);d.onhighlightActivationBoxColor(function(a){if(null===a)h.screenCSS('.oit-highlight-active .oit-activation','display:none;'),h.screenCSS('.oit-highlight-embed','display:none;'),h.screenCSS('.oit-highlight-active .oit-resize div','display:none;'),h.screenCSS('.oit-text-handle div:nth-child(2)','display:none;'),h.screenCSS('.oit-text-handle div:first-child','display:none;'),h.screenCSS('.oit-text-handle',null);else if(a=q.stringToColor(a)){var b=
'rgb('+a.r+','+a.g+','+a.b+')',c='border:2px solid '+b+';opacity:'+a.a+';';h.screenCSS('.oit-highlight-active .oit-activation',c);c='border:1px solid '+b+';opacity:'+a.a+';';h.screenCSS('.oit-highlight-embed',c);c='background-color:'+b+';';h.screenCSS('.oit-highlight-active .oit-resize div',c);h.screenCSS('.oit-text-handle div:nth-child(2)',c);h.screenCSS('.oit-text-handle div:first-child','border-bottom: 7px solid '+b+';');c='opacity:'+a.a+';';h.screenCSS('.oit-text-handle',c);}});b.on.click.setDefaultListener(function(a,
b,c){X(c.id);});a.on('document','scroll',function(){b.alignComment();});a.on('document','reset',function(){b.clear();B=u=void 0;w=0;C=r=void 0;J=I=!1;});a.on('document','load',function(){if(x){var a=x;x=null;b.apply(a);}});a.on('document','zoom',function(a,c,d){b.positionAll();});a.on('content','data',function(a,c,d){a.highlights&&b.apply(a.highlights);if(a.stamps)for(var g in a.stamps)n[g]=a.stamps[g];});}});OIT.extend('mod','hyperlinks',{userEventDef:{pub:!0,detail:function(a,b,d){a={srcEvent:b,url:d.url};d.range&&(a.range=this.range.clone(d.range));d.alt&&(a.alt=d.alt);a.external=0!=a.url.indexOf('#');return a;}},install:function(a,b){var d=a.doc,c=a.pages,f=a.util,e=a.content,l=a.dialog,p=a.range,h,q,m={},k=0,z=!1,s=null,t=null,v,y=function(a,c,e){if(c){var h=e+10;h>c.length&&(h=c.length);for(;e<h;e++){var k=c[e],f=k.range;if(f)if('text'===f.type)n(a,k);else if('rect'==f.type&&f.page===a.index){if(!a.linkMap){var l=
a.childByClass('oit-svg'),m=l.byClass('oit-svg-text');if(m&&0<m.length){m=m[0];a.linkMap=d.create('div','oit-area-hyperlinks');a.linkMap.attr('style',m.attr('style'));if(m.classList)for(var u=0;u<m.classList.length;u++){var q=m.classList.item(u);'oit-svg-text'!==q&&a.linkMap.addClass(q);}l.append(a.linkMap);}}a.linkMap&&(f='left:'+f.left+'px;top:'+f.top+'px;width:'+(f.right-f.left)+'px;height:'+(f.bottom-f.top)+'px;',l=d.create('div'),l.attr('style',f),a.linkMap.append(l),b.on.addElement(l,k),f={anchorNode:l,
page:a},k.anchors||(k.anchors=[]),k.anchors.push(f));}}}return e;},w=function(a,b,c){if(b){var d=c+10;d>b.length&&(d=b.length);for(;c<d;c++){var e=b[c],h=e.range;if(h&&'text'===h.type){var k=a.findRange(h.acc,h.accend);k&&f.each(k,'addDataToRange',null,h,e,a);}}}return c;},x=function(a,b,h){a=0;b&&(a=b.button||0);if(0!=a||!h.targetId)return!0;s=null;(b=m[h.targetId])?(h=d.byId(h.targetId)||b.range||b.page,void 0!==h&&c.movetoEx(h,{force:!0,moveToTop:!0}),z&&(l.hideMessage(),z=!1)):e.isPending()?(z||(l.showMessage(OIT.local.PLEASE_WAIT_INITIALIZING),
z=!0),s=h,e.on.add.listenOnce(function(){s&&x(null,null,s);})):z&&(l.hideMessage(),z=!1);return!1;};b.on.click.setDefaultListener(x);a.on('content','data',function(a,b,e){if(a.hyperlinks){h=h?h.concat(a.hyperlinks):a.hyperlinks;for(b=0;b<a.hyperlinks.length;b++){e=a.hyperlinks[b];e.type='hyperlink';e.id='oit-hl-'+ ++k;var f=e.url;if(0==f.indexOf('#')){var n=e,f=f.substring(1);n.targetId=f+'.'+d.expando;e.url='#'+e.targetId;}}b=c.count();for(e=0;e<b;e++)(n=c.page(e))&&(n.isLoaded()&&!n.isHidden())&&y(n,
a.hyperlinks,0);}if(a.bookmarks){q=q?q.concat(a.bookmarks):a.bookmarks;for(b=0;b<a.bookmarks.length;b++)e=a.bookmarks[b],n=e.name,e.type='bookmark',e.id=n+'.'+d.expando,m[e.id]||(m[e.id]=e);b=c.count();for(e=0;e<b;e++)(n=c.page(e))&&n.isLoaded()&&w(n,a.bookmarks,0);}});var u=function(){if(t){for(var b,c=0;c<t.length;c++){var d=t[c];if(d.page.isLoaded()){var e=!0;d.page.isHidden()?e=!1:(h&&(d.hindex=y(d.page,h,d.hindex),d.hindex<h.length&&(e=!1)),q&&(d.bindex=w(d.page,q,d.bindex),d.bindex<q.length&&
(e=!1)));e||(b||(b=[]),b.push(d));}}t=b;}t||(v&&(f.clearInterval(v),v=void 0),a.off('document','idle',u));},B=function(a,b,c,d){a.addDataToRange(b,c,d);'OIT.ihs(event)'==a.attr('onmouseover')&&a.attr('onmouseover',null);'OIT.ihs(event)'==a.attr('ontouchstart')&&a.attr('ontouchstart',null);},n=function(a,b){var c=b.range,d=a.findRange(c.acc,c.accend);d&&f.each(d,B,null,c,b,a);};a.on('pages','pageload',function(b,c){t||(t=[]);if(-1==t.indexOf(b)&&(t.push({page:b,hindex:0,bindex:0}),1==t.length))if('rt'==
b.type&&!v)a.on('document','idle',u);else v=f.setInterval(u,75);});a.on('pages','pageunload',function(a){if(h)for(var c=0;c<h.length;c++){var d=h[c];if(d.anchors)for(var e=d.anchors.length-1;0<=e;e--){var k=d.anchors[e];if(k.page===a){b.on.removeElement(k.anchorNode);1==d.anchors.length?d.anchors=void 0:d.anchors.splice(e,1);break;}}}delete a.linkMap;});a.on('document','reset',function(){q=h=void 0;m={};k=0;});a.export('ihs',function(a){if(h)for(var b=p.fromDOM(a.currentTarget),d,e=0;e<h.length;e++){var k=
h[e];p.overlap(b,k.range)&&(d||(d=c.forNode(a.currentTarget)),d&&n(d,k));}});}});OIT.extend('mod','attachments',{exports:['describe','setOptions'],userEventDef:{pub:!0,detail:function(a,b,d){(a=this.attachments.describe(d))?a.attachment=d:a={};a.srcEvent=b;return a;}},install:function(a,b){var d=[],c;b.item=function(a){return d[a];};b.describe=function(b){var c;0==arguments.length?c=a.util.clone(d):isNaN(b)||0<=b&&b<d.length&&(c=a.util.clone(d[b]));return c;};b.setOptions=function(b){b&&(c||(c=new a.DynamicStyleSheet),b.hasOwnProperty('cursor')&&c.setRule('.oit-attachedFile {cursor:'+
b.cursor+'}','cursor'),b.hasOwnProperty('color')&&c.setRule('.oit-attachedFile {color:'+b.color+'}','color'));};a.on('document','reset',function(){d=[];c&&(c.destroy(),c=void 0);});a.on('content','data',function(a,b,c){if(a.attachments)for(b=0;b<a.attachments.length;b++)d.push(a.attachments[b]);});}});OIT.extend('mod','archive',{userEventDef:{pub:!0,detail:function(a,b,d){return{nodeid:d,name:a.text(),srcEvent:b};}}});OIT.extend('mod','toolbars',{exports:['add','hide','remove','setSize','show'],events:{add:{pub:!0,detail:function(a,b){return{id:a,edge:b};}},remove:{pub:!0,detail:function(a,b){return{id:a,edge:b};}},show:{pub:!0,detail:function(a,b,d,c){return{id:a,edge:b,width:d,height:c};}},hide:{pub:!0,detail:function(a,b){return{id:a,edge:b};}},resize:{pub:!0,detail:function(a,b,d,c){return{id:a,edge:b,width:d,height:c};}}},install:function(a,b){var d=a.doc,c=a.glob,f=a.util,e=a.view,l=a.css,p=['left','top','right',
'bottom'],h=[],q,m=function(){f.eachSparse(h,'refresh');e.dispatchResize();};a.on('view','resize',m);b.add=function(e,k,f){var m;if(-1===p.indexOf(e))b.invalidArg('add','edge',e,'Must be one of '+JSON.stringify(MEMORY_MODELS));else if(d.isElement(k)){var y,w=!1,x=!1,u;f&&(f.size&&((y='auto'===f.size?f.size:l.validateLength(f.size))||b.invalidArg('add','options.size',f.size,'Must be a valid CSS length or \'auto\'')),!0===f.visible&&(w=!0),!0===f.overlay&&(x=!0),f.border&&(u=f.border));var B;q?(B=h[q],
m=++q):m=q=1;f=c.viewNode;var n=f.scroll();k=new a.ToolBar(m,e,d.wrap(k),u,x,B);h[m]=k;y&&k.setSize(y);f.scroll(n);b.on.add.dispatch(m,e);w&&b.show(m);}else b.invalidArg('add','elem',k,'Must be a valid DOM Element');return m;};b.addInternal=function(a,b){h[a]=b;};b.removeInternal=function(a){var b=h[a];b&&(b.remove(),delete h[a]);};b.remove=function(a){f.eachSparse(h,k,a);m();};var k=function(a){var b=a.id;a.remove();for(h[b]=void 0;!h[q];)if(0>=--q){q=void 0;break;}return!0;};b.setSize=function(a,c){a=
Number(a);var d=h[a];(!d||d.isInternal())&&b.invalidArg('setSize','id',a,'Must be a valid toolbar id returned by OIT.toolbars.add');var e='auto'===c?c:l.validateLength(c);e?d&&(d.setSize(e),m()):b.invalidArg('setSize','size',c,'Must be a valid CSS length or \'auto\'');};b.show=function(a,b){f.eachSparse(h,'show',a,b||{});m();};b.hide=function(a){f.eachSparse(h,'hide',a);m();};}});OIT.extend('mod','stylemap',{install:function(a,b){var d=a.css,c=a.util,f=null,e={},l=0;b.applyStyle=function(b,e,f,l){if(f&&'text'===e.type&&e.accend>e.acc){!0==e.bSlideNote&&(b=a.pages.notesBar());var k=b.findRange(e.acc,e.accend);if(k&&0<k.length){l={type:'style',id:l,props:f};if(!f.color&&k[0].hasClass('oit-tt')){var z=k[0].computedStyle().color,z=d.stringToColor(z);z.a=1;f.color=d.colorToString(z);}c.each(k,'addDataToRange',null,e,l,b);return k;}}};b.removeStyle=function(a,b){c.each(a,'removeData',
null,'style',b);};b.styleName=function(b){b=d.compose(b);var c=e[b];c||(c='oit-ss'+ ++l,e[b]=c,f||(f=new a.DynamicStyleSheet),f.addCSSText('.'+c+', .'+c+' a {'+b+'}'));return c;};a.on('document','reset',function(){f&&(f.destroy(),f=null);e={};l=0;});}});OIT.extend('fmt',['page','drawing','slide','chart'],{de:'page',showhidden:!1,cellselection:!1});OIT.extend('fmt','bitmap',{de:'page',showhidden:!1,textselection:!1,cellselection:!1,customtextselection:!1});OIT.extend('fmt',['html'],{de:'page',rotate:!1,showhidden:!1,pages:!1,fitpage:!1,cellselection:!1});OIT.extend('fmt',['email'],{de:'page',rotate:!1,showhidden:!1,pages:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,anchorednotes:!1});
OIT.extend('fmt',['rt'],{de:'page',rotate:!1,showhidden:!1,pages:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,anchorednotes:!1});
OIT.extend('de','page',{install:function(a,b){var d=a.opt,c=a.glob,f=a.doc,e=a.document,l=a.pages,p=a.css,h=a.highlights,q=a.range,m,k=1,z=null,s,t,v,y,w,x=20;b.load=function(d){m=d.overlay;k=1;z=null;s=d.type;t=void 0;if(!c.isMobile&&void 0===c.singlePageIndex)a.on('document','idle',F);u(d);a.on('pages','add',b,B);a.on('pages','change',b,I);a.on('document','scrollupdate',b,I);if('email'===s||'html'===s||'rt'===s)a.on('view','resize',b,J),J();C(d.index);I();};b.unload=function(){a.off('pages','add',
B);a.off('pages','change',I);a.off('document','scrollupdate',I);a.off('view','resize',J);c.isMobile||a.off('document','idle',F);t&&(t.destroy(),t=void 0);null!=z&&(z.unload(),z=null);m=null;k=1;z=null;v=t=w=y=s=void 0;};b.topPageIndex=function(){var a=l.current();if('email'===s)a=l.page(a).overlay.firstPage.index;else if('vertical'==d.scrollMode&&void 0===c.singlePageIndex)for(var b=a-1;0<b;b--){var g=l.page(b);if(g&&g.isEnabled()){if(g.overlay!=m)break;if(10>g.pageRect('view').bottom)break;a=b;}}return a;};
b.bottomPageIndex=function(){var a=l.current();if('email'===s)a=1;else if('vertical'==d.scrollMode&&void 0===c.singlePageIndex)for(var b=l.count(),g=a+1;g<b;g++){var e=l.page(g);if(e&&e.isEnabled()){if(e.overlay!=m)break;if(e.pageRect('view').top>c.viewNode.clientHeight-10)break;a=g;}}return a;};b.margin=function(){return{left:x,top:x,right:x,bottom:x};};var u=function(b){if('email'===s&&!z){var c=b.overlay.firstPage,d=l.page(c.index+1);c.load(!0,!0,function(){d.load(!0,!0,function(){var b=c.childByClass('oit-emailheader');
b||(b=f.byId('oit-emailheader'));b&&(c.addClass('oit-emailheaderpage'),z=new a.EmailHeader(b));});});}};b.layoutChanged=function(a){if(m){var b=c.viewNode,g=d.zoom;a||(a={x:0,y:0});var e=b.scroll(),h=null,f=null,l=null;1!=g&&(h=['scale(',g,',',g,')'].join(''),f='left top',l=[100/g,'%'].join(''));m.css({transform:h,'transform-origin':f,'min-width':l});n();h=g/k;b.scroll((a.x+e.left)*h-a.x,(a.y+e.top)*h-a.y);k=g;I();}};var B=function(){n(!0);},n=function(b){if(m){var g=d.rotation,e={yOffset:0,maxWidth:0,
height:0},k=l.top(),f=[],n=d.centerPages,r=x/d.zoom;if('email'===s||'html'===s||'rt'===s)n=!1;if(n){f.push('.oit-page,.oit-bitmap,.oit-drawing,.oit-slide,.oit-chart{');f.push('margin: ',r,'px 0;');if(!d.nochrome)switch(g){case 90:f.push('box-shadow:-2px 2px 20px 1px #111 !important;');break;case 180:f.push('box-shadow:-2px -2px 20px 1px #111 !important;');break;case 270:f.push('box-shadow:2px -2px 20px 1px #111 !important;');}f.push('}');}m.each(A,null,f,g,n,r,e);0==e.maxWidth?m.css('width',null):(e.maxWidth+=
x+x,m.css('width',e.maxWidth+'px'));0==e.height?m.css('height',null):(e.height+=x,m.css('height',e.height+'px'));f=f.join('');t||(t=new a.DynamicStyleSheet);t.setCSSText(f);!v&&(!b&&'vertical'==d.scrollMode&&void 0===c.singlePageIndex)&&(b=d.disableAnimation,d.disableAnimation=!0,l.moveto(k),d.disableAnimation=b);h.positionAll();}},A=function(a,b,g,e,h,k){var f=0,n=0,l,m=c.viewNode.clientWidth;a.resetCache();switch(g){case 0:e&&(f=(m/d.zoom-a.offsetWidth)/2,f<h&&(f=h));break;case 90:e&&(n=(m/d.zoom-
a.offsetHeight)/2,n<h&&(n=h));f=-k.yOffset-a.offsetWidth;k.yOffset=k.yOffset-a.offsetHeight+a.offsetWidth;a.offsetHeight>k.maxWidth&&(k.maxWidth=a.offsetHeight);k.height+=a.offsetWidth+x;l='rotate(270deg) ';break;case 180:e&&(f=-((m/d.zoom-a.offsetWidth)/2),f>-h&&(f=-h));f-=a.offsetWidth;n=-a.offsetHeight;l='rotate(180deg) ';break;case 270:e&&(n=-((m/d.zoom-a.offsetHeight)/2),n>-h&&(n=-h)),n-=a.offsetHeight,f=k.yOffset,k.yOffset=k.yOffset-a.offsetHeight+a.offsetWidth,a.offsetHeight>k.maxWidth&&(k.maxWidth=
a.offsetHeight),k.height+=a.offsetWidth+x,l='rotate(90deg) ';}if(0!=f||0!=n||l){a=a.id.replace(/\./g,'\\.');b.push('#');b.push(a);b.push(' {');if(0!=f||0!=n||l){b.push(p.nameMap.transform);b.push(':');l&&b.push(l);if(0!=f||0!=n)b.push('translate('),b.push(f),b.push('px,'),b.push(n),b.push('px)');b.push(';');}b.push('}');}};b.moveto=function(b,d,e){var h=!1;e=e||{};if(q.isRangeObject(b))z&&(h=z.moveto(b,d,e));else if('number'===typeof b){h=c.viewNode;b=l.page(b);C(b.index);var k;(k=e.gotoNode)&&k!==b?
k=l.elementRect(k,'overlay'):(k=b.pageRect('overlay'),k.top-=x);b=h.scroll().top;k=b+(k.top-b);0>k&&(k=0);k!=b?(a.disableEvent('document','scrollupdate'),h.abortAnimation(),b=!1!==e.animate?150:0,v=!0,h.animate({scrollTop:k,time:b,endFn:g,args:[d,e]})):d&&d(e);h=!0;}return h;};var g=function(b,c,d){v=!1;a.enableEvent('document','scrollupdate');a.dispatch('document','scrollupdate');c&&c(d);},r=function(a){w&&a.hiddenFromSlideshow?a.hide():a.show();},C=function(a){var b=!1;'vertical'===d.scrollMode&&void 0===
c.singlePageIndex?c.viewNode.removeClass('oit-single'):c.viewNode.addClass('oit-single');if('vertical'==d.scrollMode&&void 0===c.singlePageIndex||'email'===s||'html'===s||'rt'===s)void 0!==y&&(m.showPages(),y=void 0,b=!0,w=!1),a='slideshow'==d.presentationMode,a!=w&&(w=a,b=!0,m.each(r));else if(a=a||l.current(),a!=y){var g=l.page(a);if(g){var k;void 0===y?m.hidePages(g.index):(k=l.page(y),g.addClass('oit-noshadow'));g.show({insertLast:!0,animate:!0,endFn:function(){g.removeClass('oit-noshadow');k&&
k.hide();}});y=a;b=!0;}}b&&(e.dispatchPageEvents(!0),h.positionAll());};b.pageRange=function(a,b){if('rect'===b){var c=l.page(a);if(c)return c=c.pageRect(),q.rectRange(a,0,0,c.width,c.height);}};b.rangeRect=function(b,c,d){var g;if('text'===b.type){var e=l.forRange(b);e&&(g=e.textBoundingRect(b));}else'rect'===b.type&&(g=new a.Rectangle(b),void 0!==b.embedId&&((d=l.page(b.page))&&(e=d.embeddingRect(b.embedId)),e?g.offset(e.left,e.top):g=void 0));g&&(g.origin=c);return g;};b.rangeFromRect=function(b,c,d,
g,e,h,k,f){if(b=l.page(b))return c=new a.Rectangle(c,d,g,e,h),c.origin=b,d=void 0!==f?b.embeddingRect(f):b.pageRect(),'html'!==b.type&&'rt'!==b.type&&('move'===k?c.constrain(d):'select'!==k&&c.intersect(d)),void 0!==f?(c.offset(-d.left,-d.top),k=c.toRange(b),k.embedId=f,q.convert(k,'pct')):k=c.toRange(b),k;};b.extendRange=function(a,c,d,g){var e=b.rangeRect(a,g);return b.rangeFromRect(a.page,e.left,e.top,c,d,g,'extend');};var F=function(){void 0===l.loadNextPageFromServer()&&a.off('document','idle',
F);return!1;},I=function(){if(!c.isMobile&&void 0===c.singlePageIndex)a.on('document','idle',F);c.viewNode.scroll();for(var b=l.top(),d=l.bottom();b<=d;b++){var g=l.page(b);g&&g.isPending()&&g.load(!0,!1);}},J=function(){m.each(L);z&&z.applyViewSize();},L=function(a){if(a.hasClass('oit-html')||a.hasClass('oit-email')){a.css('width',c.viewNode.clientWidth+'px');var b=a.byTag('svg');if(b)for(var d=0;d<b.length;d++){var g=b[d];g.attr('width',c.viewNode.clientWidth);g=f.unwrap(g).firstElementChild;if(null!=
g&&'rect'==g.nodeName){var e=getComputedStyle(g,null);null!=e&&null!=e.fill&&parseInt(g.attributes.getNamedItem('height').value)==a.height&&g.setAttribute('width',c.viewNode.clientWidth);}}}};d.onemailHeaderStyle(function(){if(z)z.onStyleChanged();});d.onremoveExtraEmailHeaders(function(){z&&z.removeExtraEmailHeaders();});d.onscrollMode(function(){m&&(C(),c.viewNode.scroll(0,0),l.updateActivePage());});d.onpresentationMode(function(){m&&C();});d.onnochrome(function(a){m&&(x=a?0:20,C());});}});OIT.extend('fmt',['worksheet','database'],{de:'ss',rotate:!1,textselection:!1,rectselection:!1,rectredaction:!1,customtextselection:!1});
OIT.extend('de','ss',{install:function(a,b){var d=a.glob,c=a.util,f=a.range,e=a.selection,l=a.math,p,h,q,m,k=!1;b.load=function(c){p=c;m=q=h=null;if(h=c.spreadsheetModel())q=new a.SpreadsheetView(h,p),(c=h.showHidden())&&b.showHidden(c);};b.unload=function(){m&&c.clearTimeout(m);q&&q.unload();m=q=h=null;};b.maxPageWidth=function(){if(q)return q.maxPageWidth();};b.maxPageHeight=function(){if(q)return q.maxPageHeight();};b.padding=function(){if(q)return q.padding();};b.scrollOffset=function(){if(q)return q.scrollOffset();};
b.getSelectedText=function(){return!h?'':h.getSelectedText();};b.select=function(a){return h?h.select(a):!1;};b.keydown=function(a){var b=!0;if(q)switch(a.keyCode){case 33:d.viewNode.dscroll(0,-(q.visibleHeight()+1));if(a=e.cellSelection())b=q.visibleRange(),b=b.r2-b.r1+1,a.c2=a.c1,a.r1-=b,0>a.r1&&(a.r1=0),a.r2=a.r1,e.select(a);b=!1;break;case 34:d.viewNode.dscroll(0,q.visibleHeight()+1);if(a=e.cellSelection())b=q.visibleRange(),b=b.r2-b.r1+1,a.c2=a.c1,a.r1+=b,b=h.rowCount()-1,a.r1>b&&(a.r1=b),a.r2=
a.r1,e.select(a);b=!1;break;case 35:k=!k;b=!1;break;case 36:q.scrollToRange(0,0,0,0);a=f.cellRange(p.index,0,0);e.select(a);b=k=!1;break;case 27:q.hidePopup(!0);b=k=!1;break;case 37:case 38:case 39:case 40:break;default:k=!1;}return b;};b.loadRange=function(a,b){h&&h.loadRange(a,b);};b.moveto=function(a,b,c){return q?q.moveto(a,b,c):!1;};b.showHidden=function(a){void 0===a&&(a='all');a=h.showHidden(a);var b,c;'columns'===a?b=!0:'rows'===a?c=!0:'all'===a?c=b=!0:'none'===a&&(c=b=!1);q&&q.showHidden(b,c);};
b.pageRange=function(a,b){if('cell'===b&&a==p.index)return f.cellRange(a,0,0,h.colCount()-1,h.rowCount()-1);};b.pageRect=function(a,b){if(q)return q.pageRect(a,b);};b.rangeRect=function(a,b,c){if(q)return q.rangeRect(a,b,c);};b.rangeFromRect=function(a,b,c,d,e,h,k,f){if(q)return q.rangeFromRect(a,b,c,d,e,h,k,f);};b.extendRange=function(a,b,c,d){if(q)return q.extendRange(a,b,c,d);};var z=function(a,b){var c=l.clamp(a+b,0,h.colCount()-1);if(0!=b&&h.colHidden(c)){var d=h.colCount()-1;do if(c+=b,0>c){for(c=
0;c<=d&&h.colHidden(c);c++);break;}else if(c>d){for(c=d;0<=c&&h.colHidden(c);c--);break;}while(h.colHidden(c));}return c;},s=function(a,b){var c=l.clamp(a+b,0,h.rowCount()-1);if(0!=b&&h.rowHidden(c)){var d=h.rowCount()-1;do if(c+=b,0>c){for(c=0;c<=d&&h.rowHidden(c);c++);break;}else if(c>d){for(c=d;0<=c&&h.rowHidden(c);c--);break;}while(h.rowHidden(c));}return c;};b.moveAnchor=function(a,b,c,d){d=!1;k&&(0>b?b=-h.colCount():0<b&&(b=h.colCount()),0>c?c=-h.rowCount():0<c&&(c=h.rowCount()),k=!1);b=z(a.c1,b);c=
s(a.r1,c);a.c1!=b&&(a.c1=b,d=!0);a.c2!=b&&(a.c2=b,d=!0);a.r1!=c&&(a.r1=c,d=!0);a.r2!=c&&(a.r2=c,d=!0);d&&q.scrollToRange(a.c1,a.r1,a.c1,a.r1);return d;};b.incrementSelection=function(a,b,c,d,e){e=!1;k&&(0>c?c=-h.colCount():0<c&&(c=h.colCount()),0>d?d=-h.rowCount():0<d&&(d=h.rowCount()),k=!1);b.c2==a.c1?(c=z(b.c1,c),c!=b.c1&&(c<=b.c2?b.c1=c:(b.c1=b.c2,b.c2=c),e=!0)):(c=z(b.c2,c),c!=b.c2&&(c>=b.c1?b.c2=c:(b.c2=b.c1,b.c1=c),e=!0));b.r2==a.r1?(d=s(b.r1,d),d!=b.r1&&(d<=b.r2?b.r1=d:(b.r1=b.r2,b.r2=d),e=
!0)):(d=s(b.r2,d),d!=b.r2&&(d>=b.r1?b.r2=d:(b.r2=b.r1,b.r1=d),e=!0));e&&(d=b.c2==a.c1?b.c1:b.c2,a=b.r2==a.r1?b.r1:b.r2,q.scrollToRange(d,a,d,a));return e;};b.layoutChanged=function(a){q&&q.layoutChanged(a);};b.update=function(a){q&&q.update(a);};}});OIT.extend('fmt',['archive','emailarchive'],{de:'arc',zoom:!1,rotate:!1,showhidden:!1,fitpage:!1,highlights:!1,rectselection:!1,cellselection:!1,anchorednotes:!1});
OIT.extend('de','arc',{install:function(a,b){var d=a.glob,c=a.doc,f=a.archive,e=a.util,l,p,h,q=function(a){a.preventDefault();z(this.parentNode.parentNode.parentNode,this);},m=function(a){z(this.parentNode.parentNode.parentNode,this);},k=function(){var a=p.scroll().left;a!=h&&(h=a,0==h?l.removeStyle('margin-left'):l.css('margin-left',-h+'px'));};b.load=function(a){l=a.childByClass('oit-tree-head');p=a.childByClass('oit-tree-nodes');h=0;var b=c.byClass('oit-open-close');b&&(e.each(b,'onclick',null,q),
e.each(b,'ontap',null,m));if(b=c.byClass('oit-tree-nname'))for(a=0;a<b.length;a++){var d=b[a],B=d.attr('data-nodeid');null!=B&&''!==B&&(B=Number(B),isNaN(B)||f.on.addElement(d,B));}if(b=l.byClass('oit-col-header'))for(a=0;a<b.length;a++)b[a].ctrl=new s(b[a],l),b[a].ctrl.colClass='f'+a;a=l;var n;a:{try{for(var A=document.styleSheets,b=0;b<A.length;b++){var g=A[b].cssRules||A[b].rules;if(0<g.length&&'div.f0'==g[0].selectorText){n=b;break a;}}}catch(r){}n=null;}a.ssIndex=n;p.onscroll(k);};var z=function(a,
b){var c=a.nextElementSibling;'none'!=c.style.display?(c.style.display='none',b&&b.addClass('closed')):(c.style.display='block',b&&b.removeClass('closed'));},s=function(b,d){a.Element.call(this,'div','oit-col-dragger');this.append(c.create('div'));this.headerbar=d;var e=b.nextSiblingElem();e?l.insert(this,e):l.append(this);this.header=b;this.ondragstart(t);this.ondragmove(v);this.ondragend(y);this.ondragcancel(y);};a.subclass(s,a.Element);var t=function(a){this.orgwidth=this.header.clientWidth;this.overlay||
(a=d.viewNode,this.overlay=c.create('div','oit-tree-overlay'),this.overlay.css({height:a.clientHeight-this.headerbar.clientHeight+'px',top:this.headerbar.clientHeight+2+'px',left:this.header.offsetLeft-3+'px'}),this.overlay.innerWidth=this.orgwidth+6,this.header.parent().append(this.overlay));},v=function(a){a=this.orgwidth+a.delta.x-3;1>a&&(a=1);this.header.innerWidth=a;this.overlay.innerWidth=a+9;},y=function(a){this.overlay.destroy();delete this.overlay;this.header.css('width',null);a=this.orgwidth+
a.delta.x-3;1>a&&(a=1);a+='px';if(null!=this.headerbar.ssIndex)for(var b=document.styleSheets[this.headerbar.ssIndex].cssRules,c='div.'+this.colClass,d=0;d<b.length;d++){if(b[d].selectorText==c){b[d].style.width=a;break;}}else{b=this.headerbar.parent().byClass(this.colClass);for(d=0;d<b.length;d++)b[d].css('width',a);}};}});OIT.extend(function(a){var b=a.opt,d=a.pages,c=a.math,f=a.range,e=a.display,l=function(a){return'number'===typeof a;};a.Rectangle=function(){var a=arguments;if(1===a.length)a=a[0],void 0!==a.units?('px'!==a.units&&(a=f.clone(a),f.convert(a,'px')),this.l=a.left,this.t=a.top,this.r=a.right,this.b=a.bottom,this.o=d.page(a.page)):a.o&&(this.l=a.l,this.t=a.t,this.r=a.r,this.b=a.b,this.o=a.o);else if(2===a.length){var b=a[0];this.l=b.left;this.t=b.top;this.r=b.right;this.b=b.bottom;this.o=a[1];}else this.l=
a[0],this.t=a[1],this.r=a[2],this.b=a[3],this.o=a[4];a=this.o&&('view'===this.o||'overlay'===this.o||'string'===typeof this.o.type);if(!l(this.l)||!l(this.t)||!l(this.r)||!l(this.b)||!a)throw'Invalid Rectangle';this.l=c.round(this.l,1E4);this.t=c.round(this.t,1E4);this.r=c.round(this.r,1E4);this.b=c.round(this.b,1E4);this.l>this.r&&(a=this.l,this.l=this.r,this.r=a);this.t>this.b&&(a=this.t,this.t=this.b,this.b=a);this.w=this.r-this.l;this.h=this.b-this.t;};var p=a.subclass(a.Rectangle);Object.defineProperties(p,
{left:{enumerable:!0,get:function(){return this.l;},set:function(a){this.l=c.round(a,1E4);this.r=this.l+this.w;}},top:{enumerable:!0,get:function(){return this.t;},set:function(a){this.t=c.round(a,1E4);this.b=this.t+this.h;}},right:{enumerable:!0,get:function(){return this.r;},set:function(a){this.r=c.round(a,1E4);this.l=this.r-this.w;}},bottom:{enumerable:!0,get:function(){return this.b;},set:function(a){this.b=c.round(a,1E4);this.t=this.b-this.h;}},width:{enumerable:!0,get:function(){return this.w;},set:function(a){0>
a&&(a=0);this.w=c.round(a,1E4);this.r=this.l+this.w;}},height:{enumerable:!0,get:function(){return this.h;},set:function(a){0>a&&(a=0);this.h=c.round(a,1E4);this.b=this.t+this.h;}},origin:{enumerable:!0,get:function(){return this.o;},set:function(a){this.convert(a);}}});var h=function(a,b,d){return'number'===typeof d&&(d=c.round(d,1E4),d!==a[b])?(a[b]=d,!0):!1;};p.move=function(a,b,c,d){var e=!1,e=h(this,'l',a),e=e|h(this,'t',b),e=e|h(this,'r',c);if(e|=h(this,'b',d))this.w=this.r-this.l,this.h=this.b-this.t;
return e;};p.movesize=function(a,b,c,d){var e=!1,e=h(this,'l',a),e=e|h(this,'t',b),e=e|h(this,'w',c);if(e|=h(this,'h',d))this.r=this.l+this.w,this.b=this.t+this.h;return e;};p.offset=function(a,b){void 0!==a&&(this.left+=a);void 0!==b&&(this.top+=b);};p.size=function(a,b){void 0!==a&&(this.width=a);void 0!==b&&(this.height=b);};var q=function(a,b){return a===b?!0:0.999<(a>b?b/a:a/b);};p.equals=function(a){return q(this.l,a.left)&&q(this.t,a.top)&&q(this.r,a.right)&&q(this.b,a.bottom);};p.overlaps=function(a){return this.l<
a.right&&this.r>a.left&&this.t<a.bottom&&this.b>a.top;};p.contains=function(a){return a.left>=this.l&&a.right<=this.r&&a.top>=this.t&&a.bottom<=this.b;};p.union=function(a,b,d,e){if(1==arguments.length){var h=arguments[0];this.union(h.left,h.top,h.right,h.bottom);}else a=c.round(a,1E4),b=c.round(b,1E4),d=c.round(d,1E4),e=c.round(e,1E4),a<this.l&&(this.l=a),b<this.t&&(this.t=b),d>this.r&&(this.r=d),e>this.b&&(this.b=e),this.w=this.r-this.l,this.h=this.b-this.t;};p.intersect=function(a,b,d,e){if(1==arguments.length){var h=
arguments[0];this.intersect(h.left,h.top,h.right,h.bottom);}else a=c.round(a,1E4),b=c.round(b,1E4),d=c.round(d,1E4),e=c.round(e,1E4),a>this.l&&(this.l=a),b>this.t&&(this.t=b),d<this.r&&(this.r=d),e<this.b&&(this.b=e),this.w=this.r-this.l,this.h=this.b-this.t;};p.constrain=function(a,b,d,e){if(1==arguments.length){var h=arguments[0];this.constrain(h.left,h.top,h.right,h.bottom);}else{a=c.round(a,1E4);b=c.round(b,1E4);d=c.round(d,1E4);e=c.round(e,1E4);var h=d-a,f=e-b;this.width>=h?(this.l=a,this.r=d,this.w=
h):this.left<a?this.left=a:this.right>d&&(this.right=d);this.height>=f?(this.t=b,this.b=e,this.h=f):this.t<b?this.top=b:this.b>e&&(this.bottom=e);}};p.clone=function(){return new a.Rectangle(this.left,this.top,this.right,this.bottom,this.origin);};p.toRange=function(a){var b=this;this.o!==a&&(b=this.clone(),b.origin=a);return f.rectRange(a.index,b.left,b.top,b.right,b.bottom);};p.distanceFrom=function(a,b,d,e){a=c.round(a,1E4);b=c.round(b,1E4);switch(d){case 'left':a-=this.l;break;case 'center':a-=(this.l+
this.r)/2;break;case 'right':a-=this.r;break;case 'none':a=0;break;default:a=a<this.l?a-this.l:a>this.r?a-this.r:0;}switch(e){case 'top':b-=this.t;break;case 'middle':b-=(this.t+this.b)/2;break;case 'bottom':b-=this.b;break;case 'none':b=0;break;default:b=b<this.t?b-this.t:b>this.b?b-this.b:0;}if(0===a&&0===b)return 0;e=c.round(Math.sqrt(a*a+b*b),10);if(0>b||0==b&&0>a)e=-e;return e;};p.convert=function(a){var c=this.o;if(a!==c){if('view'===a||'overlay'===a)if('view'===c){var d=e.padding(),c=e.scrollOffset();
this.left=this.left-d.left+c.left;this.top=this.top-d.top+c.top;}else if('overlay'===c)d=e.padding(),c=e.scrollOffset(),this.left=this.left+d.left-c.left,this.top=this.top+d.top-c.top;else{d=c;if(d.features().rotate&&(c=b.rotation,0!=c))switch(c){case 90:this.move(this.t,d.width-this.r,this.b,d.width-this.l);break;case 180:this.move(d.width-this.r,d.height-this.b,d.width-this.l,d.height-this.t);break;case 270:this.move(d.height-this.b,this.l,d.height-this.t,this.r);}d.features().zoom&&(c=b.zoom,1!=
c&&this.move(this.l*c,this.t*c,this.r*c,this.b*c));(c=d.pagePos(a))&&this.offset(c.left,c.top);}else if('view'===c||'overlay'===c){if(d=a,(c=d.pagePos(c))&&this.offset(-c.left,-c.top),d.features().zoom&&(c=b.zoom,1!=c&&this.move(this.l/c,this.t/c,this.r/c,this.b/c)),d.features().rotate&&(c=b.rotation,0!=c))switch(c){case 90:this.move(d.width-this.b,this.l,d.width-this.t,this.r);break;case 180:this.move(d.width-this.r,d.height-this.b,d.width-this.l,d.height-this.t);break;case 270:this.move(this.t,d.height-
this.r,this.b,d.height-this.l);}}else d=c.pageRect(),c=a.pageRect(),this.offset(c.left-d.left,c.top-d.top);this.o=a;}return this;};});OIT.extend(function(a){var b=a.util;a.RectangleSet=function(a){this._rects=[];this.add(a);};var d=a.subclass(a.RectangleSet);Object.defineProperties(d,{length:{enumerable:!0,get:function(){return this._rects.length;}},left:{enumerable:!0,get:function(){return boundingRectangle().left;}},top:{enumerable:!0,get:function(){return boundingRectangle().top;}},right:{enumerable:!0,get:function(){return boundingRectangle().right;}},bottom:{enumerable:!0,get:function(){return boundingRectangle().bottom;}},width:{enumerable:!0,
get:function(){return boundingRectangle().width;}},height:{enumerable:!0,get:function(){return boundingRectangle().height;}}});d.item=function(a){return this._rects[a];};d.add=function(a){if(a){if(Array.isArray(a))for(var b=0;b<a.length;b++)this._rects.push(a[b]);else this._rects.push(a);this._boundingRect=null;}return this;};d.convert=function(a){b.each(this._rects,'convert',null,a);this._boundingRect=null;return this;};d.boundingRect=function(){if(!this._boundingRect){for(var b=this._rects,d=b[0],e=d.left,
l=d.top,p=d.right,h=d.bottom,q=1;q<b.length;q++)d=b[q],d.left<e&&(e=d.left),d.top<l&&(l=d.top),d.right>p&&(p=d.right),d.bottom>h&&(h=d.bottom);this._boundingRect=new a.Rectangle(e,l,p,h,b[0].origin);}return this._boundingRect;};d.interiorRect=function(a,b){for(var d=this._rects,l=null,p=0,h=0;h<d.length;h++){var q=d[h];if(q.width>=a.width&&q.height>=a.height){l=q;break;}else if(!l||q.width>l.width||q.height>l.height){var m=q.width/a.width,k=q.height/a.height,z=Math.min(m,k);b&&(m=q.height/a.width,k=
q.width/a.height,m=Math.min(m,k),z=Math.max(z,m));if(!l||z>p)l=q,p=z;}}if(l)return l.clone();};});OIT.extend(function(a){var b=a.doc;a.DynamicStyleSheet=function(c){a.Element.call(this,'style');c&&this.attr('media',c);this.append(b.createText(''));b.head.append(this);this.rulecount=0;this.indexLookup={};Object.defineProperty(this,'sheet',{get:function(){return this.dom.sheet;}});};var d=a.subclass(a.DynamicStyleSheet,a.Element);d.addCSSText=function(a){this.html(this.html()+a);};d.setCSSText=function(a){this.html(a);};d.setRule=function(a,b){if(b&&this.indexLookup.hasOwnProperty(b))return this.updateRuleByIndex(a,
this.indexLookup[b]);try{return this.sheet.insertRule(a,this.rulecount),b&&(this.indexLookup[b]=this.rulecount),this.rulecount++;}catch(d){this.logError('setRule','Error inserting style rule: '+d.message);}};d.updateRuleByIndex=function(a,b){if(!isNaN(b)){try{this.sheet.deleteRule(b),this.sheet.insertRule(a,b);}catch(d){this.logError('updateRuleByIndex','Error updating style rule: '+d.message);}return b;}};d.updateRule=function(a,b){this.indexLookup.hasOwnProperty(b)?this.updateRuleByIndex(a,this.indexLookup[b]):
this.updateRuleByIndex(a,b);};d.removeFromNames=function(a){for(var b in this.indexLookup)this.indexLookup[b]==a?delete this.indexLookup[b]:this.indexLookup[b]>a&&(this.indexLookup[b]-=1);};d.deleteRule=function(a){a=this.indexLookup.hasOwnProperty(a)?this.indexLookup[a]:a;!isNaN(a)&&a<this.rulecount&&(this.sheet.deleteRule(a),this.removeFromNames(a),this.rulecount--);};d.hasRule=function(a){return this.indexLookup.hasOwnProperty(a);};});OIT.extend(function(a){var b=a.opt,d=a.util,c=function(a,b){a/=b/2;if(1>a)return 0.5*a*a;a--;return-0.5*(a*(a-2)-1);},f={ease:c,'ease-in-out':c,'ease-in':function(a,b){a/=b;return a*a*a;},'ease-out':function(a,b){a/=b;a--;return a*a*a+1;},linear:function(a,b){return a/b;}},e='opacity offsetLeft offsetTop innerWidth innerHeight scrollLeft scrollTop'.split(' '),l={scrollLeft:!1,scrollTop:!1},p=[],h=function(a){d.eachReverse(p,'step',null,a);0<p.length&&d.requestAnimationFrame(h);},q=function(a){var b=a.elem;
b&&(b.data('_animation')===a&&b.removeData('_animation'),b.removeClass('oit-animating'));d.remove(p,a);};a.on('document','reset',function(){d.each(p,'finish');p=[];for(var a in l)l.hasOwnProperty(a)&&(l[a]=!1);});var m=function(a,b,c){b=b[a];void 0!==b&&(c[a]=b);},k=function(a,b,c){b=b[a];d.isFunction(b)&&(c[a]=b);},z=function(a,b){var c=a[b];c&&(a.args?c.apply(a.context,a.args):c.call(a.context,a.elem));},s=function(a,b){var c=a[b];c&&a.elem.css(c);};a.Animation=function(a,q){this.elem=a;this.time=void 0!==
q.time?q.time:120;k('startFn',q,this);k('stepFn',q,this);k('endFn',q,this);m('context',q,this);q.args&&(this.args=Array.prototype.slice.call(q.args,0),this.args.unshift(a));m('startCSS',q,this);m('endCSS',q,this);this.transFn=f[q.transition]||c;for(var s=b.disableAnimation||0>=this.time,w=0;w<e.length;w++){var z=e[w],u=q[z];if(void 0!==u){var B=a[z];this.props||(this.props={});this.props[z]={start:B,end:u};s|=l[z];}}s||!this.props?this.finish():(p.push(this),a.data('_animation',this),a.addClass('oit-animating'),
d.requestAnimationFrame(h));};a=a.subclass(a.Animation);a.isEmpty=function(){return 0>=this.time||!this.props;};a.step=function(a){var b=!1;this.elem&&void 0===this.startTime&&(s(this,'startCSS'),z(this,'startFn'),this.startTime=a,this.steps=0);if(this.elem&&(this.steps++,a-=this.startTime,a=a>=this.time?1:this.transFn(a,this.time),1>a)){var b=this.props,c;for(c in b){var d=b[c];this.elem[c]=d.start+(d.end-d.start)*a;}z(this,'stepFn');b=!0;}b||this.finish();return b;};a.finish=function(){var a=this.elem;
if(a){var b=this.props;if(this.steps&&4>this.steps)for(var c in b)l.hasOwnProperty(c)&&(l[c]=!0);q(this);void 0===this.startTime&&(s(this,'startCSS'),z(this,'startFn'));for(c in b)a[c]=b[c].end;s(this,'endCSS');z(this,'endFn');this.deleteAll();}};a.abort=function(){this.elem&&(q(this),this.deleteAll());};});OIT.extend(function(a){var b=a.glob,d=a.doc,c=a.util,f=a.css,e=a.dialog,l=a.math,p=OIT.local,h=[];a.DialogBox=function(c){a.Element.call(this,'div','oit-dialog');c=c||{};this._resizable=this._moveable=this._modal=this._visible=!1;h.push(this);this.css('opacity',0);this._form=d.create('form',this);this.move(c.x,c.y,c.width,c.height);void 0!==c.className&&this.addClass(c.className);void 0!==c.moveable&&this.moveable(c.moveable);void 0!==c.resizable&&this.resizable(c.resizable);void 0!==c.modal&&this.modal(c.modal);
void 0!==c.resultFn&&(this._resultFn=c.resultFn);void 0!==c.destroyFn&&(this._destroyFn=c.destroyFn);void 0!==c.title&&this.title(c.title);void 0!==c.textColor&&this.css('color',c.textColor);void 0!==c.backgroundColor&&this._form.css('background-color',c.backgroundColor);c.cancel&&(s(this,p.CANCEL,this.cancel),this.onkeydown(t));c.ok&&s(this,p.OK,this.ok);c.no&&s(this,p.NO,this.no);c.yes&&s(this,p.YES,this.yes);b.rootNode.append(this);};var q=a.subclass(a.DialogBox,a.Element),m=function(a){a=this.pos();
this._dragX=a.left;this._dragY=a.top;this._header.css('cursor',f.cursor.grabbing);},k=function(a){this.move(this._dragX+a.delta.x,this._dragY+a.delta.y);this._header.css('cursor',f.cursor.grabbing);},z=function(a){this._header.css('cursor',f.cursor.grab);},s=function(b,c,e){b._footer||(b._footer=d.create('footer',b),b._footerVisible=!0);c=new a.Button(c);b._footer.append(c);c.onclick(b,e);c.ontap(b,e);},t=function(a){return 27==a.keyCode?(c.preventDefault(a),!1):!0;},v=function(a){var b=0;a._header&&(a._header.css('cursor',
a._moveable?f.cursor.grab:null),b=a._header.offsetHeight);if(a._footer&&a._footerVisible)a._footer.css('display',null),a._form.css({height:null,position:'absolute',top:b+'px',left:'0px',right:'0px',bottom:a._footer.offsetHeight+'px'});else{a._footer&&a._footer.css('display','none');var c=null;0<b&&(c=a.clientHeight-b+'px');a._form.css({position:null,left:null,right:null,top:null,bottom:null,height:c});}};q.destroy=function(){this.cancel();this.show(!1,{animate:!1});this._destroyFn&&this._destroyFn(this);
c.remove(h,this);a.Element.prototype.destroy.call(this);};q.exit=function(){this.cancel();this.show(!1,{endFn:this.destroy,context:this});};q.moveable=function(a){if(!0===a||!1===a)this._moveable=a,v(this);return this._moveable;};q.resizable=function(a,b,c){if((!0===a||!1===a)&&a!=this._resizable){this._resizable=a;var d,e;this._resizable?(this.addClass('oit-dialog-resizable'),void 0!==b&&(d=b+'px'),void 0!==c&&(e=c+'px')):this.removeClass('oit-dialog-resizable');this.css({'min-width':d,'min-height':e});}return this._resizable;};
q.modal=function(a){if((!0===a||!1===a)&&a!==this._modal)this._modal=a,e.showModalOverlay(this._modal);return this._modal;};q.title=function(a){if(a){var b;this._header||(this._header=d.create('header'),this.insert(this._header,this.firstChildElem()),this._header.ondragstart(this,m),this._header.ondragmove(this,k),this._header.ondragend(this,z),this._header.ondragcancel(this,z));b=this._header;this._title||(this._title=d.create(),b.append(this._title));this._title.html(a);this._title.css('display',
null);b.addClass('oit-dialog-header-shaded');v(this);}else null===a&&(this._title&&(this._title.destroy(),delete this._title),this._header&&(this._header.destroy(),delete this._header),v(this));return this._title?this._title.text():void 0;};q.resetForm=function(){this._form.html('');};q.addLabel=function(a,b){var c=d.create('label',this._form);c.html(a);b&&b.style&&c.css(b.style);return c;};q.addTextArea=function(b,c){b&&(this.addLabel(b),d.create('br',this._form));var e=new a.TextArea;this._form.append(e);
c&&(c.style&&e.css(c.style),c.placeholder&&e.attr('placeholder',c.placeholder));return e;};q.show=function(a,b){!1!==a&&(a=!0);a&&(this._result=void 0);this.finishAnimation();if(this._visible==a)b&&(b.startFn&&b.startFn.call(b.context,this),b.endFn&&b.endFn.call(b.context,this));else{b=b||{};var c=0;!1!==b.animate&&(c=200);a?(this.startFn=b.startFn,this.startContext=b.context,this.animate({opacity:1,time:c,startCSS:{opacity:0,display:'block'},startFn:y,endFn:b.endFn,context:this}),this._visible=!0,
this._modal&&e.showModalOverlay(!0,c)):(this.animate({opacity:0,time:c,startFn:b.startFn,endCSS:{display:null},endFn:b.endFn,context:b.context}),this._visible=!1,this._modal&&e.showModalOverlay(!1,c));}return this._visible;};var y=function(){v(this);this.startFn&&this.call(this.startContext,this);delete this.startFn;delete this.startContext;};q.showFooter=function(a){if((!0===a||!1===a)&&a!==this._footerVisible)this._footerVisible=!1!==a,v(this);return this._footerVisible;};q.move=function(a,c,d,g,e){var h=
b.viewNode,f=h.size(),h=h.pos();void 0===d&&(d=this.offsetWidth);var k=f.width-10-10;d>k&&(d=k);void 0===g&&(g=this.offsetHeight);k=f.height-10-10;g>k&&(g=k);void 0!==a&&(k=h.left+f.width-10-d,a>k&&(a=k),a=l.round(a));void 0!==c&&(f=h.top+f.height-10-g,c>f&&(c=f),c=l.round(c));this._visible&&a!==this.offsetLeft||c!==this.offsetTop||d!==this.innerWidth||g!=this.innerHeight?(f=e&&!0===e.animate?200:0,e&&(this.moveOptions=e),this.css('overflow','hidden'),this.animate({offsetLeft:a,offsetTop:c,innerWidth:d,
innerHeight:g,time:f,endCSS:{overflow:null},endFn:w,context:this})):e&&e.endFn&&e.endFn.call(e.context,this);};var w=function(){v(this);var a=this.moveOptions;a&&a.endFn&&a.endFn.call(a.context,this);delete this.moveOptions;};q.autoSize=function(a,b,c,d,e){(c=this.hasClass('oit-animating'))&&this.removeClass('oit-animating');var h=['width','height','display','opacity'];d=this.css(h);this.removeStyle(h);this.css('display','block');this.css('opacity','1');var h=this.offsetWidth,f=this.offsetHeight;this.css(d);
c&&this.addClass('oit-animating');this.move(a,b,h,f,e);};q.maxsize=function(a,b){var c={};void 0!=a&&(c['max-width']=0===a?null:a+'px');void 0!=b&&(c['max-height']=0===b?null:b+'px');this.css(c);};var x=function(a,b){a._visible||a.css('display','block');var c=a[b];a._visible||a.css('display',null);return c;};q.width=function(){return x(this,'offsetWidth');};q.height=function(){return x(this,'offsetHeight');};var u=function(a,b){void 0===a._result&&(a._result=b,a._resultFn&&a._resultFn(a,b));};q.cancel=
function(){u(this,!1);};q.ok=function(){u(this,!0);};q.no=function(){u(this,0);};q.yes=function(){u(this,1);};q.result=function(){return this._result;};a.on('document','reset',function(){for(;0<h.length;)h.shift().destroy();});});OIT.extend(function(a){a.export('TextRange',function(a,d){if(a>d){var c=a;a=d;d=c;}this.type='text';this.acc=a;this.accend=d;});});OIT.extend(function(a){a.export('CellRange',function(b,d,c,f,e,l,p,h,q){if(d>f){var m=d;d=f;f=m;}c>e&&(m=c,c=e,e=m);this.type='cell';this.page=b;this.section=a.pages.page(b).section;this.c1=d;this.r1=c;this.c2=f;this.r2=e;void 0!==l&&(this.offsets='number'===typeof l?{left:l,top:p,right:h,bottom:q}:{left:l.left,top:l.top,right:l.right,bottom:l.bottom});});});OIT.extend(function(a){a.export('RectRange',function(b,d,c,f,e,l,p,h){if(c>e){var q=c;c=e;e=q;}f>l&&(q=f,f=l,l=q);this.type='rect';void 0!==b&&(this.embedId=b);this.page=d;this.left=c;this.top=f;this.right=e;this.bottom=l;this.units=p;if(void 0!==h)this.section=h;else if(d=a.pages.page(d))this.section=d.section;});});OIT.extend(function(a){var b=a.doc;a.DrawingObject=function(c,d,l){a.Element.call(this,'div',d);this._layer=c;this._visible=!0;l?l.append(this):c.append(this);b.attach(this);this.changed();};var d=a.subclass(a.DrawingObject,a.Element);d.createChild=function(b){return new a.DrawingChildObject(this,b);};d.layer=function(){return this._layer;};d.moveToTop=function(){this.parent().append(this);};d.addClass=function(b){this.hasClass(b)||(a.Element.prototype.addClass.apply(this,arguments),delete this._borderOffset,
this.changed());return this;};d.removeClass=function(b){this.hasClass(b)&&(a.Element.prototype.removeClass.apply(this,arguments),delete this._borderOffset,this.changed());return this;};d.defaultSize=function(){if(!this._defaultSize){var a=['transform','display','width','height'],b=this.css(a);this.removeStyle(a);this._defaultSize={width:this.offsetWidth,height:this.offsetHeight};this.css(b);}return this._defaultSize;};d.setDefaultSize=function(a){this._defaultSize=a;};d.resetDefaultSize=function(){this._defaultSize&&
(this._defaultSize=null);};d.setTitle=function(a){this.attr('title',a);};d.show=function(a){!1!==a&&(a=!0);a!==this._visible&&((this._visible=a)?(this.css('display',null),this.changed()):this.css('display','none'));return this;};d.hide=function(){return this.show(!1);};d.visible=function(){return this._visible&&this._layer.visible();};d.layoutObject=function(){if(!this._animating&&this.visible()){var a=this.position();if(a){var b={};b.left=a.left;this._borderOffset&&(b.left-=this._borderOffset.left);b.left+=
'px';b.top=a.top;this._borderOffset&&(b.top-=this._borderOffset.top);b.top+='px';b.width=a.width+'px';b.height=a.height+'px';this.css(b);this._borderOffset||(this._borderOffset={left:this.clientLeft,top:this.clientTop},this._borderOffset.left&&this.css('left',a.left-this._borderOffset.left+'px'),this._borderOffset.top&&this.css('top',a.top-this._borderOffset.top+'px'));}}return this;};d.changed=function(){this._dirty||(this._dirty=!0,this._parentObject?this._parentObject.childChanged(this):this._layer.changed(this));
return this;};d.childChanged=function(a){this._dirty||(this._parentObject?this._parentObject.childChanged(this):this._layer.changed(this));return this;};d.update=function(a){this._dirty&&(a=!0,this._dirty=!1);a&&this.layoutObject();this.queryChildElements(c,a);return this;};var c=function(a,b,c){a.update&&a.update(c);};});OIT.extend(function(a){a.DrawingChildObject=function(b,c){c=c||{};a.DrawingObject.call(this,b.layer(),c.classList,b);this._parentObject=b;c.title&&this.setTitle(c.title);var f=c.margin||0;this._margin={left:f,top:f,right:f,bottom:f};void 0!==c.hpos&&(this._hpos=c.hpos);void 0!==c.vpos&&(this._vpos=c.vpos);!0===c.inheritMoveable&&(this.inheritMoveable=!0);};var b=a.subclass(a.DrawingChildObject,a.DrawingObject);b.resize=function(a,b){if(void 0!==a||void 0!==b){if(!this._size||this._size.width!==a||
this._size.height!==b)this._size={width:a,height:b},this.changed();}else this._size&&(delete this._size,this.changed());return this;};b.setMargin=function(a,b,f,e){var l=!1;void 0!==a&&a!==this._margin.left&&(this._margin.left=a,l=!0);void 0!==b&&b!==this._margin.top&&(this._margin.top=b,l=!0);void 0!==f&&f!==this._margin.right&&(this._margin.right=f,l=!0);void 0!==e&&e!==this._margin.bottom&&(this._margin.bottom=e,l=!0);l&&(this._pos&&(this._pos=void 0),this.changed());return this;};b.position=function(){if(this._parentObject){var b=
this._parentObject.position()||this._parentObject.defaultSize();if(this._pos&&b.width!=this._parentWidth||b.height!=this._parentHeight)this._pos=void 0;if(void 0===this._pos){this._parentWidth=b.width;this._parentHeight=b.height;var c,f,e,l;if('fill'===this._hpos)c=this._margin.left,e=b.width-this._margin.left-this._margin.right;else if(void 0!==this._hpos)if(e=this._size&&0<this._size.width?this._size.width:this.defaultSize().width,'number'===typeof this._hpos)c=0<=this._hpos?this._margin.left+this._hpos:
b.width-this._margin.right-e+this._hpos;else switch(this._hpos){case 'left':c=this._margin.left;break;case 'center':c=(b.width-e)/2;break;case 'right':c=b.width-this._margin.right-e;}if('fill'===this._vpos)f=this._margin.top,l=b.height-this._margin.top-this._margin.bottom;else if(void 0!==this._vpos)if(l=this._size&&0<this._size.height?this._size.height:this.defaultSize().height,'number'===typeof this._vpos)f=0<=this._vpos?this._margin.top+this._vpos:b.height-this._margin.bottom-l+this._vpos;else switch(this._vpos){case 'top':f=
this._margin.top;break;case 'middle':f=(b.height-l)/2;break;case 'bottom':f=b.height-this._margin.bottom-l;}void 0!==c||void 0!==f||void 0!==e||void 0!==l?(void 0===c&&(c=0),void 0===f&&(f=0),void 0===e&&(e=this.defaultSize().width),void 0===l&&(l=this.defaultSize().height),this._pos=new a.Rectangle(c,f,c+e,f+l,'overlay')):this._pos=null;}}return this._pos;};});OIT.extend(function(a){var b=a.math;a.DrawingObjectLabel=function(b){a.DrawingChildObject.call(this,b,{hpos:'center',vpos:'middle',classList:'oit-highlight-label',inheritMoveable:!0});};var d=a.subclass(a.DrawingObjectLabel,a.DrawingChildObject);d.destroy=function(){this._parentObject&&this._parentObject.attr('title',null);a.DrawingChildObject.prototype.destroy.call(this);};d.setText=function(a){this._labelText=a=a||'';this.html(a);this.setTitle(a);this.resetDefaultSize();this.changed();};d.setColor=
function(a,b){this.css('color',a);};d.setBoundingRect=function(a){a?this._parentRect=a.clone():delete this._parentRect;this.show();};d.position=function(){if(this._parentObject){var c=this._parentRect||this._parentObject.position();this.css('transform',null);this.showLabelText=!0;this.html(this._labelText);var d='',e=this.defaultSize(),l=e.width+4,p=e.height+4,h=!1;if(l>c.width||p>c.height){if(l>p&&c.width<c.height||l<p&&c.width>c.height)e={width:e.height,height:e.width},l=e.width+4,p=e.height+4,d=
'rotate(270deg)',h=!0;if(l>c.width||p>c.height){var q=b.round(Math.min(c.width/l,c.height/p),1E3);0.4>q?(d='',this.html(''),this.showLabelText=!1):(d+='scale('+q+','+q+')',l=e.width*q+4,p=e.height*q+4);}}this.css('transform',d);if(this.showLabelText)return d=c.left+(c.width-l)/2,c=c.top+(c.height-p)/2,h&&(c+=p),l=d+l,p=c+p,this.show(),new a.Rectangle(d,c,l,p,'overlay');this.hide();}};});OIT.extend(function(a){var b=a.doc,d=a.util;a.RectActivation=function(b){a.DrawingChildObject.call(this,b,{hpos:'fill',vpos:'fill',classList:'oit-activation',inheritMoveable:!0});};var c=a.subclass(a.RectActivation,a.DrawingChildObject);c.setResizable=function(a){if(a){this._resizable||(this.addClass('oit-resize'),f(this,'oit-resize-n',!1,!0,!1,!1),f(this,'oit-resize-s',!1,!1,!1,!0),f(this,'oit-resize-e',!1,!1,!0,!1),f(this,'oit-resize-w',!0,!1,!1,!1),f(this,'oit-resize-ne',!1,!0,!0,!1),f(this,'oit-resize-nw',
!0,!0,!1,!1),f(this,'oit-resize-se',!1,!1,!0,!0),f(this,'oit-resize-sw',!0,!1,!1,!0));var b=a.margin||0;0>b&&this.setMargin(b,b,b,b);this._resizable=a;}else this._resizable&&(this._resizeHandles&&(d.each(this._resizeHandles,'destroy'),delete this._resizeHandles),delete this._resizable,this.removeClass('oit-resize'));};var f=function(a,c,d,e,f,t){c=b.create('div',c);c.on('dragstart',a,l,d,e,f,t);c.on('dragmove',a,p);c.on('dragend',a,h);c.on('dragcancel',a,h);a.append(c);a._resizeHandles||(a._resizeHandles=
[]);a._resizeHandles.push(c);},e=function(a,b,c){b=b._parentObject;b.dispatchCustom(a,{drawingRect:b,newRect:c.curRect,moved:c.resized});},l=function(a,b,c,d,h){a=this._parentObject.position();this.resizeInfo=b={left:b,top:c,right:d,bottom:h,startRect:a.clone(),curRect:a.clone(),resized:!1};e('resizestart',this,b);},p=function(a){var b=this.resizeInfo;this.calculateResize(b,a);b.resized=!0;e('resizemove',this,b);if(!this._resizable.bindToObject){a=this._parentObject.position();var c=this._resizable&&
this._resizable.margin?this._resizable.margin:0;this.setMargin(c+b.curRect.left-a.left,c+b.curRect.top-a.top,c+a.right-b.curRect.right,c+a.bottom-b.curRect.bottom);}},h=function(a){a=this.resizeInfo;if(!this._resizable.bindToObject){var b=this._resizable&&this._resizable.margin?this._resizable.margin:0;this.setMargin(b,b,b,b);}e('resizeend',this,a);delete this.resizeInfo;};c.calculateResize=function(a,b){var c=b.delta.x,d=b.delta.y,e=a.startRect.left,h=a.startRect.top,f=a.startRect.right,l=a.startRect.bottom;
a.left?(e+=c,f-e<this._resizable.minWidth&&(e=f-this._resizable.minWidth)):a.right&&(f+=c,f-e<this._resizable.minWidth&&(f=e+this._resizable.minWidth));a.top?(h+=d,l-h<this._resizable.minHeight&&(h=l-this._resizable.minHeight)):a.bottom&&(l+=d,l-h<this._resizable.minHeight&&(l=h+this._resizable.minHeight));return e!=a.curRect.left||h!=a.curRect.top||f!=a.curRect.right||l!=a.curRect.bottom?(a.curRect.move(e,h,f,l),!0):!1;};});OIT.extend(function(a){var b=a.doc,d=a.glob,c=a.util,f=a.pages,e=a.range,l;a.TextActivation=function(b){a.DrawingChildObject.call(this,b,{hpos:'fill',vpos:'fill',classList:'oit-activation'});this._range=e.clone(b._range);this._startHandle=h(this,q);this._endHandle=h(this,m);};var p=a.subclass(a.TextActivation,a.DrawingChildObject),h=function(c,d){var e=new a.DrawingChildObject(c,{hpos:0,vpos:0,classList:'oit-text-handle'});e.append(b.create('div')).append(b.create('div')).ondragstart(c,d).ondragmove(c,
z).ondragend(c,s).ondragcancel(c,s);return e;};p.showHandles=function(a){a=!1!==a?null:'none';this._startHandle.css('display',a);this._endHandle.css('display',a);};var q=function(a){var b=this._range;k(this,this._startHandle,a,b.accend,b.acc);},m=function(a){var b=this._range;k(this,this._endHandle,a,b.acc,b.accend);},k=function(a,b,c,e,h){a._anchor=e;a._focus=h;b=b.pos(d.viewNode);c=c.center;a._adjust={x:16-(c.x-b.left),y:-(c.y-b.top)};},z=function(a){var b=a.center;if(b&&(a=this._parentObject,b=f.mapToPage(b.x+
this._adjust.x,b.y+this._adjust.y,null,!0))){if(void 0===this._textAnchorRoot){var d=b.page.findACC(a._range.acc);this._textAnchorRoot=d?c.getTextRoot(d[0]):null;}if(d=b.page.mapPointToText(b.x,b.y,this._textAnchorRoot))d=d.acc,d!=this._focus&&(this._focus=d,this._focus>=this._anchor?(this._range.acc=this._anchor,this._range.accend=this._focus):(this._range.acc=this._focus,this._range.accend=this._anchor),this.changed(),a.setRange(this._range),a.dispatchCustom('textmove',{range:this._range,page:b.page}));}},
s=function(a){a=this._parentObject;a.setRange(this._range);a.dispatchCustom('textmoveend',{range:this._range});delete this._anchor;delete this._focus;delete this._adjust;};p.layoutObject=function(){if(this.visible()){var b=this._parentObject;a.DrawingChildObject.prototype.layoutObject.call(this);l||(l=this._startHandle.defaultSize());var c=this._parentObject.position(),d;c?(this.show(),d=t(this._startHandle,c,b.startHandleRect()),c=t(this._endHandle,c,b.endHandleRect()),!d&&!c&&(d=f.pagesForRange(b._range),
this.show(d&&-1!=d.indexOf(b._page)))):this.hide();}};var t=function(a,b,c){c?(a.setMargin(c.left-b.left-l.width/2,c.bottom-b.top-1),a.resize(l.width,l.height),a.show()):a.hide();return c;};});OIT.extend(function(a){var b=a.util;a.DrawingShape=function(b,c,d){a.DrawingObject.call(this,c,d);this._pos=new a.Rectangle(0,0,0,0,'overlay');};var d=a.subclass(a.DrawingShape,a.DrawingObject);d.setLabel=function(a,c,d){if(a){if(d=d||'#FFF',a!==this._labelText||c!=this._labelColor||d!=this._backgroundColor)if(this._labelText=a,this._labelColor=c||'#000',this._labelBackground=d||'#FFF',this.setTitle(this._labelText),this._labels)for(a=0;a<this._labels.length;a++)c=this._labels[a],c.setText(this._labelText),
c.setColor(this._labelColor,this._labelBackground);}else this._labelText&&(delete this._labelText,delete this._labelColor,delete this._labelBackground,this.setTitle(''),this._labels&&(b.each(this._labels,'destroy'),delete this._labels));this.changed();};d.allocateLabelChildren=function(b){this._labels||(this._labels=[]);for(;this._labels.length<b;){var c=new a.DrawingObjectLabel(this);this._labels.push(c);c.setText(this._labelText);c.setColor(this._labelColor,this._labelBackground);}for(;this._labels.length>
b;)this._labels.pop().destroy();return this._labels;};d.labelChildCount=function(){return this._labels?this._labels.length:0;};d.getLabelChild=function(a){if(this._labels)return this._labels[a];};d.move=function(a,b,d,h,q){this._pos.movesize(a,b,d,h)&&(this.changed(),this.finishAnimation(),q&&(a=this.position(),q.stepFn&&(this.stepMoveFn=q.stepFn),q.endFn&&(this.endMoveFn=q.endFn),q={offsetLeft:a.left,offsetTop:a.top,innerWidth:a.width,innerHeight:a.height,transition:q.transition||'ease',time:q.timems,
startFn:q.startFn,stepFn:c,endFn:f,context:this},this._animating=!0,this.animate(q)));return this;};var c=function(a){this.update(!0);this.stepMoveFn&&this.stepMoveFn(this);},f=function(a){delete this._animating;this.changed();this.endMoveFn&&this.endMoveFn(this);delete this.stepMoveFn;delete this.endMoveFn;};d.resize=function(a,b){return this.move(void 0,void 0,a,b);};d.position=function(){return this._pos;};});OIT.extend(function(a){a.DrawingRect=function(b,c,f){a.DrawingShape.call(this,b,c,f);};var b=a.subclass(a.DrawingRect,a.DrawingShape);b.customEvent('resizestart');b.customEvent('resizemove');b.customEvent('resizeend');b.activate=function(b,c){this._rectActivation||(this._rectActivation=new a.RectActivation(this),c&&this.insertFirst(this._rectActivation),this._resizable&&this._rectActivation.setResizable(this._resizable));this.moveToTop();return this;};b.deactivate=function(){this._rectActivation&&(this._rectActivation.destroy(),
delete this._rectActivation);return this;};b.resizable=function(a,b){if(!0===a){b=b||{};var f=!0,e=b.minWidth||0,l=b.minHeight||0,p=b.margin||0;!1===b.bindToObject&&(f=!1);if(!this._resizable||this._resizable.bindToObject!=f||this._resizable.onResizeStart!=b.onResizeStart||this._resizable.onResize!=b.onResize||this._resizable.onResizeEnd!=b.onResizeEnd||this._resizable.onResizeCancel!=b.onResizeCancel||this._resizable.context!==b.context||this._resizable.minWidth!=e||this._resizable.minHeight!=l||
this._resizable.margin!=p)this._resizable={bindToObject:f,minWidth:e,minHeight:l,margin:p},b.onResizeStart&&(this._resizable.onResizeStart=b.onResizeStart),b.onResize&&(this._resizable.onResize=b.onResize),b.onResizeEnd&&(this._resizable.onResizeEnd=b.onResizeEnd),b.onResizeCancel&&(this._resizable.onResizeCancel=b.onResizeCancel),this._resizable.context=b.context||this,this._rectActivation&&this._rectActivation.setResizable(this._resizable);}else this._resizable&&!1===a&&(delete this._resizable,this._rectActivation&&
this._rectActivation.setResizable(null));return this;};b.layoutObject=function(){if(this.visible()&&!this._animating&&(a.DrawingShape.prototype.layoutObject.call(this),this._labelText)){var b=this.position().clone();b.left=0;b.top=0;this.allocateLabelChildren(1)[0].setBoundingRect(b);}return this;};});OIT.extend(function(a){var b=a.range,d=a.pages;a.TextRect=function(b,c,f){a.DrawingShape.call(this,b,c,f);this._page=d.page(b);};var c=a.subclass(a.TextRect,a.DrawingShape);c.customEvent('textmove');c.customEvent('textmoveend');c.activate=function(b){this._textActivation||(this._textActivation=new a.TextActivation(this));this._textActivation.showHandles(this._showHandles);this.moveToTop();return this;};c.deactivate=function(){this._textActivation&&(this._textActivation.destroy(),delete this._textActivation);
return this;};c.setRange=function(a){if(a&&'text'===a.type)if(this._range){if(this._range.acc!=a.acc||this._range.accend!==a.accend)this._range.acc=a.acc,this._range.accend=a.accend,this.changed();}else this._range=b.clone(a),this.changed();return this;};c.showTextHandles=function(){this._showHandles=!0;this._textActivation&&this._textActivation.showHandles(!0);return this;};c.hideTextHandles=function(){this._showHandles=!1;this._textActivation&&this._textActivation.showHandles(!1);return this;};c.layoutObject=
function(){if(this.visible()&&!this._animating){var b=this._page.textBoundingRect(this._range);b&&(b.origin=!0==this._page.bNotesBar?'view':'overlay',this.move(b.left,b.top,b.width,b.height));a.DrawingShape.prototype.layoutObject.call(this);if(this._labelText){var c=this._page.textRects(this._range,'overlay'),b=this._page.textBoundingRect(this._range);if(c&&b&&(b.origin='overlay',this.allocateLabelChildren(c.length),0<this._labels.length))for(var d=this.getLabelChild(0).defaultSize(),h=0;h<this._labels.length;h++){var f=
this.getLabelChild(h);f.setDefaultSize(d);this._moveable?f.addClass('oit-moveable'):f.removeClass('oit-moveable');var m=c[h].interiorRect(d,!0);m&&m.offset(-b.left,-b.top);f.setBoundingRect(m);}}}return this;};var f=function(a,b,c){var d=a._page.accRect(b,'overlay');if(!d&&(d=a._page.accRect(b+c,'overlay'),!d&&(d=a._page.accRect(b-c,'overlay'))))d.left=d.right;d&&(d.width=0);return d;};c.startHandleRect=function(){if(this._range)return f(this,this._range.acc,1);};c.endHandleRect=function(){if(this._range)return f(this,
this._range.accend,-1);};});OIT.extend(function(a){var b=a.doc;a.DrawingLayer=function(c,d,l){a.Element.call(this,'div','oit-drawinglayer-'+d,l);this._drawing=c;this._name=d;this._visible=!0;b.attach(this);c.append(this);this.show();};var d=a.subclass(a.DrawingLayer,a.Element);d.drawing=function(){return this._drawing;};d.show=function(a){void 0===a&&(a=!0);a!==this._visible&&(!0===a?(this._visible=!0,this.css('display',null),this.update(!0)):!1===a&&(this._visible=!1,this.css('display','none')));};d.hide=function(){this.show(!1);};
d.visible=function(){return this._visible;};d.update=function(a){this.queryChildElements(c,a);};var c=function(a,b,c){a.update&&a.update(c);};d.changed=function(){this._drawing.changed();};});OIT.extend(function(a){var b=a.doc,d=a.util;a.Drawing=function(c){a.Element.call(this,'div','oit-drawingpanel');b.attach(this);this._origin=null;c.append(this);c.onscroll(this,this.updateScroll);};var c=a.subclass(a.Drawing,a.Element);c.destroy=function(){var b=this.parent();b&&b.offscroll(this.updateScroll);a.Element.prototype.destroy.call(this);};c.update=function(a){!0!==a&&(a=!1);this._animationFrame&&(this._animationFrame=null);this.queryChildElements(f,a);};var f=function(a,b,c){a.update&&a.update(c);};
c.changed=function(){this._animationFrame||(this._animationFrame=d.requestAnimationFrame(this.update,this));};c.setOrigin=function(a,b){if(this._origin){if(this._origin.x!=a||this._origin.y!=b)this._origin.x=a,this._origin.y=b,this.updateScroll();}else this._origin={x:a,y:b},this.updateScroll();};c.resetOrigin=function(){this._origin&&(this._origin=null,this.css({left:null,top:null}));};c.updateScroll=function(){if(this._origin){var a=this.parent().scroll();this.css({left:this._origin.x+a.left+'px',top:this._origin.y+
a.top+'px'});}};});OIT.extend(function(a){var b=a.doc,d=a.hyperlinks,c=a.stylemap,f=a.css;a.SpanSplit=function(b,c,d){a.Element.call(this,b);this.acc=c;this.accend=d;if(b=b.parentNode)if((b=b.className)&&'oit-slidenotes'==b)this.bSlideNote=!0;void 0===this.accend&&(this.accend=c+this.text().length);};var e=a.subclass(a.SpanSplit,a.Element);e.destroy=function(){this.unload();a.Element.prototype.destroy.call(this);};e.unload=function(){p(this,null,null);};e.text=function(a){if(void 0!==a){var b=this._anchor||this;b.destroyChildren();
b.dom.textContent=a;}return this.dom.textContent;};e.textNode=function(){return(this._anchor||this).dom.firstChild;};e.createSplit=function(b){var c=new a.SpanSplit('span',this.acc,b);this.copyDataTo(c);var d=this.text(),e=b-this.acc;c.text(d.substring(0,e));this.text(d.substring(e));this.acc=b;this._changed=!0;return c;};e.mergeSplit=function(a){var b=this.text()+a.text();this.text(b);this.accend=a.accend;this._changed=!0;a.destroy();};e.dataEquals=function(a){var b=!1,c=this._data;a=a._data;if(c){if(a&&
c.length==a.length)for(var b=!0,d=0;d<c.length;d++){var e=c[d],f=a[d];if(e.type!==f.type||e.id!==f.id){b=!1;break;}}}else b=!a;return b;};e.addData=function(a){this._data||(this._data=[]);'hyperlink'===a.type?this._data.unshift(a):this._data.push(a);this._changed=!0;};e.removeData=function(a,b){if(this._data)for(var c=0;c<this._data.length;c++){var d=this._data[c];if(d.type===a&&d.id===b){this._data.splice(c,1);0==this._data.length&&delete this._data;this._changed=!0;break;}}};e.copyDataTo=function(a){this._data&&
(a._data=a._data?a._data.concat(this._data):this._data.slice(0),a._changed=!0);};e.moveDataTo=function(a){this._data&&(l(this,null,null,null),a._data=a._data?a._data.concat(this._data):this._data,delete this._data,this._changed=!0,a._changed=!0);};e.updateData=function(){if(this._changed){var a,b,c;if(this._data)for(var d=0;d<this._data.length;d++){var e=this._data[d];if('style'===e.type)for(var p in e.props){if(e.props.hasOwnProperty(p)){var t=e.props[p];if(c&&'background-color'==p){var v=c[p];v&&
(t=f.blendColors(t,v));}c||(c={});c[p]=t;}}else'hyperlink'===e.type?a=e:'bookmark'===e.type&&(b=e);}l(this,c,a,b);this._changed=!1;}};var l=function(a,b,d,e){b?(b=c.styleName(b),b!=a._splitClass&&(a._splitClass&&a.removeClass(a._splitClass),a.addClass(b),a._splitClass=b)):a._splitClass&&(a.removeClass(a._splitClass),delete a._splitClass);p(a,d,e);},p=function(a,c,e){var f=a._anchor;if(c||e){var l=c&&0==c.url.indexOf('#');f||(f=l?a._anchor=b.create('span'):a._anchor=b.create('a'),f.text(a.text()),a.html(''),
a.append(f));c&&(a.addClass('oit-hyperlink'),l||f.attr('href',c.url),d.on.addElement(f,c));e&&f.attr('id',e.id);}else f&&(d.on.removeElement(f),c=f.text(),f.destroy(),delete a._anchor,a.removeClass('oit-hyperlink'),a.html(c));};});OIT.extend(function(a){var b=a.range,d=a.math,c=a.util,f=/^[^\u0591-\u07ff\u200f\u202b\u202e\ufb1d-\ufdfd\ufe70-\ufefc]*?[\u0591-\u07ff\u200f\u202b\u202e\ufb1d-\ufdfd\ufe70-\ufefc]/;a.SpanInfo=function(b,c){a.SpanSplit.call(this,b,c);};var e=a.subclass(a.SpanInfo,a.SpanSplit);e.unload=function(){this.discardLayout();c.each(this._splits,'unload');a.SpanSplit.prototype.unload.call(this);};e.discardLayout=function(){delete this._charRects;delete this._spanRect;};e.distanceFromPoint=function(a,b,c){return Math.abs(this.spanRect(a).distanceFrom(b,
c));};e.overlapRange=function(a,c){var d=this.spanRect(a);if(d.overlaps(c)){if(c.contains(d))return b.textRange(this.acc,this.accend);if(d=p(this,a)){for(var e,f,l=0;l<d.length;l++)c.overlaps(d[l])&&(f=this.acc+l,void 0===e&&(e=f),f+=1);if(void 0!==e)return b.textRange(e,f);}}};e.spanRect=function(b){if(!this._spanRect&&b){if(!b)throw'Missing page in SpanInfo.spanRect';this._spanRect=new a.Rectangle(this.rect(b.overlay),'overlay');this._spanRect.origin=b;}return this._spanRect;};e.textAngle=function(){void 0===
this._angle&&(this._angle=this.ancestorData('angle'),this._angle=void 0!==this._angle?d.radians(Number(this._angle)):0);return this._angle;};e.rtl=function(){void 0===this._rtl&&(this._rtl=!!f.test(this.text()));return this._rtl;};e.findClosestChar=function(a,b,c){var d=p(this,c),e,f;for(c=0;c<d.length;c++){var l=Math.abs(d[c].distanceFrom(a,b,'left','middle'));if(void 0===e||l<f)e=c,f=l,c==d.length-1&&(l=d[c].distanceFrom(a,b,'center','none'),0<l&&e++);}var v,y;if(this._splits){a=this._splits;for(c=
b=0;c<a.length;c++){f=a[c].textNode();d=b+f.textContent.length;if(e>=b&&e<d){v=f;y=e-b;break;}b=d;}v||(v=a[a.length-1].textNode(),y=v.textContent.length);}else v=this.textNode(),y=e;return{node:v,offset:y,acc:this.acc+e};};e.textRect=function(b,c){if(b.acc<=this.acc&&b.accend>=this.accend)return new a.Rectangle(this.spanRect(c));if(b.acc<this.accend&&b.accend>this.acc){var d=p(this,c);if(d){var e,f=b.acc-this.acc;0>f&&(f=0);var l=b.accend-this.acc;l>d.length&&(l=d.length);e=!0==this.bSlideNote?new a.Rectangle(d[f],
'view'):new a.Rectangle(d[f],c);l==f&&(e.width=0);for(f+=1;f<l;f++)e.union(d[f]);return e;}}};e.findTextRange=function(a,b){var c,d,e,f,l=this._splits;if(l){if(a.acc<=this.acc&&(c=l[0].textNode(),d=0),a.accend>=this.accend&&(e=l[l.length-1].textNode(),f=e.textContent.length),!c||!e)for(var p=0;p<l.length;p++){var y=l[p];if(a.accend<y.acc)break;if(!c&&a.acc<y.accend&&(c=y.textNode(),d=a.acc-y.acc,0>d&&(d=0),e))break;if(c&&!e&&a.accend<=y.accend){e=y.textNode();f=a.accend-y.acc;0>f&&(f=0);break;}}}else c=
e=this.textNode(),d=0,a.acc>this.acc&&(d+=a.acc-this.acc),f=this.text().length,a.accend<this.accend&&(f-=this.accend-a.accend);l=document.createRange();l.setStart(c,d);l.setEnd(e,f);b.push(l);};var l=function(b,c,d,e){b=new a.Rectangle(b.rect(e.overlay),'overlay');b.convert(e);d._charRects.push(b);},p=function(b,c){if(!b._charRects&&c){var e=b.text(),f=new a.Element;f.transferFrom(b);for(var p='',s=0;s<e.length;s++)p+='<span>',p+=e[s],p+='</span>';b.html(p);b._charRects=[];b.forChildElements(l,b,c);
s=new a.Rectangle(b.rect(c.overlay),'overlay');s.origin=c;b.html('');b.transferFrom(f);e=b.spanRect(c);if(e.width!=s.width&&(f=e.width/s.width,!d.approxEqual(f,1))){e=e.left;for(s=0;s<b._charRects.length;s++){var p=b._charRects[s],t=(p.left-e)*f+e;p.move(t,void 0,t+p.width*f,void 0);}}}return b._charRects;};e.createSplit=function(){var b=new a.SpanSplit('span',this.acc,this.accend);this.moveDataTo(b);b.transferFrom(this);return b;};e.updateData=function(){var b=this._splits;b?c.each(b,'updateData'):
a.SpanSplit.prototype.updateData.call(this);};e.split=function(a){if(!this._splits){if(a.acc<=this.acc&&a.accend>=this.accend)return[this];var b=this.createSplit();this.append(b);this._splits=[b];}for(var b=this._splits,c=[],d=0;d<b.length;d++){var e=b[d];if(!(a.acc>=e.accend)){if(a.accend<=e.acc)break;if(a.acc>e.acc){var f=e.createSplit(a.acc);b.splice(d++,0,f);this.insert(f,e);}a.accend<e.accend&&(f=e.createSplit(a.accend),b.splice(d++,0,f),this.insert(f,e),e=f);c.push(e);}}return c;};e.join=function(){var a=
this._splits;if(a){for(var b=a[a.length-1],c=a.length-2;0<=c;c--){var d=a[c];d.dataEquals(b)&&(d.mergeSplit(b),a.splice(c+1,1));b=d;}1==a.length&&(d=a[0],d.moveDataTo(this),this.text(d.text()),d.destroy(),delete this._splits);}};e.addDataToRange=function(a,b,d){if(a=this.split(a))c.each(a,'addData',null,b),this.join(),this.updateData(),'hyperlink'===b.type&&p(this,d);};e.removeData=function(b,d){a.SpanSplit.prototype.removeData.call(this,b,d);c.each(this._splits,'removeData',null,b,d);this.join();this.updateData();};});OIT.extend(function(a){var b=a.doc,d=a.range,c=a.util;a.SpanMap=function(c){this._page=c;this._spans=[];for(var d,f=c.createTreeWalker(NodeFilter.SHOW_ELEMENT),h=f.firstACCNode();h;){var h=f.currentNode,q=b.data(h,'acc');q&&(d=Number(q));for(var q=!0,m=h.firstChild;m;m=m.nextSibling)if(3==m.nodeType){q=!1;break;}!q&&void 0!==d?(d=new a.SpanInfo(h,d),this._spans.push(d),d=d.accend,(h=f.skipNode())&&(h=f.firstACCNode())):h=f.nextACCNode();}this._layoutSettings={};if(!c.checkedACCRange){if(f=this.getTextRange())f.acc<
c.acc&&(c.acc=f.acc),f.accend>c.accend&&(c.accend=f.accend);c.checkedACCRange=!0;}};var f=a.subclass(a.SpanMap);f.destroy=function(){c.each(this._spans,'unload');this.deleteAll();};f.discardLayout=function(){c.each(this._spans,'discardLayout');};f.getTextRange=function(){for(var a,b=0;b<this._spans.length;b++){var c=this._spans[b];a?(c.acc<a.acc&&(a.acc=c.acc),c.accend>a.accend&&(a.accend=c.accend)):a=d.textRange(c.acc,c.accend);}return a;};f.textRanges=function(){for(var a=[],b,c=this._page.isEmailHeader(),
h=0;h<this._spans.length;h++){var f=this._spans[h];!c&&b&&b.accend+1>=f.acc?f.accend>b.accend&&(b.accend=f.accend):(b=d.textRange(f.acc,f.accend),a.push(b));}return a;};f.mapPointToSpan=function(a,b,c){if(0<this._spans.length){var d,f=this._page,m=f.isHidden();m&&f.show();for(var k=[],z,s=0;s<this._spans.length;s++){var t=this._spans[s];if(!c||t.equals(c)||t.isDescendantOf(c)){var v=t.spanRect(f),v=b<v.top?v.top-b:b>v.bottom?b-v.bottom:0;if(void 0===z||v<z)k.length=0,z=v;v==z&&k.push(t);}}z=void 0;if(1==
k.length)d=k[0];else for(s=0;s<k.length;s++)if(t=k[s],v=Math.abs(t.spanRect(f).distanceFrom(a,b)),void 0===z||v<z)d=t,z=v;m&&f.hide();return d;}};f.findOverlappingText=function(a){if(0<this._spans.length){var b=[],c=this._page.isHidden();c&&this._page.show();for(var d=0;d<this._spans.length;d++){var f=this._spans[d].overlapRange(this._page,a);f&&b.push(f);}c&&this._page.hide();if(0<b.length)return b;}};f.findRange=function(a,b){for(var c=[],d=0;d<this._spans.length;d++){var f=this._spans[d];f.acc<=b&&
f.accend>a&&c.push(f);}if(0<c.length)return c;};f.findACC=function(a){for(var b=[],c=0;c<this._spans.length;c++){var d=this._spans[c];a>=d.acc&&a<d.accend&&b.push(d);}if(0<b.length)return b;};});OIT.extend(function(a){var b=a.glob,d=a.opt,c=a.doc,f=a.document,e=a.pages,l=a.rawtext,p=a.range,h=a.util,q=a.math,m=a.display,k=a.ajax,z=a.dialog,s=a.content,t=OIT.local,v=a.view,y=[' ','\n','\r','\t'],w=['\n','\r'];a.Page=function(b,c,d){var g=document.getElementById(d);g?a.Element.call(this,g):a.Element.call(this,'div','oit-section oit-'+c+' oit-pending',d);this.prop('index',b);this.data('page',this);this._needArrange=!0;this._staticContent=!!this.firstChildElem();};var x=a.subclass(a.Page,a.Element);
x.processData=function(b){var c=this.isEmailHeader(),d={},g=!1,f=!1,h;for(h in b){var n=b[h],k=null,l=!1;switch(h){case 'embeds':case 'frames':k='_'+h;break;case 'data':case 'src':k='_'+h+'URL';break;case 'section':case 'name':case 'type':case 'dpi':case 'autodpi':case 'hiddenFromSlideshow':k=h;break;case 'acc':case 'accend':k=h;l=!0;break;case 'w':c||this.css('width',n);k='width';n=parseInt(n);l=!0;break;case 'h':c||this.css('height',n);k='height';n=parseInt(n);l=!0;break;case 'oid':if((n=e.overlayById(b.oid))&&
n!==this.overlay)k='overlay',f=!0;}k&&!this.hasOwnProperty(k)&&(d[k]={value:n,writable:l,enumerable:!1},g=!0);}g&&Object.defineProperties(this,d);f&&this.overlay.add(this);b.content&&!this.isLoaded()&&(!0===this.deferContent?this.deferredContent=b.content:u(this,b.content));!this._ssmodel&&b.ssdata&&(this._ssmodel=new a.SpreadsheetModel(b.ssdata,this._embeds,this));this._staticContent&&F(this,!1);};var u=function(a,d){var g=c.create('div');g.html(d);var f=g.byClass('oit-view');if(f&&0<f.length)for(g=
0;g<f.length;g++){var h=f[g].byClass('oit-section');if(h)for(var k=0;k<h.length;k++){var n=h[k],l=e.pageById(n.id);l&&!l.firstChildElem()&&(b.baseURL&&I(n),l.transferFrom(n),l.addClasses(n.attr('class')));}}else b.baseURL&&I(g),a.transferFrom(g),a._needArrange=!0;};x.destroy=function(){this.unload();a.Element.prototype.destroy.call(this);};x.unload=function(){var a=this.isLoaded();OIT.highlights.pageTryReset();this.abortLoad();this._needArrange=!0;this._selRect&&(this._selRect.destroy(),delete this._selRect);
0<this.loadedSize&&(this._ssmodel&&(this._ssmodel.unload(),delete this._ssmodel),this._spanMap&&(this._spanMap.destroy(),delete this._spanMap),this.pageLayoutChanged(),this.html(''),this.addClass('oit-pending'),this.loadedSize=0);this.logUnload&&this.logUnload();a&&e.on.pageunload.dispatch(this);};x.show=function(a){if(this.isHidden()){a=a||{};this.finishAnimation();var b;if(!a.insertLast)for(var c=this.index+1;;c++){var d=e.page(c);if(!d||d.overlay!==this.overlay)break;if(!d.isHidden()){b=d;break;}}this.css('opacity',
0);b?this.overlay.insert(this,b):this.overlay.append(this);void 0===a.time&&(a.time=a.animate?150:0);a.opacity=1;this.animate(a);}return this;};x.hide=function(){var a=c.unwrap(this).parentNode;a&&(this.finishAnimation(),a.removeChild(this.dom));return this;};x.isHidden=function(){return this._hidden||!this.parent()||!this.overlay||this.overlay.isHidden();};x.filter=function(a){return a!==this.index;};x.info=function(){var b={page:this.index,type:this.type,features:a.fmt.features(this.type)};'slide'==
this.type&&(void 0!==document.getElementById(this.id+'.note')?b.notes=!0:b.notes=!1);void 0!=this.hiddenFromSlideshow&&(b.hiddenFromSlideshow=this.hiddenFromSlideshow);void 0!==this.acc&&(b.acc=this.acc,void 0!==this.accend&&(b.accend=this.accend));this.width&&this.height&&(b.width=this.width,b.height=this.height);return b;};x.features=function(){return a.fmt.features(this.type);};x.isEmailHeader=function(){return this.hasClass('oit-emailheaderpage')||'emailheader'===this.id||'emailheader.1'===this.id;};
x.isPending=function(){return this.hasClass('oit-pending');};x.isLoading=function(){return this.hasClass('oit-loading');};x.isLoaded=function(){return!this.hasClass('oit-pending')&&!this.hasClass('oit-loading');};x.isEnabled=function(){return'slideshow'!=d.presentationMode?!0:'slide'!=this.type||!this.hiddenFromSlideshow;};x.mapPointToText=function(a,b,c){!0==this.bNotesBar&&(b=this.toNotesBarY(b));var d,e=g(this);e&&(d=e.mapPointToSpan(a,b,c));if(d){var f=d.textAngle(),h=d.spanRect(this);c=h.left;var e=
h.top,n=h.right,h=h.bottom;if(0!=f){var k=[{x:c,y:e},{x:n,y:e},{x:n,y:h},{x:c,y:h}];q.rotatePoints(k,{x:a,y:b},f);c=n=k[0].x;e=h=k[0].y;for(f=1;4>f;f++){var l=k[f];l.x<c?c=l.x:l.x>n&&(n=l.x);l.y<e?e=l.y:l.y>h&&(h=l.y);}}d=d.findClosestChar(a,b,this);d.overlaps=a>=c-2&&a<=n+2&&b>=e-2&&b<=h+2;return d;}};x.findTextBoundary=function(a,b,c){a=p.accFromNode(a);if(l&&void 0!==a){a+=b;c='line'===c?w:y;b=l.findBoundaryStart(a,c);c=l.findBoundaryEnd(b,c);b=p.textRange(b,c);if(this._frames){var d,g;for(c=0;c<
this._frames.length;c++){var e=this._frames[c];a>=e.acc&&a<e.accend&&(void 0==d?(d=e.acc,g=e.accend):(e.acc<d&&(d=e.acc),e.accend>g&&(g=e.accend)));}b.acc<d&&(b.acc=d);b.accend>g&&(b.accend=g);}if(d=this.findTextRange(b))return p.consolidateDOMRanges(d);}};x.resetCache=function(){delete this._cachedRects;};var B=function(a){var c=a._cachedRects;c||(c=a._cachedRects={});var g=b.viewNode,e=g.clientWidth,f=g.clientHeight,h=g.scroll(),g=h.left,h=h.top,n=a.offsetLeft;a=a.offsetTop;var k=d.zoom,l=d.rotation;
if(c.viewWidth!=e||c.viewHeight!=f||c.scrollLeft!=g||c.scrollTop!=h||c.offsetLeft!=n||c.offsetTop!=a||c.zoom!=k||c.rotation!=l)c.view=null,c.overlay=null,c.pos=null,c.viewWidth=e,c.viewHeight=f,c.scrollLeft=g,c.scrollTop=h,c.offsetLeft=n,c.offsetTop=a,c.zoom=k,c.rotation=l;return c;};x.pageRect=function(a){var b=B(this);if('view'===a||'overlay'===a){var c=b[a];c||(c=m.pageRect(this.index,a),b[a]=c);return c;}b.page||(b.page=m.pageRect(this.index,this));return b.page;};x.pagePos=function(a){if('overlay'===
a)return a=B(this),a.pos||(a.pos=this.pos(this.overlay)),a.pos;if('view'===a){a=this.pagePos('overlay');var b=m.padding(),c=m.scrollOffset();return{left:a.left+b.left-c.left,top:a.top+b.top-c.top};}};x.containsRange=function(a){if('text'!==a.type)return a.page==this.index;if(a.acc<=this.accend&&a.accend>=this.acc)switch(this.type){case 'worksheet':case 'database':var b=this.spreadsheetModel();return b&&!b.hasPendingContent()?b.containsRange(a.acc,a.accend):!0;default:if(this._frames)for(b=0;b<this._frames.length;b++){var c=
this._frames[b];if(a.acc<=c.accend&&a.accend>=c.acc)return!0;}if(this.isLoaded()){if(a.acc===a.accend)return!!this.findACC(a.acc);b=this.findRange(a.acc,a.accend);if(void 0!==b&&0<b.length)return!0==b[0].bSlideNote&&(a.bSlideNote=!0),!0;}else return!0;}return!1;};var n=function(a,b){return a.acc-b.acc;},A=function(a,b){if(b&&0<b.length){b.sort(n);for(var c=[],d,g=a.isEmailHeader(),e=0;e<b.length;e++){var f=b[e];void 0!==f.acc&&(!g&&d&&d.accend+1>=f.acc?f.accend>d.accend&&(d.accend=f.accend):(d=p.textRange(f.acc,
f.accend),c.push(d)));}return c;}};x.mapRectRangeToText=function(b){if('rect'===b.type){var c=g(this);if(c)return b=new a.Rectangle(b,this),A(this,c.findOverlappingText(b));}};x.textRanges=function(){var a=g(this);if(a)return A(this,a.textRanges());};x.mapRangeToEmbeds=function(a){var b;if(this._embeds&&('rect'===a.type||'cell'===a.type))if(a=m.rangeRect(a,this))for(var c=0;c<this._embeds.length;c++){var d=this._embeds[c],g=this.embeddingRect(d.uid);if(g&&g.overlaps(a)){var e=g.left,f=g.top;g.intersect(a);
g.offset(-e,-f);b||(b=[]);d=p.rectRange(d.uid,this.index,g.left,g.top,g.right,g.bottom);p.convert(d,'pct');b.push(d);}}return b;};x.embeddingRect=function(b){if(this._embeds&&(b=h.byProperty(this._embeds,'uid',b))){var d;if(b.position)d=b.position,d=new a.Rectangle(d.left,d.top,d.right,d.bottom,this);else{var g=b.x,f=b.y;if(void 0==g||void 0==f){var n=c.byId(b.id);n&&(n=e.elementRect(n,this),void 0==g&&(g=n.left),void 0==f&&(f=n.top));}void 0!=g&&void 0!=f&&(d=new a.Rectangle(g,f,g+b.w,f+b.h,this));}return d;}};
x.textBoundingRect=function(a){if(this.isLoaded()&&'text'===a.type){var b;if(this.isSpreadsheet())e.activeOverlay()==this.overlay&&(b=m.rangeRect(a,this));else{var c=this.findRange(a.acc,a.accend);if(c&&0<c.length){var d=this.isHidden();d&&this.show();b=c[0];b=c[0].textRect(a,this);for(var g=1;g<c.length;g++){var f=c[g].textRect(a,this);f&&b.union(f);}!b&&1==c.length&&(b=c[0],a=p.clone(a),a.accend==b.acc&&a.accend++,b=c[0].textRect(a,this));d&&this.hide();}}return b;}};x.textRects=function(b,c){var d=
this;if('text'===b.type){var g;if(d.isSpreadsheet()){if(e.activeOverlay()==this.overlay){var f=m.rangeRect(b,c);f&&(g=[new a.RectangleSet(f)]);}}else{var n=d.findRange(b.acc,b.accend);if(n&&0<n.length){n.sort(function(a,b){var c=a.spanRect(d),g=b.spanRect(d),e=c.top-g.top;e||(e=c.left-g.left);return e;});var k=this.isHidden();k&&this.show();for(var l=[],r=0;r<n.length;r++){var u=n[r].textRect(b,this);u&&(f&&q.approxEqual(u.top,f.top)&&q.approxEqual(u.bottom,f.bottom)&&u.left<=f.right+1?f.union(u):(f=
u,l.push(f)));}k&&this.hide();if(0<l.length){g=[];n=new a.RectangleSet(l[0]);g.push(n);for(r=1;r<l.length;r++)if(k=l[r],8>k.width||8>k.height)n.add(k);else{for(var u=k.left-5,A=k.right+5,C=k.top-2,p=k.bottom+2,F=n.length-1;0<=F;F--)if(f=n.item(F),A>=f.left&&u<=f.right&&p>=f.top&&C<=f.bottom){n.add(k);k=null;break;}k&&(n=new a.RectangleSet(k),g.push(n));}}}}g&&('overlay'===c||'view'===c)&&h.each(g,'convert',null,c);return g;}};x.accRect=function(a,b){var c,d=p.textRange(a,a+1);if(this.isSpreadsheet())c=
m.rangeRect(d,b);else{var g=this.findACC(a);if(g&&0<g.length){var e=this.isHidden();e&&this.show();c=g[0].textRect(d,this);for(var f=1;f<g.length;f++){var h=g[f].textRect(d,this);c.union(h);}c.origin=b;e&&this.hide();}}return c;};x.findTextRange=function(a){if('text'===a.type&&a.acc<=this.accend&&a.accend>=this.acc&&this.isLoaded()){var b=[],c=!1;if(!this._frames||'email'===this.type)c=!0;else for(var g=0;g<this._frames.length;g++){var f=this._frames[g];if(a.acc<=f.accend&&a.accend>=f.acc)if((f=document.getElementById(f.id))&&
0==f.childNodes.length){var n=document.createRange();n.setStart(f,0);n.setEnd(f,0);b.push(n);}else c=!0;}if(c&&(c=a.acc===a.accend?this.findACC(a.acc):this.findRange(a.acc,a.accend))){if(void 0!==c[0].bSlideNote&&(d.showSlideNotes=!0,g=e.notesBar()))g=g.extractMatchingSpanInfos(c),0<g.length&&(c=g);h.each(c,'findTextRange',null,a,b);}if(0<b.length)return b;}};x.layer=function(a){if(this.overlay)return this.selectionRect(),this.overlay.layer(a);};x.hasSelectionRect=function(){return!!this._selRect;};x.selectionRect=
function(){if(!this._selRect){var b=this.overlay?this.overlay.layer('selection'):void 0;this._selRect=new a.DrawingRect(this.index,b,'oit-sel-rect');}return this._selRect;};x.showSelectionRect=function(a){this._selRect&&this._selRect.show(a);};x.findRange=function(a,b){var c=g(this);if(c)return c.findRange(a,b);};x.findACC=function(a){var b=g(this);if(b)return b.findACC(a);};x.pageLayoutChanged=function(){delete this._cachedRects;this._spanMap&&this._spanMap.discardLayout();};x.isSpreadsheet=function(){return this._ssmodel||
this._dataURL;};x.spreadsheetModel=function(){return this._ssmodel;};var g=function(b){void 0===b._spanMap&&b.isLoaded()&&(b.isSpreadsheet()?b._spanMap=null:b._spanMap=new a.SpanMap(b));return b._spanMap;},r=function(a){if(a.showProgressDialog&&void 0!==a.srcSize&&void 0!==a.dataSize){var b=a.srcSize+a.dataSize;262144<=b&&(b=100*(a.srcLoaded+a.dataLoaded)/b,a.progressDialog||(a.progressDialog=z.createProgressDialog(t.PLEASE_WAIT_INITIALIZING,!0)),a.progressDialog&&a.progressDialog.update(b));}},C=function(a){void 0===
a.srcRequest&&(void 0===a.dataRequest&&a.isLoading())&&(a.logLoad&&a.logLoad(),a.removeClass('oit-loading'),a.pageLayoutChanged(),a.loadedSize=0,a.dataSize&&(a.loadedSize+=a.dataSize),a.srcSize&&(a.loadedSize+=a.srcSize),e.applyMemoryLimit(a.loadedSize),a.deferredContent&&(u(a,a.deferredContent),delete a.deferredContent,delete a.deferContent),F(a,!0),a.progressDialog&&(a.progressDialog.hide(),delete a.progressDialog),delete a.showProgressDialog,a.completionFunc&&(a.completionFunc(a),delete a.completionFunc),
delete a.locked);},F=function(a,b){var c=v.info();if(c&&1557===c.fi){var d=(c=a.firstChildElem())?c.firstChildElem():null,g=d?d.nextSiblingElem():null,h=g?g.nextSiblingElem():null,n=h?h.nextSiblingElem():null,k=d?d.firstChildElem():null,l=k?k.firstChildElem():null,r=g?g.firstChildElem():null,u=h?h.firstChildElem():null,A=u?u.firstChildElem():null,m=A?A.firstChildElem():null,C=m?m.firstChildElem():null;l&&(!l.nextSiblingElem()&&r&&!r.nextSiblingElem()&&C&&!C.nextSiblingElem())&&('DIV'==c.tagName&&c.hasClass('oit-svg')&&
'DIV'==d.tagName&&d.hasClass('oit-svg-layer')&&'DIV'==g.tagName&&g.hasClass('oit-frame')&&'DIV'==h.tagName&&h.hasClass('oit-svg-layer')&&'svg'==k.tagName&&'rect'==l.tagName&&'DIV'==r.tagName&&r.hasClass('oit-svg-text')&&'svg'==u.tagName&&'g'==A.tagName&&A.hasClass('oit-pagescale')&&'g'==m.tagName&&m.hasClass('oit-framescale')&&'image'==C.tagName&&!n)&&(d='#'+a.id.replace('.','\\.')+' .oit-svg-text',f.screenCSS(d+' div','color:rgba(0,0,0,0);'),f.screenCSS(d+' span','color:rgba(0,0,0,0);'),c.append(g));}e.on.pageload.dispatch(a,
!!b);},I=function(a){a=c.wrap(a);if(b.baseURL){a=a.createTreeWalker(NodeFilter.SHOW_ELEMENT);for(var d;d=a.nextNode();)if('IMG'===d.tagName){var g=d.getAttribute('src');g&&('/'!=g.charAt(0)&&(g=h.concatURL(b.baseURL,g)),d.setAttribute('src',g));}else if('image'===d.tagName&&(g=d.getAttribute('xlink:href')))'/'!=g.charAt(0)&&(g=h.concatURL(b.baseURL,g)),d.setAttribute('xlink:href',g);}};x.abortLoad=function(){this.isLoading()&&(this.srcRequest&&(k.abort(this.srcRequest),delete this.srcRequest),this.dataRequest&&
(k.abort(this.dataRequest),delete this.dataRequest),this.removeClass('oit-loading'),this.addClass('oit-pending'));};x.load=function(a,c,d){!1===a&&this.abortLoad();var g=this.isPending();g&&(this._srcURL||this._dataURL)?(this.srcLoaded=this.srcSize=this.dataLoaded=this.dataSize=0,this.completionFunc=d,this.removeClass('oit-pending'),this.addClass('oit-loading'),this.locked=!0,!0===c&&(this.showProgressDialog=!0),c=b.baseURL,this._dataURL&&(d=this._dataURL,c&&'/'!=d.charAt(0)&&(d=h.concatURL(c,d)),
this.dataRequest=k.start({url:d,async:a,context:this,loading:J,complete:L})),this._srcURL&&(d=this._srcURL,c&&'/'!=d.charAt(0)&&(d=h.concatURL(c,d)),this.srcRequest=k.start({url:d,async:a,context:this,loading:E,complete:D}))):(g&&(this.removeClass('oit-pending'),F(this,!1)),d&&d());};var J=function(a,b,c){this.dataSize=b;c&&(this.dataLoaded=c.length);r(this);},L=function(a,b,c,d){c&&(this.dataLoaded=c.length,r(this));if(200===d)try{var g=JSON.parse(c);this.processData({ssdata:g});}catch(e){this.logFatalError(null,
'Corrupt data from server: '+a);}else this.logFatalError(null,'Failed to load resource from server (Error '+d+'): '+a);delete this.dataRequest;C(this);},E=function(a,b,c){this.srcSize=b;c&&(this.srcLoaded=c.length);r(this);},D=function(a,b,c,d){c&&(this.srcLoaded=c.length,r(this));200===d?(this.deferContent=!0,s.isICD(c)?s.processContentData(c):this.processData({content:c})):this.logFatalError(null,'Failed to load resource from server (Error '+d+'): '+a);delete this.srcRequest;C(this);};});OIT.extend(function(a){var b=a.glob,d=a.opt,c=a.pages,f=a.dialog,e=a.util;a.Overlay=function(c,d){var e={index:{value:c},length:{get:function(){return this.firstPage?this.lastPage.index-this.firstPage.index+1:0;}}};d.name&&(e.name={value:d.name});Object.defineProperties(this,e);(e=document.getElementById(d.oid))?a.Element.call(this,e):(e='oit-overlay',d.cls&&(e=-1==d.cls.indexOf(e)?e+(' '+d.cls):d.cls),a.Element.call(this,'article',e,d.oid));b.viewNode.append(this);};var l=a.subclass(a.Overlay,a.Element);
l.updateCSS=function(){'text'===d.selectionMode&&!f.modalOverlayVisible()?this.removeClass('oit-unselectable'):this.addClass('oit-unselectable');'rect'===d.selectionMode?this.css('cursor','crosshair'):this.css('cursor',null);};l.item=function(a){if(this.firstPage)return c.page(this.firstPage.index+a);};l.add=function(a){this.append(a);this.firstPage||(this.firstPage=a);this.lastPage=a;if(!this.maxWidth||a.width>this.maxWidth)this.maxWidth=a.width;if(!this.maxHeight||a.height>this.maxHeight)this.maxHeight=
a.height;this._pagesHidden&&a.hide();};l.containsPage=function(a){return c.page(a).overlay==this;};l.show=function(){this.css('display','block');this.layers&&e.eachSparse(this.layers,'show');this.updateCSS();};l.hide=function(){this.layers&&e.eachSparse(this.layers,'hide');this.css('display',null);};l.isHidden=function(){return'block'!==this.css('display');};l.showPages=function(a){this.each('show',a);this._pagesHidden=!1;};l.hidePages=function(a){this.each('hide',a);this._pagesHidden=!0;};l.each=function(a,
b){e.eachArgs(this,arguments);};l.layer=function(c){var d;this.layers&&(d=this.layers[c]);d||(d=new a.DrawingLayer(b.drawing,c,this.id+'.'+c),this.layers||(this.layers={}),this.layers[c]=d);return d;};});OIT.extend(function(a){var b=a.doc,d=a.range,c=a.pages,f=a.css,e=a.highlights,l=a.display,p=a.stylemap,h=a.util,q=a.view;a.Highlight=function(a,b){this.id=a;this.range=d.clone(b.range);this.range.bSlideNote=b.range.bSlideNote;this.type=b.type;b.style&&(this._style=b.style);b.cls&&(this._class=b.cls);b.comment&&(this._comment=b.comment);b.label&&(this._label=b.label);b.properties&&(this._properties=b.properties);b.options&&this.setOptions(b.options);if(b.compound&&(this._compound=!0,Array.isArray(b.compound))){this._cRanges=
[];for(var c=0;c<b.compound.length;c++){var g=d.clone(b.compound[c]);'rect'===g.type&&d.convert(g,'px');this._cRanges.push(g);}}this._pageInfo=[];'rect'===this.range.type&&(void 0!==this.range.embedId?d.convert(this.range,'pct'):d.convert(this.range,'px'));this.range=d.validateRange(this.range,!0);e.map(this);};var m=a.subclass(a.Highlight);m.isNote=function(){return!1;};m.isRedaction=function(){return!1;};m.isCompoundRedaction=function(){return!1;};m.isEmptyRedaction=function(){return!1;};m.setRange=function(a){return void 0!==
a&&0!=d.compare(a,this.range)?('cell'==this.range.type&&this.eachPage(function(a,b){I(b,c.page(a.index));},null,this),e.unmap(this),this.range=d.clone(a),e.map(this),delete this._cRanges,'text'==a.type&&this._compound&&(this._cRanges=[a]),this.updateStyle(),e.alignHighlight(),e.on.move.dispatch(this),!0):!1;};m.updateStyle=function(){this._hidden||this.eachPage(k,null,this);};var k=function(a,b){var c=a.index;b.removeFromPage(a);b.addToPage(c);};m.filter=function(b){if(b){if('string'===typeof b)return this[b]();
if(b instanceof a.Page)return this.isOnPage(b.index);if(!b(this.id,this._properties))return!1;}return!0;};m.properties=function(a){void 0!==a&&(this._properties=a);return this._properties;};m.property=function(a,b){void 0!==b&&(this._properties||(this._properties={}),this._properties[a]=b);if(this._properties)return this._properties[a];};m.style=function(a){a&&(this._style=a,this.updateStyle());return this._style;};m.fillStyle=function(){if('text'!==this.range.type)return this._style;};m.css=function(a){return f.get(this._style,
a);};m.matches=function(a,b,c,g,e){return this._style===a&&0==d.compare(this.range,b)&&this._properties===c&&this._comment===g&&this._label===e;};var z=function(a,b){b&&b.autodpi?d.convert(a,'pct'):b&&'bitmap'===b.type?d.convert(a,'px'):d.convert(a,'tw');};m.serialize=function(){var a={type:this.type};a.range=d.clone(this.range);if('rect'===a.range.type)if(void 0!==a.range.embedId)d.convert(a.range,'pct');else{var b=c.page(a.range.page);z(a.range,b);}if(this.ttrects){var g=[],e;for(e in this.ttrects){var f=
this.ttrects[e];if(f)for(var b=c.page(e),h=0;h<f.length&&void 0!=f[h];h++){var n=f[h].toRange(b);z(n,b);g.push(n);}}a.ttrects=[].concat.apply([],g);}this._style&&(a.style=this._style);this._properties&&(a.properties=this._properties);'string'===typeof this._comment&&(a.comment=this._comment);this._label&&(a.label=this._label);this._options&&(a.options=this._options);if(this._cRanges){a.compound=[];for(b=0;b<this._cRanges.length;b++)n=d.clone(this._cRanges[b]),'rect'===n.type&&(void 0!==n.embedId?d.convert(n,
'pct'):d.convert(n,'tw')),a.compound.push(n);}return a;};m.destroy=function(){this.destroyDialog();this.eachPage(s,null,this);e.unlink(this);this.deleteAll();};var s=function(a,b){b.removeFromPage(a);};m.getOption=function(a){if('text'==this.range.type){if('enableUserMove'===a)return!1;if('enableUserResize'===a)for(var b in this._pageInfo){if(c.page(Number(b)).isSpreadsheet())return!1;break;}}return(b=this._options)&&void 0!==b[a]?b[a]:!0;};m.setOptions=function(a){if(a&&(J(this,'enableUserDelete',a,!0),
J(this,'enableUserComment',a,!0),J(this,'enableUserResize',a,!0),'text'!==this.range.type&&J(this,'enableUserMove',a,!0),a=this._options)){var b=!1,c;for(c in a)if(a.hasOwnProperty(c)){b=!0;break;}b||delete this._options;}};m.comment=function(a){void 0!==a&&(this._comment=null===a?void 0:String(a),this.updateComment(void 0,this._comment));return this._comment;};m.dialog=function(b){var c=this._dialog;c?(c.abortAnimation(),c.show(!0)):c=this._dialog=new a.CommentDialog(this);c.loadComment();c.setMode(b);
c.align();return c;};m.alignDialog=function(a){this._dialog&&this._dialog.align(a);};m.hideDialog=function(){var a=this._dialog;a&&a.show(!1,{endFn:a.close,context:a});};m.exitDialog=function(){this._dialog&&this._dialog.exit();};m.destroyDialog=function(){this._dialog&&this._dialog.destroy();};m.onDialogDestroy=function(a){a===this._dialog&&delete this._dialog;};m.label=function(a){void 0!==a&&(this._label=null===a||''===a?void 0:String(a),this.eachPage(t,null,this));return this._label;};var t=function(a,
b){b.applyLabel(a);};m.showLabel=function(a){this._label&&(!1===a?this._labelVisible=!1:delete this._labelVisible,this.eachPage(t,null,this));};m.isOnPage=function(a){return!!this._pageInfo[a];};m.createPageInfo=function(a){var b=this._pageInfo[a];b||(this._pageInfo[a]=b={index:a});return b;};m.eachPage=function(a,b){h.eachSparseArgs(this._pageInfo,arguments);};m.activate=function(a){this._hidden&&(this.show(),this._autohide=!0,l.update());this._active=!0;this.eachPage(v,null,this);this.positionAll();};
var v=function(a,b){if(a.drawingRect){var c=a.drawingRect;b.oldFocusPage=void 0;c.addClass('oit-highlight-active');if('text'===b.range.type)c.setRange(b.range),b.getOption('enableUserResize')?c.ontextmove(b,y).ontextmoveend(b,x).showTextHandles():c.offtextmove(y).offtextmoveend(x).hideTextHandles();else{var d='cell'!==b.range.type;b.updateMoveable(!0,c);b.updateResizable({bindToObject:d,minWidth:10,minHeight:10},c);}c.activate();}a.embedRect&&a.embedRect.show();};m.updateMoveable=function(a,b,c){c=c||
b;if(!1!==a&&this.getOption('enableUserMove'))b.addClass('oit-moveable').on('dragstart',this,M,c).on('dragmove',this,P,c).on('dragend',this,O,c).on('dragcancel',this,R,c).on('click',this,K,c).on('tap',this,H,c);else b.removeClass('oit-moveable').offdragstart(M).offdragmove(P).offdragend(O).offdragcancel(R).offclick(K).offtap(H);};m.updateResizable=function(a,b,c){c=c||b;if(a&&this.getOption('enableUserResize'))c.resizable(!0,a).onresizemove(this,Q).onresizeend(this,V);else c.resizable(!1).offresizemove(Q).offresizeend(V);};
var y=function(a){var b=a.range;a=a.page;var d=c.pagesForRange(b);a!=this.oldFocusPage&&(this.oldFocusPage=a,this.eachPage(w,null,d,this));this._pageInfo[a.index]||this.addToPage(a.index,!0);this._cRanges&&(this._cRanges=[b]);F(this,a,this.style(),b);this.alignDialog({animate:!1});},w=function(a,b,d){a.spanList&&(a=a.index,h.byProperty(b,'index',a)||I(d,c.page(a)));},x=function(a){this.setRange(a.range);};m.deactivate=function(){this._active&&(delete this._active,this.eachPage(u,null,this),this._autohide&&
(this.hide(),delete this._autohide,l.update()));};var u=function(a,b){var c=a.drawingRect;c&&(c.removeClass('oit-highlight-active').deactivate(),'text'!==b.range.type&&(b.updateMoveable(!1,c),b.updateResizable(!1,c)));a.embedRect&&a.embedRect.hide();};m.show=function(){if(this._hidden){var a=this._hidden;delete this._hidden;for(var b=0;b<a.length;b++)this.addToPage(a[b]);}delete this._autohide;};m.hide=function(){this._hidden||(this._hidden=[],this.eachPage(B,null,this));};var B=function(a,b){b._hidden.push(a.index);
b.removeFromPage(a);};m.collapse=function(){};m.isHidden=function(){return this._hidden||this._autohide;};var n=function(a,b,d){!0==a.range.bSlideNote&&(b=c.notesBar());if(b)return'overlay'!==d&&'view'!==d&&(d=b),'text'===a.range.type&&(b=b.textBoundingRect(a.range))?(b.origin=d,b):l.rangeRect(a.range,d);};m.boundingRectList=function(a){var b=[];this.eachPage(A,null,a,b,this);if(0<b.length)return b;};var A=function(a,b,d,g){(a=n(g,c.page(a.index),b))&&d.push(a);};m.addToDocument=function(){var a=c.pagesForRange(this.range);
if(a){for(var b=0;b<a.length;b++)this.addToPage(a[b].index);e.link(this);}};var g=function(a){a.highlightLayer||(r(a),a.highlightLayer=a.layer('highlights'));return a.highlightLayer;},r=function(a){a.compoundHighlightLayer||(a.compoundHighlightLayer=a.layer('chighlights'));return a.compoundHighlightLayer;};m.addToPage=function(d,f){var h=c.page(d),k=this._pageInfo[d];if(!this._hidden&&(!k||k.needRect)&&h&&h.isLoaded()&&(f||h.containsRange(this.range))){var k=F(this,h,this.style(),this.range),r=n(this,
h,'overlay');r?(k?delete k.needRect:k=this.createPageInfo(d),void 0!==this.range.embedId&&!k.embedRect&&(k.embedRect=new a.DrawingRect(d,g(h)),k.embedRect.addClass('oit-highlight-embed'),k.embedRect.hide()),k.drawingRect||(!0==this.range.bSlideNote?(h=c.notesBar(),h.highlightLayer||(h.highlightLayer=h.makeHighlightLayer('highlights')),k.drawingRect=this.createDrawingRect(h.index,h.highlightLayer),k.drawingRect._page=h,k.drawingRect._pos.convert('view')):k.drawingRect=this.createDrawingRect(h.index,
g(h)),e.on.addElement(k.drawingRect,this)),(h=this.fillStyle())?(k.styleDiv||(k.styleDiv=b.create('div','oit-highlight-style'),k.drawingRect.append(k.styleDiv)),k.styleDiv.attr('style',h)):k.styleDiv&&(k.styleDiv.destroy(),delete k.styleDiv),this._label&&this.applyLabel(k),C(this._pageInfo[d],this,r),this.updateComment(k,this._comment)):k&&(k.needRect=!0);e.link(this,r);l.update(!1,!0);}};m.removeFromPage=function(a){'number'==typeof a&&(a=this._pageInfo[a]);if(a){var b=a.index;I(this,c.page(b));a.commentFlag&&
(a.commentFlag.destroy(),delete a.commentFlag);a.drawingRect&&(e.on.removeElement(a.drawingRect),a.drawingRect.destroy());a.embedRect&&a.embedRect.destroy();this._pageInfo[b]=null;l.update(!1,!0);}};m.createDrawingRect=function(b,c){var d;'text'===this.range.type?(d=new a.TextRect(b,c),d.setRange(this.range)):d=new a.DrawingRect(b,c);return d;};m.distanceFromPoint=function(a,b,d){var g,e=c.page(a);if(a=this._pageInfo[a])if(a.spanList){if(e=e.textRects(this.range))for(a=0;a<e.length;a++)for(var f=e[a],
h=0;h<f.length;h++){var k=f.item(h).distanceFrom(b,d);if(void 0===g||Math.abs(k)<Math.abs(g))if(g=k,0===g)break;}}else(e=n(this,e))&&(g=e.distanceFrom(b,d));return g;};var C=function(a,b,d){if(a){var g=a.index,e;e=!0==b.range.bSlideNote?c.notesBar():c.page(g);if(e.isHidden()||!e.isEnabled()){a.drawingRect&&a.drawingRect.hide();a.embedRect&&a.embedRect.hide();if(a.cRects)for(d=0;d<a.cRects.length;d++)a.cRects[d].rect.hide();a.needRect=!0;}else if('text'===b.range.type)a.drawingRect&&a.drawingRect.show().changed();
else if(d||(d=n(b,e,'overlay')),d){a.drawingRect&&a.drawingRect.show().move(d.left,d.top,d.width,d.height);if(a.embedRect&&(g=c.page(g).embeddingRect(b.range.embedId)))g.origin='overlay',a.embedRect.move(g.left,g.top,g.width,g.height);if(a.cRects)for(d=0;d<a.cRects.length;d++)e=a.cRects[d],(g=l.rangeRect(e.range,'overlay'))&&e.rect.show().move(g.left,g.top,g.width,g.height);b.updateComment(a,b._comment);}}};m.positionAll=function(){this.eachPage(C,null,this);};m.generateKey=function(a){var b=c.forRange(this.range,
0);if(b&&void 0===this.prevId&&void 0===this.nextId)return this.key&&this.key.page!=b.index&&delete this.key,this.key||(this.key={page:b.index,x:0,y:0}),b.isEmailHeader()&&'text'===this.range.type?this.key.x=this.range.acc:(a||(a=n(this,b)),a&&(this.key.x=a.left,this.key.y=a.top)),this.key;delete this.key;};m.applyLabel=function(a){if(a&&a.drawingRect)if(!this._label||!1===this._labelVisible)a.drawingRect.setLabel(null);else{var b=this.css('background-color'),c;a:{if(b&&(c=f.stringToColor(b))){c.r=
255-c.r;c.g=255-c.g;c.b=255-c.b;c=f.colorToString(c.r,c.g,c.b);break a;}c=void 0;}c||(b=null);a.drawingRect.setLabel(this._label,c,b);}};var F=function(d,g,e,h){var k=!1;I(d,g);if(d._compound){if(d._cRanges||(d._cRanges=c.decomposeRange(h,!0)),d._cRanges){var k=!0,n=g.spreadsheetModel();n&&n.addHighlight(d);var u=d._pageInfo[g.index];u||(u=d.createPageInfo(g.index));for(var A='rect'===h.type,m,C,n=0;n<d._cRanges.length;n++){var F=d._cRanges[n];if('text'===F.type){if(C||(C=f.parse(e)),C&&!g.isSpreadsheet()){var B=
p.applyStyle(g,F,C,d.id);B&&(u.compoundSpanList||(u.compoundSpanList=[]),u.compoundSpanList.push(B));}}else if(B=l.rangeRect(F,'overlay')){var s=new a.DrawingRect(g.index,r(g));if(e){var w=b.create('div','oit-highlight-style');w.attr('style',e);s.append(w);}s.move(B.left,B.top,B.width,B.height);u.cRects||(u.cRects=[]);u.cRects.push({range:F,rect:s});}A&&(F='text'===h.type?g.textBoundingRect(F):l.rangeRect(F,g))&&(m?m.union(F):m=F);}if(m&&(h=l.rangeFromRect(g.index,m.left,m.top,m.right,m.bottom,g,'highlight')))d.range=
h;}}else if('text'===h.type)if(n=g.spreadsheetModel())k=n.addHighlight(d);else if(C=f.parse(e))if(B=p.applyStyle(g,h,C,d.id)){u||(u=d.createPageInfo(g.index));u.spanList=B;if((k=q.info())&&1557===k.fi){d.ttrects||(d.ttrects=[]);k=d.ttrects[g.index]=[];for(n=0;n<B.length;n++)B[n].hasClass('oit-tt')&&k.push(B[n].textRect(h,g));}k=!0;}if(k)return d.createPageInfo(g.index);},I=function(a,b){var c=a._pageInfo[b.index];if(c){var d=b.spreadsheetModel();d&&('text'===a.range.type||a._compound)&&d.removeHighlight(a);
c.spanList&&(p.removeStyle(c.spanList,a.id),delete c.spanList);c.compoundSpanList&&(h.each(c.compoundSpanList,p.removeStyle,null,a.id),delete c.compoundSpanList);if(c.cRects){for(d=0;d<c.cRects.length;d++){var g=c.cRects[d].rect;g&&(e.on.removeElement(g),g.destroy());}delete c.cRects;}}},J=function(a,b,c,d){var g=!1;c=c[b];if(void 0!==c)if(c==d){if((c=a._options)&&void 0!==c[b])delete c[b],g=!0,a.optionChanged(b);}else a._options||(a._options={}),a._options[b]=!!c,g=!0,a.optionChanged(b);return g;};m.optionChanged=
function(a){switch(a){case 'enableUserMove':case 'enableUserResize':this.id===e.active()&&this.activate(!0);}};var L=function(a,b,c){c.updateComment(a,b);};m.updateComment=function(b,c){b?b.drawingRect&&(c?(b.commentFlag||(b.drawingRect.onmouseenter(this,E).onmouseleave(this,D),b.commentFlag||(b.commentFlag=new a.DrawingChildObject(b.drawingRect,{hpos:'right',vpos:'top',margin:2,classList:'oit-comment-flag'}))),b.commentFlag.show()):b.commentFlag&&(b.commentFlag.destroy(),delete b.commentFlag)):this.eachPage(L,
null,c,this);};var E=function(a){this.id!=e.active()&&e.showComment(this.id);},D=function(a){this.id!=e.active()&&e.hideComment(this.id);},K=function(b,c){var d=a.glob.viewNode.mousePos(b);e.activateNearest(d.x,d.y,b,!0);},H=function(a,b){var c=a.center;e.activateNearest(c.x,c.y,a.srcEvent,!0);},M=function(a,b){if(this.getOption('enableUserMove')){var c=b.position();this._moveable={startRect:c.clone(),curRect:c.clone()};return!0;}return!1;},P=function(a,b){if(this._moveable){var c=this.range,g=this._moveable.startRect,
e=this._moveable.curRect,f=a.delta;e.left=g.left+f.x;e.top=g.top+f.y;'cell'===c.type&&!c.offsets?(this.moveOriginalRect||(this.moveOriginalRect=l.rangeRect(c,e.origin)),g=this.moveOriginalRect.clone(),g.left=e.left,g.top=e.top,e=l.rangeFromRect(c.page,g.left,g.top,g.right,g.bottom,g.origin,'move',c.embedId),g=c.c2-c.c1,f=c.r2-c.r1,e.c2-e.c1<g&&(e.c2=e.c1+g),e.r2-e.r1<f&&(e.r2=e.r1+f),delete e.offsets):e=l.rangeFromRect(c.page,e.left,e.top,e.right,e.bottom,e.origin,'move',c.embedId);0!=d.compare(e,
c)&&(e=l.rangeRect(e,'overlay'),b.move(e.left,e.top,e.width,e.height),this._active&&(this._comment&&this._dialog)&&this._dialog.align({rect:e,animate:!1}));}},O=function(a,b){if(this._moveable){var c=this.range,d=this._moveable.curRect,d=l.rangeFromRect(c.page,d.left,d.top,d.right,d.bottom,d.origin,'move',c.embedId);if('cell'===d.type&&!c.offsets){delete this.moveOriginalRect;var g=c.c2-c.c1,c=c.r2-c.r1;d.c2-d.c1<g&&(d.c2=d.c1+g);d.r2-d.r1<c&&(d.r2=d.r1+c);delete d.offsets;}this.setRange(d);delete this._moveable;}},
R=function(a,b){if(this._moveable){var c=a.center;e.activateNearest(c.x,c.y,a.srcEvent);delete this._moveable;}},Q=function(a){var b=this.range,c=a.drawingRect;a=a.newRect;var g=l.rangeFromRect(b.page,a.left,a.top,a.right,a.bottom,a.origin,'resize',b.embedId);'cell'===g.type&&!b.offsets&&delete g.offsets;if(g=d.validateRange(g,!0))b=l.rangeRect(g,'overlay'),'rect'===g.type&&(a=b),c.move(b.left,b.top,b.width,b.height);this._active&&(this._comment&&this._dialog)&&this._dialog.align({rect:a,animate:!1});},
V=function(a){var b=this.range;a=a.newRect;a=l.rangeFromRect(b.page,a.left,a.top,a.right,a.bottom,a.origin,'resize',b.embedId);'cell'===a.type&&!b.offsets&&delete a.offsets;a=d.validateRange(a,!0);this.setRange(a);};m.loadPage=function(){var a=c.forRange(this.range);a&&!a.isLoaded()&&a.load(!1);};});OIT.extend(function(a){var b=a.opt;a.Redaction=function(b,d){a.Highlight.call(this,b,d);};var d=a.subclass(a.Redaction,a.Highlight);d.isRedaction=function(){return!0;};d.isCompoundRedaction=function(){return!0===this._compound;};d.isEmptyRedaction=function(){return!0===this._compound&&!this._cRanges;};d.style=function(a){a=b.redactionColor;return'color:'+a+';background-color:'+a+';';};d.fillStyle=function(){if('text'!==this.range.type){var a;if(a=this._compound&&('rect'===this.range.type||'cell'===this.range.type)?
b.redactionFillColor:b.redactionColor)return'background-color:'+a+';';}};d.css=function(a){if('color'===a||'background-color'===a)return b.redactionColor;};});OIT.extend(function(a){var b=a.doc,d=a.glob,c=a.highlights,f=a.dialog,e=OIT.local;a.Note=function(b,c){a.Highlight.call(this,b,c);this._newNote=!0;this._state='oit-note-pinned';this._pinned=!0;this._hidden=this._hover=this._active=this._editing=!1;};var l=a.subclass(a.Note,a.Highlight);l.isNote=function(){return!0;};l.isEditing=function(){return this._editing;};l.isHidden=function(){return this._hidden;};l.removeFromPage=function(b){this.endEditText(!1);a.Highlight.prototype.removeFromPage.call(this,
b);};l.activate=function(a){if(!this._active||a)this._active=!0,this.updateState(a);};l.deactivate=function(){this._active&&(this._active=!1,this.updateState());};l.show=function(){this._hidden&&(this._hidden=!1,this.updateState());};l.hide=function(){this._hidden||(this._hidden=!0,this.updateState());};l.pin=function(){this._pinned||(this._pinned=!0,this.updateState());};l.unpin=function(){this._pinned&&(this.endEditText(!0),c.active()==this.id&&c.deactivate(),this._pinned=!1,this.updateState());};l.beginEditText=
function(a){void 0!==a&&(this._newNote=a);this._editing||(this._editing=!0,d.editingComment++,this.updateState());};l.endEditText=function(a){this._editing&&(!1===a&&(this.buttons.textArea.value=c.comment(this.id)),this._editing=!1,d.editingComment--,this.updateState(),this._newNote&&(a?delete this._newNote:c.remove(this.id)));};l.ok=function(){this.endEditText(!0);return!1;};l.cancel=function(){this.endEditText(!1);return!1;};l.optionChanged=function(a){switch(a){case 'enableUserMove':case 'enableUserResize':this.updateState(!0);}};
var p=function(){this.addClass('oit-note-expanding');},h=function(){this.removeClass('oit-note-expanding');},q=function(){this.addClass('oit-note-collapsing');},m=function(){this.removeClass('oit-note-collapsing');};l.updateState=function(a){var b;b=this._editing?'oit-note-editing':this._active?this._pinned?'oit-note-active':'oit-note-shown':this._hidden?'oit-note-hidden':this._pinned?'oit-note-pinned':this._hover?'oit-note-hover':'oit-note-iconic';var d=this.noteRect;if(d){if(b!=this._state||a){a=this._state;
this._state=b;d.removeClass(a).addClass(b);switch(a){case 'oit-note-editing':c.comment(this.id,this.buttons.textArea.value);f.showModalOverlay(!1);this.buttons.iconBar.focus();d.layer().removeClass('oit-note-layer-edit');d.removeClass('oit-highlight-active').deactivate();break;case 'oit-note-hidden':d.show();break;case 'oit-note-iconic':if('oit-note-hidden'!==b){var e=this.originalRect;d.move(e.left,e.top,e.width,e.height,{timems:200,startFn:p,endFn:h});}break;case 'oit-note-active':d.removeClass('oit-highlight-active').deactivate();
case 'oit-note-pinned':'oit-note-active'!==b&&'oit-note-pinned'!==b&&(this.updateMoveable(!1,this.buttons.iconBar,d),this.updateResizable(!1,d));}this.positionAll();switch(b){case 'oit-note-hidden':d.hide();break;case 'oit-note-iconic':this.originalRect=d.position().clone();e=this.collapsedRect={left:this.originalRect.right-20,top:this.originalRect.top,width:20,height:20};'oit-note-hidden'===a?d.move(e.left,e.top,e.width,e.height):d.move(e.left,e.top,e.width,e.height,{timems:200,startFn:q,endFn:m});
break;case 'oit-note-editing':d.layer().addClass('oit-note-layer-edit');d.addClass('oit-highlight-active').activate(!1,!0);c.activate(this.id);f.showModalOverlay(!0);b=this.buttons.textArea;b.blur();b.focus();this._newNote&&b.moveCaret(b.value.length||0);break;case 'oit-note-active':d.addClass('oit-highlight-active').activate(!1,!0);case 'oit-note-pinned':this.updateMoveable(!0,this.buttons.iconBar,d),this.updateResizable({bindToObject:'cell'!==this.range.type,minWidth:60,minHeight:45,margin:-5},
d);}}d.update();}};l.createDrawingRect=function(c,d){var f=new a.DrawingRect(c,d),h={};this.noteRect=f;this.buttons=h;f.addClass('oit-note').addClass('oit-note-pinned');h.iconBar=new a.DrawingChildObject(f,{classList:'oit-note-icons',inheritMoveable:!0});h.iconBar.attr('tabindex','-1');h.cancel=new a.DrawingChildObject(h.iconBar,{classList:'oit-note-cancel',title:e.DISCARD_CHANGES});h.cancel.onclick(this,this.cancel).ontap(this,this.cancel);h.ok=new a.DrawingChildObject(h.iconBar,{classList:'oit-note-ok',
title:e.SAVE_CHANGES});h.ok.onclick(this,this.ok).ontap(this,this.ok);h.pin=new a.DrawingChildObject(f,{classList:'oit-note-pin'});h.pin.onmouseenter(this,k).onmouseleave(this,z).onclick(this,s).ontap(this,s);h.textArea=new a.TextArea;h.textArea.onfocus(this,v).ontap(this,t);h.textForm=b.create('form');h.textForm.append(h.textArea);f.append(h.textForm);this.updateState(!0);return f;};var k=function(a){this._hover=!0;this.updateState();},z=function(a){this._hover=!1;this.updateState();},s=function(a){this._pinned?
this.unpin():this.pin();return!1;},t=function(a){this.buttons.textArea.blur();this.buttons.textArea.focus();},v=function(a){this.getOption('enableUserComment')?this.beginEditText():this.buttons.textArea.blur();},y=function(a,b,c){c.updateComment(a,b);};l.updateComment=function(a,b){a?!this._hidden&&!this._editing&&this.buttons&&(this.buttons.textArea.value=b||''):this.eachPage(y,null,b,this);};});OIT.extend(function(a){var b=a.highlights;a.Stamp=function(d,c){a.Highlight.call(this,d,c);c.name&&(this._name=c.name);c.sizing&&(this._sizing=c.sizing);c.opacity&&(this._opacity=c.opacity);if(!this._style){var f='background:url('+b.stamp(this._name).url+') no-repeat';1!=this._opacity&&(f+=';opacity:'+this._opacity);'scale'===this._sizing?f+=';background-size:contain':'stretch'===this._sizing&&(f+=';background-size:100% 100%');this._style=f;}};a.subclass(a.Stamp,a.Highlight).serialize=function(){var b=
a.Highlight.prototype.serialize.call(this);b.stamp=this._name;b.opacity=this._opacity;b.sizing=this._sizing;delete b.style;return b;};});OIT.extend(function(a){var b=a.glob,d=a.highlights,c=a.selection,f=a.css,e=200,l=150;a.CommentDialog=function(b){var c='#000',d=b.css('background-color');d&&(d=f.blendColors(d,'#FFFFFF'));if(d){var e=f.stringToColor(d);128>e.r&&(128>e.g&&128>e.b)&&(c='#FFF');}a.DialogBox.call(this,{ok:!0,cancel:!0,className:'oit-dialog-comment',resultFn:h,destroyFn:q,textColor:c,backgroundColor:d});this._highlight=b;};var p=a.subclass(a.CommentDialog,a.DialogBox),h=function(a,b){'view'!==a._mode&&(e=a.width(),l=a.height(),
'new'===a._mode&&(!b||!a._textarea.value)?(d.remove(a._highlight.id),c.select(null)):(b&&a.saveComment(),d.active()===a._highlight.id?a.setMode('view'):a._highlight.exitDialog()));},q=function(a){a.setMode(null);a._highlight.onDialogDestroy(a);};p.setMode=function(a){if(a!==this._mode){if('edit'===this._mode||'new'===this._mode)b.editingComment--,this.removeClass('oit-comment-edit');this._mode=a;switch(a){case 'view':this._highlight.comment()?(this._textarea&&(this._textarea.destroy(),delete this._textarea),
this._label||(this._label=this.addLabel(null),this._label.onclick(this,m).ontap(this,m).onmouseenter(this,k).onmouseleave(this,z)),this.resizable(!1),this.modal(!1),this.showFooter(!1),this.maxsize(e,l),this._mode=a,this.loadComment(),this.align(),this.show()):this._highlight.exitDialog();break;case 'edit':case 'new':b.editingComment++,this.addClass('oit-comment-edit'),this.modal(!0),this.align({endFn:s,context:this});}}};var m=function(){this._highlight.getOption('enableUserComment')&&this.setMode('edit');},
k=function(){d.showComment(this._highlight.id);},z=function(){var a=this._highlight.id,b=d.active();a!=b&&(d.hideComment(a),void 0!==b&&d.showComment(b));},s=function(){this.show(!0,{endFn:t,context:this});},t=function(){this._label&&(this._label.destroy(),delete this._label);this._textarea||(this.resetForm(),this._textarea=this.addTextArea(null),this._textarea.onfocus(this,v));this.loadComment();this.resizable(!0,180,100);this.showFooter(!0);this.maxsize(0,0);this._textarea&&this._textarea.focus&&this._textarea.focus();},
v=function(){var a=this._textarea;a&&('number'==typeof a.selectionStart?a.selectionStart=a.selectionEnd=a.value.length:'undefined'!=typeof a.createTextRange&&(a.focus(),a=a.createTextRange(),a.collapse(!1),a.select()));};p.loadComment=function(){var a=this._highlight.comment()||'';this._textarea?this._textarea.value=a:this._label&&this._label.text(a);};p.saveComment=function(){this._textarea&&d.comment(this._highlight.id,this._textarea.value,!0);};p.align=function(a){var c;a:{var d=a?a.rect:null;if(this){var f=
this._highlight,h=f.isNote(),k,A,g;if(d)'view'!==d.origin&&(d=d.clone(),d.origin='view'),h?(c=d.left,k=d.top,A=d.right-d.left,g=d.bottom-d.top):(c=d.right+10,k=d.top);else if(d=f.boundingRectList('view'))for(f=0;f<d.length;f++){var r=d[f];h?(c=r.left,k=r.top,A=r.right-r.left,g=r.bottom-r.top):(c=r.right+10,k=r.top);0>k&&0<=r.bottom&&(k=0);if(0<=c&&0<=k)break;}if(void 0!=c){10>c&&(c=10);10>k&&(k=10);h=b.viewNode.pos();c+=h.left;k+=h.top;if(A&&g){c={left:c,top:k,width:A,height:g};break a;}c={left:c,top:k};
break a;}}c=void 0;}c&&(k=c.width||e,A=c.height||l,'view'===this._mode?this.autoSize(c.left,c.top,k,A,a):this.move(c.left,c.top,k,A,a));};});OIT.extend(function(a){var b=a.doc,d=a.glob,c=a.view;a.ToolBar=function(a,c,f,h,q,m){this.prop('id',a);this._edge=c;this._visible=!1;this._autoSize=!0;this._overlay=!!q;this._height=this._width=void 0;switch(this._edge){case 'top':this._dimension='height';this._border='borderBottom';this._direction=1;break;case 'bottom':this._dimension='height';this._border='borderTop';this._direction=-1;break;case 'left':this._dimension='width';this._border='borderRight';this._direction=1;break;case 'right':this._dimension=
'width',this._border='borderLeft',this._direction=-1;}this._frame=b.create('div','oit-toolframe');this._toolbar=b.create('div','oit-toolbar');this._toolsElem=f;this._content=b.create('div','oit-toolcontent');this._toolbar.append(this._toolsElem);this._frame.append(this._toolbar,this._content);this._overlay&&this._toolbar.css('z-index',10);h&&(b.unwrap(this._toolbar).style[this._border]=h);a=m?m._content:d.rootNode;this._content.transferFrom(a);a.append(this._frame);};var f=a.subclass(a.ToolBar);f.filter=
function(a){return a===this.id;};f.refresh=function(){this.applySize();this.dispatchSize();};f.isInternal=function(){return 0>this.id;};f.remove=function(){var b=this._frame.parent();b&&(b.transferFrom(this._content),this._frame.destroy());this.isInternal()||a.dispatch('toolbars','remove',this.id,this._edge);};f.isVisible=function(){return this._visible;};f.show=function(d){var f=this._toolbar;d=d||{};if(!this._visible){this._visible=!0;this._toolbar.css('display','block');if(void 0===this._borderSize&&
(this._borderSize=0,b.unwrap(this._toolbar).style[this._border])){var p=this._toolbar.computedStyle();p&&(this._borderSize=parseInt(p[this._border+'Width']));}this.applySize();this.isInternal()||a.dispatch('toolbars','show',this.id,this._edge,f.offsetWidth,f.offsetHeight);}this.dispatchSize(d.refresh);c.dispatchResize();};f.hide=function(){this._visible&&(this._visible=!1,this._toolbar.removeStyle('display'),this.applySize(),this.dispatchSize(),this.isInternal()||a.dispatch('toolbars','hide',this.id,
this._edge),c.dispatchResize());};f.setSize=function(a){'auto'===a?(this._toolbar.css(this._dimension,null),this._autoSize=!0):(this._toolbar.css(this._dimension,a),this._autoSize=!1);this.applySize();this.dispatchSize();};f.applySize=function(a){var b=this._toolbar,c=this._content,d=this._toolsElem,f=this._frame;b.removeStyle(['bottom','top','right','left']);if(void 0===a)if(this._visible){switch(this._edge){case 'top':case 'bottom':this._size=this._autoSize?d.offsetHeight:b.offsetHeight;break;case 'left':case 'right':this._size=
this._autoSize?d.offsetWidth:b.offsetWidth;}a=this._size;}else a=0;void 0!==this._borderSize&&(a+=this._borderSize);d=f.clientWidth;f=f.clientHeight;switch(this._edge){case 'top':b.css('bottom',f-a+'px');this._overlay||c.css('top',a+'px');break;case 'bottom':b.css('top',f-a+'px');this._overlay||c.css('bottom',a+'px');break;case 'left':b.css('right',d-a+'px');this._overlay||c.css('left',a+'px');break;case 'right':b.css('left',d-a+'px'),this._overlay||c.css('right',a+'px');}};f.dispatchSize=function(b){if(!this.isInternal()){var c=
this._toolbar;if(b||c.offsetWidth!=this._width||c.offsetHeight!=this._height)this._width=c.offsetWidth,this._height=c.offsetHeight,a.dispatch('toolbars','resize',this.id,this._edge,this._width,this._height);}};f.getRect=function(){var a={top:0,height:0,left:0,width:0};a.top=this._toolbar.dom.offsetTop;a.height=this._toolbar.dom.offsetHeight;a.left=this._toolbar.dom.offsetLeft;a.width=this._toolbar.dom.offsetWidth;return a;};});OIT.extend(function(a){var b=a.doc,d=a.toolbars,c=OIT.local;a.TabBar=function(){var f,e,l,p,h,q=[],m,k,z,s;this.show=function(){f&&f.show();};this.hide=function(){f&&f.hide();};this.length=function(){return q.length;};this.addPrevNext=function(d,f){if(!p){p=new a.Button('\u25c4',c.PAGE_UP);d&&(p.onclick(d),p.ontap(d));h=new a.Button('\u25ba',c.PAGE_DOWN);f&&(h.onclick(f),h.ontap(f));var k=b.create('div','oit-tab-nextprev');k.append(p,h);e.append(k);}};this.addTab=function(a,c,d){var e=b.create('div',
'oit-tab');e.html('<div>'+a+'</div>');l.append(e);q.push(e);if(c instanceof Function)e.on('click',null,t,c,d).on('tap',null,t,c,d);return q.length-1;};var t=function(a,b,c){b(c);};this.setActiveTab=function(a){if(0<=a&&(a<q.length&&a!=m)&&(void 0!=m&&q[m].removeClass('oit-tab-selected'),m=a,q[m].addClass('oit-tab-selected'),p.disabled=0==m,h.disabled=m+1>=q.length,void 0!==m)){a=q[m].rect(e);var b=l.rect(e),c=b.left;a.right>b.right?c-=a.right-b.right:0>a.left&&(c-=a.left);0<=c?l.css('left',null):l.css('left',
c+'px');}};this.destroy=function(){f&&d.removeInternal(-2);e&&e.destroy();q=h=p=l=e=f=null;};e=b.create('div','oit-tab-bar');l=b.create('div','oit-tab-list');e.append(l);l.kinetic(!0);l.ondragstart(function(a){a=l.rect(e);k=a.left;z=a.right;s=q[q.length-1].rect(e).right;});l.ondragmove(function(a){var b=a.delta.x;a=k+b;0>a&&(b=s+b,b<z&&(a+=z-b));0<a&&(a=0);l.css('left',a+'px');});f=new a.ToolBar(-2,'bottom',e);d.addInternal(-2,f);f.show();};});OIT.extend(function(a){var b=a.doc,d=a.toolbars,c=a.highlights;a.NotesBar=function(){var e,f,p,h,q=6,m,k,z={},s=-1;this.show=function(){f&&f.show();};this.hide=function(){f&&f.hide();};this.setContents=function(a){h.html(a);this._spanMap=void 0;};this.getContents=function(){return h;};this.destroy=function(){OIT.toolbars.removeEventListener('resize',B);OIT.toolbars.removeEventListener('show',w);f&&d.removeInternal(-1);p&&p.off('mousedown',v);p=h=e=f=void 0;};this.createSpanList=function(){for(var b=[],
c,d=h.createTreeWalker(NodeFilter.SHOW_ELEMENT),e=d.firstACCNode();e;){e=d.currentNode;e.dataset&&e.dataset.acc&&(c=Number(e.dataset.acc));for(var f=!0,k=e.firstChild;k;k=k.nextSibling)if(3==k.nodeType){f=!1;break;}!f&&void 0!==c?(c=new a.SpanInfo(e,c),b.push(c),c=c.accend,(e=d.skipNode())&&(e=d.firstACCNode())):e=d.nextACCNode();}0==b.length&&(b=null);return b;};this.extractMatchingSpanInfos=function(a){var b=[],c=this.createSpanList();if(void 0!==a&&null!=c&&0<a.length&&0<c.length)for(var d=0;d<a.length;d++)for(var e=
0;e<c.length;e++)if(a[d].acc==c[e].acc&&a[d].accend==c[e].accend){b.push(c[e]);break;}return b;};this.getHeight=function(){return e.offsetHeight;};this.toolbar=function(){return f;};this.toNotesBarY=function(a){var b=f.getRect();return a-b.top;};this.makeHighlightLayer=function(b){var c=z[b];void 0===k&&(k=new a.Drawing(e));void 0===c&&(c=new a.DrawingLayer(k,b,'oit.nboverlay.1.'+b),z[b]=c);return c;};this.removeHighlightsFromPage=function(a){c.each(x,null,a);};this.addHighlightsToPage=function(a){c.each(u,
null,a);};this.setPageNumber=function(a){s=a;};this.getPageNumber=function(){return s;};var t=function(a){a=window.innerHeight-a.clientY-2;a<q&&(a=q);f.setSize(a+'px');},v=function(a){m=b.cursor();b.cursor('ns-resize');a.preventDefault();document.addEventListener('mousemove',t);document.addEventListener('mouseup',y);},y=function(){b.cursor(m);document.removeEventListener('mouseup',y);document.removeEventListener('mousemove',t);},w=function(a){e.css('height',(a?a.detail.height:e.offsetHeight)+'px');},x=function(a,
b){a._pageInfo&&b<a._pageInfo.length&&a.removeFromPage(a._pageInfo[b]);},u=function(a,b){a.addToPage(b,!1);},B=function(a){-1==a.detail.id&&(q=p.offsetHeight+1,w(a));};e=b.create('div','oit-slidenotesbar','oit-notesbar.1');p=b.create('div','oit-vertical-sizebar');e.append(p);h=b.create('div','oit-slidenotes');e.append(h);f=new a.ToolBar(-1,'bottom',e);d.addInternal(-1,f);f.show();q=p.offsetHeight+1;OIT.toolbars.addEventListener('resize',B);OIT.toolbars.addEventListener('show',w);p.onmousedown(v);this.bNotesBar=
!0;a.Page.call(this,1E4,'slidenotesbar','oit-notesbar.1');this.type='slide';};var f=a.subclass(a.NotesBar,a.Page);f.inRect=function(a,b){var c=!1,d=this.toolbar().getRect();d.top<=b&&(b<=d.top+d.height&&d.left<=a&&a<=d.left+d.width)&&(c=!0);return c;};f.mousePos=function(a){var b={x:0,y:0};b.x=a.clientX;b.y=a.clientY;return b;};f.isHidden=function(){return!this.toolbar().isVisible();};});OIT.extend(function(a){var b=a.util;a.SpreadsheetCellGroup=function(a,b,f){this._index=a;this._size=f;this._hidden=!1;b&&(this._hidden=!0===b.hidden,void 0!==b.h?this._size=b.h:void 0!==b.w&&(this._size=b.w),void 0!==b.t&&(this._title=b.t),void 0!==b.st&&(this._styleIndex=b.st),this._acc=b.acc,this._accend=b.accend);this._originalHidden=this._hidden;this._originalSize=this._size;};a=a.subclass(a.SpreadsheetCellGroup);a.index=function(){return this._index;};a.title=function(){this._title||(this._title=
b.defaultSSColHeader(this._index));return this._title;};a.style=function(){return this._styleIndex;};a.setCellData=function(a){this._data=a;if(void 0===this._acc){for(a=0;a<this._data.length;a++){var b=this._data[a];if(b.t&&void 0!==b.a){this._acc=b.a;break;}}if(void 0!=this._acc)for(a=this._data.length-1;0<=a;a--)if(b=this._data[a],b.t&&void 0!==b.a){this._accend=b.a+b.t.length-1;break;}}};a.hidden=function(){return this._hidden;};a.show=function(a){return this._hidden||5>this._size?(this._hidden=!1,
5>this._size&&(this._size=a),!0):!1;};a.reset=function(){var a=!1;void 0!=this._originalSize&&(this._size=this._originalSize,a=!0);!this._hidden&&this._originalHidden&&(a=this._hidden=!0);return a;};a.size=function(){return this._hidden?0:this._size;};a.setSize=function(a){if('number'!==typeof a)throw'Invalid argument to setSize';this._size=a;this._hidden=0==a;};a.getCellsForRange=function(a,b){if(this._data&&void 0!==this._acc&&a<=this._accend&&b>=this._acc){for(var f,e=0;e<this._data.length;e++){var l=
this._data[e];l.t&&void 0!==l.a&&(a<=l.a+l.t.length&&b>=l.a)&&(f||(f=[]),f.push(l));}return f;}};a.getIndexForCell=function(a){if(this._data){for(var b=0,f=0;f<this._data.length;f++){var e=this._data[f];if(e==a)break;null==e||!e.e?b++:b+=e.e;}return b;}};a.getCell=function(a){if(this._data){if(void 0===this._getCellIndex||a<this._getCellIndex)this._getCellEmpty=this._getCellIndex=this._cellDataIndex=0,0<this._data.length&&this._data[0].e&&(this._getCellEmpty=this._data[0].e);for(;this._getCellIndex<a;){0<
this._getCellEmpty&&this._getCellEmpty--;if(0===this._getCellEmpty){this._cellDataIndex++;if(this._cellDataIndex>=this._data.length){this._getCellIndex=a;return;}var b=this._data[this._cellDataIndex];this._getCellEmpty=b?b.e||0:1;}this._getCellIndex++;}if(this._cellDataIndex<this._data.length)return this._data[this._cellDataIndex];}};});OIT.extend(function(a){var b=a.doc,d=a.glob,c=a.selection,f=a.range,e=a.ajax,l=a.util,p=a.dialog,h=a.display,q=OIT.local,m=a.highlights,k=a.SpreadsheetCellGroup;a.SpreadsheetModel=function(a,b,c){this._page=c;this._top=this._left=null;this._extRowCount=this._extColCount=this._bottom=this._right=void 0;this._merged=null;this._ajaxLoading=this._ajaxPending=0;this._hideMsg=!1;this._fonts=a.sheet.fonts;this._styles=a.styles;a.sheet.hasOwnProperty('s')?this._sheetStyle=this.cellStyle(a.sheet.s):this._sheetStyle=
{};this._colMajor='colmajor'===a.sheet.order;this._defColWidth=a.sheet.defcw||80;this._defRowHeight=a.sheet.defrh||20;a.cols||(a.cols=[]);a.rows||(a.rows=[]);this._colCount=0<a.sheet.c?a.sheet.c:a.cols.length;this._rowCount=0<a.sheet.r?a.sheet.r:a.rows.length;this._cols=[];for(var d=0;d<a.cols.length;d++){var g=a.cols[d];if(void 0!==g.s){c=g.e||g.s;for(var e=g.s;e<=c;e++)this._cols[e]=new k(e,g,this._defColWidth);}else this._cols[d]=new k(d,g,this._defColWidth);}this._rows=[];for(d=0;d<a.rows.length;d++)if(g=
a.rows[d],void 0!==g.s){c=g.e||g.s;for(e=g.s;e<=c;e++)this._rows[e]=new k(e,g,this._defRowHeight);}else this._rows[d]=new k(d,g,this._defRowHeight);a.cells&&t(this,a.cells);if(a.data){this._data=a.data;for(a=0;a<this._data.length;a++)c=this._data[a],c.f&&this._ajaxPending++,c.iend=a+1<this._data.length?this._data[a+1].i-1:this._colMajor?this._colCount:this._rowCount;}this._embeds=b;};a=a.subclass(a.SpreadsheetModel);var z=function(a,b,c){a=a.getCell(b,c);return!a?'':a.t||a.v||'';};a.updateDimensions=
function(){this._right=this.colLeft(this._colCount);this._bottom=this.rowTop(this._rowCount);this._extColCount=this._colCount;this._extRowCount=this._rowCount;var a=this.embeddingCount();if(a){for(var b=0;b<a;b++){var c=this.embed(b);if(c){if(!c.expansionApplied){var d=this.embed(b);if(d.node&&!d.originApplied){d.originApplied=!0;d.adjustX=0;d.adjustY=0;var g=d.node.data('origin');g&&(g=g.split(','),2==g.length&&(d.adjustX=Number(g[0]),d.adjustY=Number(g[1])));}}var e=this.colWidth(c.c1),f=this.rowHeight(c.r1),
h=c.x1,k=c.y1;h>e&&(h=e);k>f&&(k=f);d=this.colLeft(c.c1)+h;g=this.rowTop(c.r1)+k;c.position={left:d,top:g};void 0===c.c2?(c.position.right=d+c.w,c.position.bottom=g+c.h):(e=this.colWidth(c.c2),f=this.rowHeight(c.r2),h=c.x2,k=c.y2,h>e&&(h=e),k>f&&(k=f),e=this.colLeft(c.c2)+h,k=this.rowTop(c.r2)+k,e<d&&(e=d),k<g&&(k=g),c.position.right=e,c.position.bottom=k);c.position.right>this._right&&(this._right=c.position.right);c.position.bottom>this._bottom&&(this._bottom=c.position.bottom);}}this._extColCount=
this.colFromX(this._right)+1;this._extRowCount=this.rowFromY(this._bottom)+1;this._right=this.colLeft(this._extColCount);this._bottom=this.rowTop(this._extRowCount);}};a.unload=function(){l.each(this._data,function(a){a.ajax&&e.abort(a.ajax);});this._embeds=this._styles=this._fonts=this._sheetStyle=this._merged=this._rows=this._cols=this._data=null;};a.sheetStyle=function(){return this._sheetStyle;};a.webFonts=function(){return this._fonts;};a.showHidden=function(a){a&&(this._showHidden='columns'===this._showHidden&&
'rows'===a||'rows'===this._showHidden&&'columns'===a?'all':a);return this._showHidden;};a.embeddingCount=function(){return this._embeds?this._embeds.length:0;};a.embed=function(a){if(this._embeds&&0<=a&&a<this._embeds.length){if((a=this._embeds[a])&&!a.node)a.node=b.byId(a.id),a.node&&(!a.node.hasClass('oit-svg-embed')&&!a.node.hasClass('oit-image-embed'))&&(a.node=a.node.parent());return a;}};a.embedByUID=function(a){return l.byProperty(this._embeds,'uid',a);};a.getCell=function(a,b){if(this._colMajor){var c=
this._cols[a];if(c)return c.getCell(b);}else if(c=this._rows[b])return c.getCell(a);return null;};a.cellFromPos=function(a,b,c){(!this._right||!this._bottom)&&this.updateDimensions();a=this.colFromX(a);b=this.rowFromY(b);a>=this._extColCount&&(a=this._extColCount-1);b>=this._extRowCount&&(b=this._extRowCount-1);if(!1!==c&&(c=this.getMergedCell(a,b)))a=c.range.c1,b=c.range.r1;return f.cellRange(a,b);};a.prevTextCell=function(a,b){var c=a-50;0>c&&(c=0);if(this._colMajor)for(var d=a-1;d>=c;d--){var g=this._cols[d];
if(g&&(g=g.getCell(b))&&(g.t||g.v))return d;}else{var e=this._rows[b];if(e)for(d=a-1;d>=c;d--)if((g=e.getCell(d))&&(g.t||g.v))return d;}};a.cellStyle=function(a){return this._styles&&void 0!==a&&0<=a&&a<this._styles.length?this._styles[a]:{};};a.rowCount=function(){void 0===this._bottom&&this.updateDimensions();return this._extRowCount;};a.colCount=function(){void 0===this._right&&this.updateDimensions();return this._extColCount;};a.eachRow=function(a){for(var b in this._rows)a(Number(b));};a.eachCol=function(a){for(var b in this._cols)a(Number(b));};
a.rowHeight=function(a){a=this._rows[a];return!a?this._defRowHeight:a.size();};a.colWidth=function(a){a=this._cols[a];return!a?this._defColWidth:a.size();};a.setRowHeight=function(a,b){this._rows[a]||(this._rows[a]=new k(a,null,this._defRowHeight));var c=this._rows[a];c&&(c.setSize(b),this._top=null,this._right=void 0);};a.setColWidth=function(a,b){this._cols[a]||(this._cols[a]=new k(a,null,this._defColWidth));var c=this._cols[a];c&&(c.setSize(b),this._left=null,this._bottom=void 0);};a.showRow=function(a){return(a=
this._rows[a])&&a.show(this._defRowHeight)?(this._top=null,this._right=void 0,!0):!1;};a.showCol=function(a){return(a=this._cols[a])&&a.show(this._defColWidth)?(this._left=null,this._bottom=void 0,!0):!1;};a.resetRow=function(a){return(a=this._rows[a])&&a.reset()?(this._top=null,this._right=void 0,!0):!1;};a.resetCol=function(a){return(a=this._cols[a])&&a.reset()?(this._left=null,this._bottom=void 0,!0):!1;};a.colHidden=function(a){return(a=this._cols[a])?a.hidden():!1;};a.rowHidden=function(a){return(a=
this._rows[a])?a.hidden():!1;};a.colStyle=function(a){return(a=this._cols[a])?this.cellStyle(a.style()):{};};a.rowTop=function(a){if(!this._top){this._top=[];for(var b=0,c=0;c<=this._rows.length;c++){this._top.push(b);var d=this._rows[c],b=d?b+d.size():b+this._defRowHeight;}}if(a<this._top.length)return this._top[a];b=this._top.length-1;return this._top[b]+(a-b)*this._defRowHeight;};a.rowBottom=function(a){return this.rowTop(a+1);};a.rowFromY=function(a){for(var b=0;a>this.rowBottom(b);)b++;for(;0==this.rowHeight(b)&&
0<b;)b--;return b;};a.colLeft=function(a){if(!this._left){this._left=[];for(var b=0,c=0;c<=this._cols.length;c++){this._left.push(b);var d=this._cols[c],b=d?b+d.size():b+this._defColWidth;}}if(a<this._left.length)return this._left[a];b=this._left.length-1;return this._left[b]+(a-b)*this._defColWidth;};a.colRight=function(a){return this.colLeft(a+1);};a.colFromX=function(a){for(var b=0;a>this.colRight(b);)b++;for(;0==this.colWidth(b)&&0<b;)b--;return b;};a.sheetRight=function(){void 0===this._right&&this.updateDimensions();
return this._right;};a.sheetBottom=function(){void 0===this._bottom&&this.updateDimensions();return this._bottom;};a.colTitle=function(a){var b=this._cols[a];return b?b.title():l.defaultSSColHeader(a);};a.getMergedCell=function(a,b){var c;if(this._merged)for(var d=0;d<this._merged.length;d++){var g=this._merged[d].range;if(a>=g.c1&&a<=g.c2&&b>=g.r1&&b<=g.r2){c=this._merged[d];break;}}return c;};a.containsRange=function(a,b){if(this._colMajor)for(var c in this._cols){if(this._cols[c].getCellsForRange(a,
b))return!0;}else for(var d in this._rows)if(this._rows[d].getCellsForRange(a,b))return!0;return!1;};a.getCellsForRange=function(a,b){var c;if(this._colMajor)for(var d in this._cols){var g=this._cols[d].getCellsForRange(a,b);g&&(c=c?c.concat(g):g);}else for(var e in this._rows)(g=this._rows[e].getCellsForRange(a,b))&&(c=c?c.concat(g):g);return c;};a.select=function(a){var b=!1;if(a&&'text'===a.type){if(0!=f.compare(a,this._selectedRange)){this.select(null);var c=this._selectedCells=this.getCellsForRange(a.acc,
a.accend);if(c){this._selectedRange=f.clone(a);for(b=0;b<c.length;b++){var d=c[b];d.selection=a;d.highlightsChanged=!0;}b=!0;}}}else if(this._selectedCells){c=this._selectedCells;delete this._selectedCells;delete this._selectedRange;for(b=0;b<c.length;b++)d=c[b],delete d.selection,d.highlightsChanged=!0;b=!0;}return b;};a.addHighlight=function(a){var b=!1;if(a)if('text'===a.range.type){var c=this.getCellsForRange(a.range.acc,a.range.accend);if(c){for(var d=0;d<c.length;d++){var g=c[d];g.highlights?-1==
g.highlights.indexOf(a)&&(g.highlights.push(a),g.highlightsChanged=!0):(g.highlights=[a],g.highlightsChanged=!0);}b=!0;}!b&&this.hasPendingContent()&&(b=!0);}else if(a.isCompoundRedaction()&&'cell'===a.range.type&&(c=this.mapToText(a.range)))for(d=0;d<c.length;d++)if(g=c[d],g=this.getCell(g.cell.c,g.cell.r))g.highlights?-1==g.highlights.indexOf(a)&&(g.highlights.push(a),g.highlightsChanged=!0):(g.highlights=[a],g.highlightsChanged=!0);return b;};a.removeHighlight=function(a){if(a)if('text'==a.range.type){var b=
this.getCellsForRange(a.range.acc,a.range.accend);if(b){for(var c=0;c<b.length;c++){var d=b[c];d.highlights&&(l.remove(d.highlights,a),0==d.highlights.length&&delete d.highlights,d.highlightsChanged=!0);}return!0;}}else if(a.isCompoundRedaction()&&'cell'===a.range.type&&(b=this.mapToText(a.range)))for(c=0;c<b.length;c++)if(d=b[c],(d=this.getCell(d.cell.c,d.cell.r))&&d.highlights)l.remove(d.highlights,a),0==d.highlights.length&&delete d.highlights,d.highlightsChanged=!0;return!1;};a.expandRange=function(a){if(this._merged){var b=
!1;do for(var b=!1,c=0;c<this._merged.length;c++){var d=this._merged[c];a.c1<=d.range.c2&&(a.c2>=d.range.c1&&a.r1<=d.range.r2&&a.r2>=d.range.r1)&&(d.range.c1<a.c1&&(a.c1=d.range.c1,b=!0),d.range.r1<a.r1&&(a.r1=d.range.r1,b=!0),d.range.c2>a.c2&&(a.c2=d.range.c2,b=!0),d.range.r2>a.r2&&(a.r2=d.range.r2,b=!0));}while(b);}return a;};a.getHoverText=function(){if(this.isRangeSelected())return null;var a=c.cellSelection(),a=this.getCell(a.c1,a.r1);return!a||!a.clipped?null:a.t||a.v;};a.isRangeSelected=function(){var a=
c.cellSelection();return a&&(a.c1!=a.c2||a.r1!=a.r2);};a.getSelectedText=function(){var a='';switch(c.selectionType()){case 'text':if(this._selectedCells)for(var b=c.textSelection(),d=this._selectedCells,e=0;e<d.length;e++){var g=d[e];if(g.t){var f=b.acc-g.a;0>f&&(f=0);var h=b.accend-g.a;h>f&&(a&&(a+='\t'),a+=g.t.substring(f,h));}}break;case 'cell':if(b=c.cellSelection(),this.isRangeSelected()){d=0;for(e=b.r1;e<=b.r2;e++){g=0;for(f=b.c1;f<=b.c2;f++){if(h=z(this,f,e)){if(0<d)for(1E3<d&&(d=1E3);0<d;d--)a+=
'\r\n';if(0<g)for(1E3<g&&(g=1E3);0<g;g--)a+='\t';a+=h;}g++;}d++;}}else a=z(this,b.c1,b.r1)||'';}return a;};a.mapToCells=function(a){if('text'==a.type){var b=[],c=a.acc;a=a.accend;if(this._colMajor)for(var d in this._cols){var g=this._cols[d],e=b,h=g.getCellsForRange(c,a);if(h)for(var k=0;k<h.length;k++){var l=g.getIndexForCell(h[k]),m=this.getMergedCell(g.index(),l);m?e.push(f.clone(m.range)):e.push(f.cellRange(g.index(),l));}}else for(g in this._rows)if(d=this._rows[g],e=b,h=d.getCellsForRange(c,a))for(k=
0;k<h.length;k++)l=d.getIndexForCell(h[k]),(m=this.getMergedCell(l,d.index()))?e.push(f.clone(m.range)):e.push(f.cellRange(l,d.index()));return b;}};a.mapToText=function(a){if('cell'==a.type){var b;a=s(a);for(var c=a.r1;c<=a.r2;c++)for(var d=a.c1;d<=a.c2;d++){var g=this.getCell(d,c);if(g&&g.t&&void 0!==g.a){var e=g.a+g.t.length;b||(b=[]);g=f.textRange(g.a,e);g.cell={c:d,r:c};b.push(g);}}return b;}};a.decomposeRange=function(a,b){if('cell'==a.type){a=s(a);var c=this.mapToText(a);if(b)c?c.push(a):c=[a];
else{for(var d=[],g=a.r1;g<=a.r2;g++)for(var e=null,h=a.c1;h<=a.c2;h++){var k=this.getCell(h,g);k&&k.v&&(e&&e.c2==h-1?e.c2=h:(e=f.cellRange(a.page,h,g,h,g),d.push(e)));}if(0<d.length){c||(c=[]);for(g=0;g<d.length;g++)if(e=d[g]){for(h=g+1;h<d.length;h++)if((k=d[h])&&k.r1==e.r2+1&&k.c1==e.c1&&k.c2==e.c2)e.r2=k.r2,d[h]=null;c.push(e);}}}return c;}};var s=function(a){var b=a;if('cell'==a.type&&a.offsets){var b=a.c1,c=a.c2,d=a.r1,g=a.r2;if(b>c)var e=b,b=c,c=e;d>g&&(e=d,d=g,g=e);0>a.offsets.left&&0<b&&b--;
0<a.offsets.right&&c++;0>a.offsets.top&&0<d&&d--;0<a.offsets.bottom&&g++;b=f.cellRange(a.page,b,d,c,g);}return b;},t=function(a,b){for(var c=a._colMajor?a._cols:a._rows,d=0,g=0;g<b.length;g++){var e=b[g];e instanceof Array||(d=e.i,e=e.d);c[d]||(a._colMajor?a._cols[d]=new k(d,null,a._defColWidth):a._rows[d]=new k(d,null,a._defRowHeight));c[d].setCellData(e);for(var h=0,l=0;h<e.length;h++){e=e[h];if(e.mh||e.mv){a._merged||(a._merged=[]);var m;m=a._colMajor?f.cellRange(g,l,g,l):f.cellRange(l,g,l,g);e.mh&&
(m.c2+=e.mh);e.mv&&(m.r2+=e.mv);a._merged.push({cell:e,range:m});}e.e?l+=e.e:l++;}d++;}},v=function(a,b,c,d,g,e,f){e.loaded=!0;delete e.ajax;0==--g._ajaxLoading&&g._hideMsg&&(p.hideMessage(),g._hideMsg=!1);if(200===d){var k=JSON.parse(c);k.cells&&(t(g,k.cells),m.each(function(a){g.addHighlight(a);},g._page),h.update(!0));if(f){for(var k=[g],l=7;l<arguments.length;l++)k.push(arguments[l]);f.apply(null,k);}}else g.logFatalError(null,'Failed to load resource from server (Error '+d+'): '+a);},y=function(a,
b,c){if(b.f&&!b.loaded&&!b.ajax){var f=b.f;'/'!=f.charAt(0)&&(f=l.concatURL(d.baseURL,f));b.ajax=e.start({url:f,context:a,complete:v,args:Array.prototype.slice.call(arguments)});a._ajaxPending--;a._ajaxLoading++;1==a._ajaxLoading&&!p.messageVisible()&&(p.showMessage(q.PLEASE_WAIT_DOWNLOADING),a._hideMsg=!0);}};a.hasPendingContent=function(){return 0<this._ajaxPending||0<this._ajaxLoading;};a.loadRange=function(a,b){var c=!0;if(this._data)switch(a.type){case 'text':var d=this.mapToCells(a);if(!d||0==
d.length)l.setTimeout(w,0,this,this,a,b),c=!1;break;case 'cell':this.loadDataForCells(a.c1,a.r1,a.c2,a.r2,!1,b),c=!1;}c&&b&&b(a);};var w=function(a,b,c){var d=a.mapToCells(b);if(d&&0<d.length)c&&c(b);else for(d=0;d<a._data.length;d++){var g=a._data[d];if(g&&!g.loaded&&!g.ajax){y(a,g,w,b,c);break;}}};a.loadDataForCells=function(a,b,c,d,g,e){if(this._data){this._colMajor||(a=b,c=d);g&&this._deferredTimer&&(l.clearTimeout(this._deferredTimer),delete this._deferredTimer);var f;for(d=0;d<this._data.length;d++)if((b=
this._data[d])&&!b.loaded&&!b.ajax){if(b.i>c)break;b.iend>=a&&(f||(f=[]),f.push(b));}f?g?this._deferredTimer=l.setTimeout(x,200,this,this,f,e):x(this,f,e):e&&e(null);}};var x=function(a,b,c){for(var d=0;d<b.length;d++)y(a,b[d],c);};});OIT.extend(function(a){var b=a.doc,d=a.glob,c=a.util,f=a.math,e=a.css,l=a.selection,p={f:'_font',s:'_fontSize',fs:'_fontStyle',fw:'_fontWeight',d:'_textdec',ba:'_baseline',ta:'_angle',c:'_color',w:'_wrap',a:'_align',i:'_indent',v:'_valign',bdr:'_bdr',b:'_fill',bb:'_fillBg',bh:'_fillHatch'};a.TextMeasureDiv=null;a.SpreadsheetCellRenderer=function(a,b,c,d){this._data=a;this._model=b;this._style=a.s?b.cellStyle(a.s):{};a.t?this._text=a.t:a.v&&(this._text=a.v);d=this._style;c=a.c?b.colStyle(c):{};b=b.sheetStyle();
this._font='Arial';this._fontSize=10;this._align='g';this._indent=0;this._valign='b';for(var e in p)if(p.hasOwnProperty(e)){var h=d[e]||c[e]||b[e];void 0!==h&&(this[p[e]]=h);}a.c&&(this._color=a.c);if(this._angle&&'vertical'!==this._angle){for(;0>this._angle;)this._angle+=360;for(;360<=this._angle;)this._angle-=360;0==this._angle?this._angle=null:(this._angle=f.radians(360-this._angle),this._align='l',this._valign='b',this._indent=0);}this._bdr&&(this._topBorder=this._bdr[0],this._rightBorder=this._bdr[1],
this._bottomBorder=this._bdr[2],this._leftBorder=this._bdr[3],a.bs&&(-1!=a.bs.indexOf('t')&&(this._topBorder=null),-1!=a.bs.indexOf('r')&&(this._rightBorder=null),-1!=a.bs.indexOf('b')&&(this._bottomBorder=null),-1!=a.bs.indexOf('l')&&(this._leftBorder=null)),delete this._bdr);2>this._indent&&(this._indent=2);this._clearLeft=this._textRight=this._textLeft=0;this._clearRight=void 0;};var h=a.subclass(a.SpreadsheetCellRenderer);h.hasText=function(){return this._text&&0<this._text.length;};h.textRight=
function(){return this._textRight;};h.horizontalMerge=function(){return this._data.mh||0;};h.verticalMerge=function(){return this._data.mv||0;};h.horizontalAlign=function(){return this._align;};h.leftBorder=function(){return this._leftBorder||null;};h.topBorder=function(){return this._topBorder||null;};h.rightBorder=function(){return this._rightBorder||null;};h.bottomBorder=function(){return this._bottomBorder||null;};h.rangeRect=function(a){var b=this._wrappedText;if('text'===a.type&&b){var c,d=a.acc-this._data.a;
a=a.accend-this._data.a;0>d&&(d=0);a>this._text.length&&(a=this._text.length);for(var e=0;e<b.length;e++)for(var f=b[e],h=f.x,k=f.y,l=f.o,m=0;m<f.spans.length;m++){var p=f.spans[m],q=l+p.t.length;if(q>d&&l<a){var l=h+p.w,s=k+f.h;c?(h<c.left&&(c.left=h),k<c.top&&(c.top=k),l>c.right&&(c.right=l),s>c.bottom&&(c.bottom=s)):c={left:h,top:k,right:l,bottom:s};}h+=p.w;l=q;}return c;}};h.drawTextBackground=function(a,b,c,d,e,f,h){if(0>this._textLeft||this._textRight>f)b=d+this._textLeft,d+=this._textRight,b<
this._clearLeft&&(b=this._clearLeft),void 0!==this._clearRight&&d>=this._clearRight&&(d=this._clearRight-1),a.oitrect(b+1,e+1,d-b-1,h-1,'#ffffff');};h.drawBackground=function(c,d,g,e,f,h,k){if(this._fill||this.horizontalMerge()||this.verticalMerge())if(this._fillHatch){d=new a.Canvas(8,8);g=d.getContext('2d');this._fillBg&&g.oitrect(0,0,8,8,this._fillBg);g.strokeStyle=this._fill||'#ffffff';g.lineCap='square';'d'==this._fillHatch.charAt(0)?g.lineWidth=2:g.lineWidth=1;switch(this._fillHatch){case 'lv':case 'dv':g.oitline(1.5,
0,1.5,8);g.oitline(5.5,0,5.5,8);break;case 'lh':case 'dh':g.oitline(0,1.5,8,1.5);g.oitline(0,5.5,8,5.5);break;case 'ldd':case 'ddd':g.oitline(-0.5,-0.5,8.5,8.5);break;case 'lud':case 'dud':g.oitline(8.5,-0.5,-0.5,8.5);break;case 'lg':case 'dg':g.oitline(1.5,0,1.5,8);g.oitline(5.5,0,5.5,8);g.oitline(0,1.5,8,1.5);g.oitline(0,5.5,8,5.5);break;case 'lt':case 'dt':g.oitline(0,0,8,8),g.oitline(8,0,0,8);}d=c.createPattern(b.unwrap(d),'repeat');c.fillStyle=d;c.globalAlpha=1;c.fillRect(e+0.5,f+0.5,h+0.5,k+
0.5);}else c.oitrect(e+0.5,f+0.5,h+0.5,k+0.5,this._fill||'#ffffff');};var q=function(a,b,c,d,e){c||(c=1);var f=2*c;switch(b){case 'dotted':b=[f,f];break;case 'dashed':b=[2*f,f];break;case 'dashdot':b=[2*f,f,f,f];break;case 'dashdotdot':b=[2*f,f,f,f,f,f];break;case 'double':b=[];c=Math.floor(c/3);1>c&&(c=1);break;default:b=[];}for(var h=f=0;h<b.length;h++)f+=b[h];e%=f;a.strokeStyle=d||'black';a.fillStyle=d||'black';a.lineWidth=c;a.setLineDash?(a.setLineDash(b),a.lineDashOffset=e):(a.mozDash=b,a.mozDashOffset=
e);},m=function(a){var b=Math.floor(a.w/3);1>b&&(b=1);a=a.w-(b+b);1>a&&(a=1);b=(b+a)/2;return[-b,b];},k=function(a,b){var c=0,d=0;if(a&&'double'===a.s)var e=m(a),c=-e[0];b&&'double'===b.s&&(e=m(b),d=e[1]);return c&&d?c>d?-c:-d:c?c:d;},z=function(a,b){var c=0,d=0;if(a&&'double'===a.s)var e=m(a),c=-e[0];b&&'double'===b.s&&(e=m(b),d=e[1]);return c&&d?[-c,-d]:c?[-c,c]:[d,-d];},s=function(a,b,c,d,e,f,h,l,p){q(a,e.s,e.w,e.c,b);'double'===e.s?(e=m(e),f=z(f,h),l=z(l,p),f[0]||(f[0]=-0.5),f[1]||(f[1]=-0.5),l[0]||
(l[0]=0.5),l[1]||(l[1]=0.5),a.beginPath(),a.moveTo(b-f[0],c+e[0]),a.lineTo(d+l[0],c+e[0]),a.moveTo(b-f[1],c+e[1]),a.lineTo(d+l[1],c+e[1])):(e=k(f,h),l=k(l,p),e||(e=-0.5),l||(l=0.5),a.beginPath(),a.moveTo(b-e,c+0.5),a.lineTo(d+l,c+0.5));a.stroke();},t=function(a,b,c,d,e,f,h,l,p){q(a,e.s,e.w,e.c,c);'double'===e.s?(e=m(e),f=z(f,h),l=z(l,p),f[0]||(f[0]=-0.5),f[1]||(f[1]=-0.5),l[0]||(l[0]=0.5),l[1]||(l[1]=0.5),a.beginPath(),a.moveTo(b+e[0],c-f[0]),a.lineTo(b+e[0],d+l[0]),a.moveTo(b+e[1],c-f[1]),a.lineTo(b+
e[1],d+l[1])):(e=k(f,h),l=k(l,p),e||(e=-0.5),l||(l=0.5),a.beginPath(),a.moveTo(b+0.5,c-e),a.lineTo(b+0.5,d+l));a.stroke();},v=function(a,b){var c=null;a&&(c=a.bottomBorder());if(b){var d=b.topBorder();if(d&&(!c||d.w>c.w))c=d;}return c;},y=function(a,b){var c=null;a&&(c=a.rightBorder());if(b){var d=b.leftBorder();if(d&&(!c||d.w>c.w))c=d;}return c;};h.drawBorder=function(a,b,c,d,e,f,h,k){if(this._topBorder||this._rightBorder||this._bottomBorder||this._leftBorder){var l=d+f;h=e+h;a.lineCap='square';a.lineJoin=
'miter';a.globalAlpha=1;if(this._leftBorder&&0<=this._textLeft&&0<b){b=v(k[0][0],k[1][0]);var m=v(k[1][0],k[2][0]);t(a,d,e,h,this._leftBorder,b,this._topBorder,m,this._bottomBorder);}this._topBorder&&0<c&&(b=y(k[0][0],k[0][1]),c=y(k[0][1],k[0][2]),s(a,d,e,l,this._topBorder,b,this._leftBorder,c,this._rightBorder));this._rightBorder&&this._textRight<=f&&(c=v(k[0][2],k[1][2]),f=v(k[1][2],k[2][2]),t(a,l,e,h,this._rightBorder,this._topBorder,c,this._bottomBorder,f));this._bottomBorder&&(m=y(k[2][0],k[2][1]),
f=y(k[2][1],k[2][2]),s(a,d,h,l,this._bottomBorder,this._leftBorder,m,this._rightBorder,f));q(a,null);}};var w=function(a,b,c,d){if(c||d){var f={s:{},o:-1,oend:-1};'text'===b.type?(f.o=b.acc-a._data.a,0>f.o&&(f.o=0),f.oend=b.accend-a._data.a):(f.o=0,f.oend=a._text.length);c&&(f.s.c=c);d&&(f.s.bg=e.colorToString(d));return f;}};h.layoutText=function(a,b,d,f,h,k,m){if(this.hasText()){d=!1;var p=null,q=this._data.selection,s=this._data.highlights;if(q||s&&0<s.length){p=[];if(q){var t=l.style()||'color:white;background-color:#3399FF;',
v=e.get(t,'color'),t=e.get(t,'background-color');(v=w(this,q,v,t))&&p.push(v);}if(s)for(q=0;q<s.length;q++){var y=s[q],v=y.css('color'),t=y.css('background-color');(v=w(this,y.range,v,t))&&p.push(v);}delete this._data.highlightsChanged;}if(!this._wrappedText||!c.arraysEqual(p,this._highlightSpecs))this._highlightSpecs&&!p?delete this._highlightSpecs:this._highlightSpecs=p,this._wrappedText=null;this.horizontalMerge()||this.verticalMerge()?(this._clearLeft=b,this._clearRight=b+f):(this._clearLeft=k,this._clearRight=
m);f!=this._layoutWidth&&(this._wrappedText=null);h!=this._layoutHeight&&(d=!0);if(!this._wrappedText&&(this._textLeft=0,this._layoutWidth=this._textRight=f,'l'==this._align?this._textLeft=this._indent:'r'==this._align&&(this._textRight=f-this._indent),q=this._textRight-this._textLeft,d=!0,this._wrap||this._angle?this._wrappedText=this.wrapText(a,q):this._data.cs||-1!=this._text.indexOf('\n')?this._wrappedText=this.wrapText(a):(b=this.createLine(0,this._text.length,null),x(a,b,this),u(a,b,this),this._wrappedText=
[b]),a=this._wrappedText))if(q=void 0!==this._data.v,q='r'==this._align||'rs'==this._align||q&&'g'==this._align,'c'==this._align||'cs'==this._align)for(q=0;q<a.length;q++)b=a[q],b.x=(f-b.w)/2,k=b.x+b.w,b.x<this._textLeft&&(this._textLeft=b.x),k>this._textRight&&(this._textRight=k);else if(q)for(q=0;q<a.length;q++)b=a[q],b.x=f-2-b.w-this._indent,b.x<this._textLeft&&(this._textLeft=b.x);else for(q=0;q<a.length;q++)b=a[q],b.x=this._indent,k=b.x+b.w,k>this._textRight&&(this._textRight=k);if(d){this._layoutHeight=
h;a=this._wrappedText;f=a[a.length-1];f=f.y+f.h-a[0].y;d=0;'c'==this._valign?d=(h-f)/2:'b'==this._valign&&(d=h-f-2);for(q=0;q<a.length;q++)b=a[q],b.y=d,d+=b.h;}}};h.drawText=function(a,b,c,d,h,k,l){if(b=this._wrappedText){c=!1;var m=b[b.length-1],m=m.y+m.h-b[0].y;this._data.clipped=!1;if(0>this._textLeft||this._textRight>k||m>l){k=d+this._textLeft;var p=d+this._textRight;if(k<this._clearLeft||void 0!==this._clearRight&&p>this._clearRight||m>l)k<this._clearLeft&&(k=this._clearLeft),void 0!==this._clearRight&&
p>this._clearRight&&(p=this._clearRight),a.save(),c=!0,a.beginPath(),a.fillStyle='black',a.rect(k,h,p-k,l),a.clip(),this._data.clipped=!0;}a.globalAlpha=1;a.textAlign='left';a.textBaseline='alphabetic';this._angle&&('vertical'!==this._angle&&0<b.length)&&(c||(a.save(),c=!0),a.translate(d+b[0].x,h+b[0].y),d=-b[0].x,h=-b[0].y,a.rotate(this._angle));for(k=0;k<b.length;k++){m=b[k];if(m.y>l)break;for(var p=d+m.x,q=h+m.y,s=0;s<m.spans.length;s++){var t=m.spans[s],u=this._font,v=this._fontSize,x=this._fontStyle,
w=this._fontWeight,y=this._color,z=this._textdec,V=this._baseline,G=null;t.s&&(t.s.f&&(u=t.s.f),t.s.s&&(v=t.s.s),t.s.fs&&(x=t.s.fs),t.s.fw&&(w=t.s.fw),t.s.c&&(y=t.s.c),t.s.d&&(z=t.s.d),t.s.ba&&(V=t.s.ba),t.s.bg&&(G=t.s.bg));t.hs&&(t.hs.c&&(y=t.hs.c),t.hs.bg&&(G=t.hs.bg));var S=f.round(q+m.a);V&&('sup'===V?(S+=-0.35*m.a,v*=0.65):'sub'===V&&(S+=0.141*m.a,v*=0.65));G&&(a.fillStyle=e.rgbStringFromString(G),a.globalAlpha=e.opacityFromString(G),a.fillRect(p-1,S-m.a,t.w+2,m.h+2));a.font=B(u,v,x,w);a.fillStyle=
y||'black';a.globalAlpha=1;a.fillText(t.t,p,S);if(z){var N,T,U;switch(z){case 'u':U=1;N=S+U;break;case 'd':U=1;N=S+U;T=N+U+U;break;case 'l':U=1,N=S-0.25*t.a;}void 0!==N&&(N=f.round(N)+0.5,a.strokeStyle=y,a.lineWidth=U,a.beginPath(),a.moveTo(p,N),a.lineTo(p+t.w,N),void 0!==T&&(T=f.round(T)+0.5,a.moveTo(p,T),a.lineTo(p+t.w,T)),a.stroke(),a.closePath());}p+=t.w;}}c&&a.restore();}};h.createLine=function(a,b,c){var d={x:0,y:0,w:0,h:0,spans:[],o:a};if(c){for(var e=a,f,h=0;h<c.length;h++){var k=c[h];if(k.o>
e){var l=k.o;l>b&&(l=b);e=this._text.substring(e,l);d.spans.push({t:e,w:0,s:f});e=l;if(e>=b)break;}f=this._model.cellStyle(k.s);}e<b&&(e=this._text.substring(e,b),d.spans.push({t:e,w:0,s:f}));}else e=this._text.substring(a,b),d.spans.push({t:e,w:0});if(this._highlightSpecs)for(b=0;b<this._highlightSpecs.length;b++){c=this._highlightSpecs[b];e=a;for(f=0;f<d.spans.length;f++){h=d.spans[f];l=e+h.t.length;if(c.o<l&&c.oend>e){k=c.o-e;if(0<k){var l=h.t.substring(0,k),k=h.t.substring(k),m={t:l,w:0};h.s&&(m.s=
h.s);d.spans.splice(f,0,m);f++;h.t=k;e+=l.length;l=e+h.t.length;}k=c.oend-e;k<h.t.length&&(l=h.t.substring(0,k),k=h.t.substring(k),m={t:k,w:0},h.s&&(m.s=h.s),d.spans.splice(f+1,0,m),h.t=l,l=e+h.t.length);h.hs||(h.hs={});c.s.c&&(h.hs.c=c.s.c);c.s.bg&&(h.hs.bg=c.s.bg);}e=l;}}return d;};var x=function(a,b,c){for(var d=b.w=0;d<b.spans.length;d++){var e=b.spans[d],f=c._font,h=c._fontSize,k=c._fontStyle,l=c._fontWeight,m=c._baseline;e.s&&(e.s.f&&(f=e.s.f),e.s.s&&(h=e.s.s),e.s.fs&&(k=e.s.fs),e.s.fw&&(l=e.s.fw),
e.s.baseline&&(m=e.s.baseline));m&&('sup'===m?h*=0.65:'sub'===m&&(h*=0.65));a.font=B(f,h,k,l);e.w=a.measureText(e.t).width;b.w+=e.w;}return b.w;},u=function(c,e,g){a.TextMeasureDiv||(a.TextMeasureDiv=b.create('div','oit-textmeasure'),d.rootNode.append(a.TextMeasureDiv));e.h=0;e.a=0;c=a.TextMeasureDiv;c.css('display','inline');for(var f=0;f<e.spans.length;f++){var h=e.spans[f],k=g._font,l=g._fontSize,m=g._fontStyle,p=g._fontWeight;h.s&&(h.s.f&&(k=h.s.f),h.s.s&&(l=h.s.s),h.s.fs&&(m=h.s.fs),h.s.fw&&(p=
h.s.fw));c.text(h.t);var q=b.create('span');c.append(q);c.css('font',B(k,l,m,p));c.offsetHeight>e.h&&(e.h=c.offsetHeight);h.a=q.offsetTop+1;h.a>e.h&&(h.a=e.h);h.a>e.a&&(e.a=h.a);}c.html('');c.attr('style','');c.removeStyle('display');};h.wrapText=function(a,b){var c=[];void 0!==b&&(b-=4);var d=0,e=0,f=0;if('vertical'===this._angle)b=0;else if(this._angle)if(this._angle===Math.PI/2||this._angle===3*Math.PI/2)b=this._layoutHeight;else{var h=Math.tan(this._angle),k=-this._layoutHeight-h,k=Math.sqrt(k*
k),l=Math.sqrt(h*h+this._layoutHeight*this._layoutHeight),h=2*this._layoutHeight+h,h=Math.sqrt(this._layoutHeight*this._layoutHeight+h*h),k=Math.min(Math.min(k,l),h);k<b&&(b=k);}for(;d<this._text.length;){for(;f<this._text.length;){k=this._text[f];if(' '==k||'\t'==k||'\n'==k)break;f++;}k=this.createLine(d,f,this._data.cs);x(a,k,this);if((l=void 0!==b&&k.w>b)||'\n'==this._text[f]||f>=this._text.length){if(l)if(e>d)f=e,k=this.createLine(d,f,this._data.cs),x(a,k,this);else for(l=d+1;f>l&&!(f--,k=this.createLine(d,
f,this._data.cs),x(a,k,this),k.w<=b););c.push(k);f<this._text.length&&(k=this._text[f],(' '==k||'\t'==k||'\n'==k)&&f++);d=f;}else e=f++;}if(0!=c.length){for(e=d=0;e<c.length;e++)f=c[e],u(a,f,this),f.y=d,d+=f.h;return c;}};var B=function(a,b,c,d){0>=b&&(b=10);var e='';c&&'normal'!==c&&(e+=c+' ');d&&'normal'!=d&&(e+=d+' ');return e+(b+'px '+a);};});OIT.extend(function(a){var b=a.doc,d=a.glob,c=a.opt,f=a.document,e=a.selection,l=a.util,p=a.math,h=a.range,q=a.highlights;a.SpreadsheetView=function(m,k){var z=this,s=m,t=k,v,y,w,x,u,B,n,A,g,r,C,F,I,J,L=[],E,D=0,K=0,H=40,M=22,P,O,R,Q,V=0,G=c.zoom,S='database'!==k.type,N,T=-1,U=-1,Y=-1,$=-1,ja=!1;this.unload=function(){z.hidePopup(!0);a.off('document','scroll',ka);a.off('selection','selectionchanged',la);a.off('pages','pageload',ba);a.off('view','resize',aa);I&&I.destroy();for(var b=s.embeddingCount(),
c=0;c<b;c++)s.embed(c).node=void 0;r&&(t.append(r),r=void 0);u&&u.destroy();n&&n.destroy();g&&g.destroy();v&&v.destroy();a.TextMeasureDiv&&(a.TextMeasureDiv.destroy(),delete a.TextMeasureDiv);E=L=J=I=F=C=r=g=A=n=B=u=x=v=t=s=z=null;};this.layoutChanged=function(a){c.zoom!=G&&(z.hidePopup(),aa(a));};var ba=function(a){r&&(t.append(r),C=r=void 0);aa();};this.maxPageWidth=function(){var a=s.sheetRight();void 0!==N&&N>a&&(a=N);return a;};this.maxPageHeight=function(){return s.sheetBottom();};this.padding=function(){return{left:H,
top:M,right:0,bottom:0};};this.visibleRange=function(){return h.cellRange(K,D,Q,R);};this.visibleHeight=function(){return va(R)-ua(D);};this.scrollOffset=function(a,b){void 0===a&&(a=K);void 0===b&&(b=D);var c=p.round(s.colLeft(a)*G)+1,d=p.round(s.rowTop(b)*G)+1;return{left:c,top:d};};var ka=function(a,b,c,d,e){var g=D;d/=G;if(0<c)for(;!(s.rowBottom(g)>=d);)g++;else if(0>c)for(c=D;0<=c;c--)if(s.rowTop(c)<=d){g=c;break;}c=K;d=b/G;if(0<a)for(;!(s.colRight(c)>=d);)c++;else if(0>a)for(a=K;0<=a;a--)if(s.colLeft(a)<=
d){c=a;break;}if(c!=K||g!=D)K=c,D=g,!1!==e&&(z.update(),z.hidePopup());},la=function(a,c){if(c){if(J){var e=s.getSelectedText();J.html(e);J.select();}z.hidePopup();if(!s.isRangeSelected()){var g=f.cellSelection();if(g){var h=s.getHoverText(g.c1,g.r1);if(h){e=d.viewNode;F=t.overlay.childByClass('oit-cellpopup');F||(F=b.create('div','oit-cellpopup'),t.overlay.append(F));var k=Math.floor(0.8*e.clientWidth);F.css({'max-width':k+'px','white-space':'nowrap',opacity:0,display:null});F.html(h);h=F.clientWidth;
h>k&&(h=k);var k=H-s.colLeft(K)+s.colLeft(g.c1)+1,g=M-s.rowTop(D)+s.rowBottom(g.r1),k=p.round(k*G),g=p.round(g*G),l=p.round((e.clientWidth-10-h)*G);k>l&&(k=l);e=e.pos();F.css({left:e.left+k+'px',top:e.top+g+'px','max-width':h+'px','white-space':null});F.animate({opacity:1,startCSS:{display:null}});}}}}ha();ca();};this.showHidden=function(a,b){var c=!1;!0===a?s.eachCol(function(a){s.showCol(a)&&(c=!0);}):!1===a&&s.eachCol(function(a){s.resetCol(a)&&(c=!0);});!0===b?s.eachRow(function(a){s.showRow(a)&&
(c=!0);}):!1===b&&s.eachRow(function(a){s.resetRow(a)&&(c=!0);});c&&(q.deactivate(),e.update(),z.update(),q.positionAll());};var aa=function(a,e){var f=d.viewNode;if(!x||y!=f.clientWidth||w!=f.clientHeight||G!=c.zoom)y=f.clientWidth,w=f.clientHeight,G=c.zoom,p.round(y/G),V=p.round(w/G),(f=ya())&&(1==G?f.css('transform',null):f.css('transform','scale('+G+','+G+')')),x&&(x.destroy(),B.destroy(),A.destroy()),u||(u=b.create('div','oit-ssgrid'),n=b.create('div','oit-sscolheader'),n.onmousemove(W),n.ondragstart(ga),
n.ondragmove(oa),n.ondragend(sa),n.ondragcancel(sa),n.onpress(pa),n.onpressup(qa),g=b.create('div','oit-ssrowheader'),g.onmousemove(ra),g.ondragstart(ta),g.ondragmove(za),g.ondragend(wa),g.ondragcancel(wa),g.onpress(Aa),g.onpressup(Ba),v.append(u,n,g)),v.css({width:y+'px',height:w+'px'}),H=g.offsetWidth,M=n.offsetHeight,x=u.createCanvas(),B=n.createCanvas(),A=g.createCanvas(),s.updateDimensions(),z.update();};this.pageRect=function(b,d){if('view'===d||'overlay'===d||d===t){var e=0,g=0,f=s.sheetRight(),
h=s.sheetBottom();if('view'===d||'overlay'===d){var k=c.zoom;1!=k&&(e*=k,g*=k,f*=k,h*=k);'view'===d&&(k=this.scrollOffset(),e+=H-k.left,g+=M-k.top,f+=H-k.left,h+=M-k.top);}return new a.Rectangle(e,g,f,h,d);}};this.rangeRect=function(b,c,d){var e;if('cell'===b.type)e=b.offsets?new a.Rectangle(s.colLeft(b.c1)+b.offsets.left,s.rowTop(b.r1)+b.offsets.top,s.colLeft(b.c2)+b.offsets.right,s.rowTop(b.r2)+b.offsets.bottom,t):new a.Rectangle(s.colLeft(b.c1)+1,s.rowTop(b.r1)+1,s.colRight(b.c2),s.rowBottom(b.r2),
t);else if('rect'===b.type){if('px'!==b.units&&(b=h.clone(b),h.convert(b,'px')),e=new a.Rectangle(b),void 0!==b.embedId){var g=s.embedByUID(b.embedId);b=t.embeddingRect(b.embedId);g&&b&&e.offset(b.left,b.top);}}else if('text'==b.type)for(var g=s.mapToCells(b),f=0;f<g.length;f++){var k=g[f],l=s.colLeft(k.c1),m=s.rowTop(k.r1),n=s.getCell(k.c1,k.r1),r;r=k.c1;var p=k.r1;r=r>=E.c1&&r<=E.c2&&p>=E.r1&&p<=E.r2?L[p-E.r1][r-E.c1]:void 0;p=!1;r?n&&n.highlightsChanged&&(p=!0):(r=fa(k.c1,k.r1),p=!0);p&&(n=x.getContext('2d'),
n.save(),n.font='12px Arial,Helvetica,sans-serif',ia(n,k.c1,k.r1,r),n.restore());if(k=r.rangeRect(b))k.left+=l,k.right+=l,k.top+=m,k.bottom+=m,e?e.union(k):e=new a.Rectangle(k,t);}if(e)return!0===d&&(d=s.colLeft(K)-100,b=s.rowTop(D)-100,g=s.colRight(O)+100,f=s.rowBottom(P)+100,e.intersect(d,b,g,f)),e.origin=c,e;};this.rangeFromRect=function(b,c,d,e,g,f,l,m,n,r){b=new a.Rectangle(c,d,e,g,f);b.origin=t;if(void 0!==m)return n=k.embeddingRect(m),'move'===l?b.constrain(n):b.intersect(n),b.offset(-n.left,
-n.left),c=b.toRange(),c.embedId=m,h.convert(c,'pct'),c;'move'!==l&&('resize'!==l&&'extend'!==l)&&('view'===f&&(c-=H,d-=M),r|=c<s.colLeft(K),n|=d<s.rowTop(D));m=new a.Rectangle(0,0,s.sheetRight(),s.sheetBottom(),t);'move'===l?b.constrain(m):b.intersect(m);m=!r&&!n;c=s.cellFromPos(b.left,b.top,m);m=s.cellFromPos(b.right,b.bottom,m);r?(c.c1=0,c.c2=s.colCount()-1,c.selectingRows=!0):c.c2=m.c1;n?(c.r1=0,c.r2=s.rowCount()-1,c.selectingCols=!0):c.r2=m.r1;if('move'===l||'resize'===l)l=z.rangeRect(c,t,!1),
b.left-1>l.left&&c.c1<c.c2&&(c.c1+=1),b.top-1>l.top&&c.r1<c.r2&&(c.r1+=1),b.right<l.right&&c.c1<c.c2&&(c.c2-=1),b.bottom<l.bottom&&c.r1<c.r2&&(c.r2-=1);!r&&!n?(c.offsets={left:b.left-s.colLeft(c.c1),top:b.top-s.rowTop(c.r1),right:b.right-s.colLeft(c.c2),bottom:b.bottom-s.rowTop(c.r2)},s.expandRange(c)):(r&&(c.selectingRows=!0),n&&(c.selectingCols=!0));return c;};this.extendRange=function(a,b,c,d){var e=z.rangeRect(a,d,!1),g=e.left,e=e.top,g=a.selectingRows?g-H:g+1,e=a.selectingCols?e-M:e+1;b=z.rangeFromRect(a.page,
g,e,b,c,d,'extend',void 0,a.selectingCols,a.selectingRows);b.offsets&&!a.offsets&&delete b.offsets;return b;};this.update=function(a){var b=d.viewNode;if(!ja){ja=!0;var c=s.webFonts();if(c&&0<c.length)for(var g=c.length-1;0<=g;g--)l.loadWebFont(c[g]);}c=p.round(-s.colLeft(K)*G);g=p.round(-s.rowTop(D)*G);d.drawing.setOrigin(c+H,g+M);O=K;Q=void 0;for(var f=H;O<s.colCount();){f+=p.round(s.colWidth(O)*G);if(f>=b.clientWidth){f==b.clientWidth?Q=O:(Q=O-1,Q<K&&(Q=K));break;}O++;}void 0===Q&&(Q=O);P=D;R=void 0;
for(f=M;P<s.rowCount();){f+=p.round(s.rowHeight(P)*G);if(f>=b.clientHeight){f==b.clientHeight?R=P:(R=P-1,R<D&&(R=D));break;}P++;}void 0===R&&(R=P);s.loadDataForCells(K,D,O,P,!0);if(f=xa()){var k=d.viewNode,m=k.pos(k.parent());f.css({left:m.left+H+'px',top:m.top+M+'px',width:k.clientWidth-H+'px',height:k.clientHeight-M+'px'});ya().css({left:c+'px',top:g+'px'});c=s.embeddingCount();for(g=0;g<c;g++)if((f=s.embed(g))&&f.node&&f.position)if(void 0===f.c2)f.node.css({left:f.position.left-f.adjustX+'px',top:f.position.top-
f.adjustY+'px'});else if(f.position.left===f.position.right||f.position.top===f.position.bottom)f.node.css('display','none');else{var k=(f.position.right-f.position.left)/f.w,m=(f.position.bottom-f.position.top)/f.h,n,r;if(1!=k||1!=m)n='scale('+k+','+m+')',r='left top';f.node.css({display:null,left:f.position.left-f.adjustX*k+'px',top:f.position.top-f.adjustY*m+'px',transform:n,'transform-origin':r});}}n=x.getContext('2d');n.clearRect(0,0,x.width,x.height);n.save();!0===a&&(E=null);c=K;if(0<K)for(a=
D;a<=P;a++)if(g=s.getCell(K,a),!g||!g.t&&!g.v)r=s.prevTextCell(K,a),void 0!==r&&r<c&&(c=r);if((r=E)&&(E.c1!=c||E.c2!=O||E.r1!=D||E.r2!=P)){if(c>E.c2||O<E.c1||D>E.r2||P<E.r1)L=r=null;E=null;}if(!E){E=h.cellRange(c,D,O,P);g=E.r2-E.r1+1;f=E.c2-E.c1+1;c=L;L=Array(g);for(a=0;a<g;a++)L[a]=Array(f);m=k=null;for(a=E.r1;a<=E.r2;a++)for(f=E.c1;f<=E.c2;f++){var g=s.getCell(f,a),q=s.colStyle(f),m=g===k&&null===q?m:null;g&&!m&&(r&&(k=a-r.r1,0<=k&&k<c.length&&(q=f-r.c1,0<=q&&q<c[k].length&&(m=c[k][q]))),m||(m=fa(f,
a)));L[a-E.r1][f-E.c1]=m;k=g;}}n.font='12px Arial,Helvetica,sans-serif';c=p.round((s.colRight(s.colCount()-1)-s.colLeft(K))*G);g=p.round((s.rowBottom(s.rowCount()-1)-s.rowTop(D))*G);f=d.viewNode;a=f.clientWidth;r=f.clientHeight;S||(a>c&&(a=c),r>g&&(r=g));n.oitrect(0,0,a,r,'#ffffff');n.fillStyle=S?'#f0f0f0':'#666666';f.clientWidth>c&&n.fillRect(c,0,f.clientWidth-c,f.clientHeight);f.clientHeight>g&&n.fillRect(0,g,f.clientWidth,f.clientHeight-g);for(c=K;;c++){g=p.round((s.colLeft(c)-s.colLeft(K))*G);
if(g>a)break;g+=0.5;n.oitline(g,0,g,r,'#e0e0e0');}for(c=D;;c++){g=ua(c);if(g>r)break;g+=0.5;n.oitline(0,g,a,g,'#e0e0e0');}a=N;s.colLeft(K);s.rowTop(D);for(c=r=0;c<L.length;c++)if(g=L[c],f=c+E.r1,k=s.rowHeight(f),0<k){m=0;E.c1!=K&&(m=s.colLeft(E.c1)-s.colLeft(K));for(var u=m,q=0;q<g.length;q++){var v=q+E.c1,C=s.colWidth(v);if(0<C){var w=g[q];if(w&&w.hasText()){ia(n,v,f,w,u,m,r,C,k);u=s.colLeft(v)+w.textRight();if(void 0===N||u>N)N=u;u=m+C;}m+=C;}}r+=k;}r=b.clientWidth;c=b.clientHeight;w=s.sheetRight();
q=s.sheetBottom();void 0!==N&&N>w&&(w=N);t.width=w;t.height=q;g=d.viewNode;C=g.clientWidth/G;f=g.clientHeight/G;k=20/G;u=H/G;m=M/G;g=w+u+k;if(g>C){for(v=s.colCount()-1;s.colLeft(v)<w;)v++;for(var z=v,w=s.colWidth(z),z=z-1;0<=z;z--){var F=w+s.colWidth(z);if(F>C)break;w=F;}w=C-w;0>w&&(w=0);C=s.colRight(v)+u+(w+k);C>g&&(g=C);}C=q+m+k;if(C>f){for(u=s.rowCount()-1;s.rowTop(u)<q;)u++;v=u;q=s.rowHeight(v);for(v-=1;0<=v;v--){w=q+s.rowHeight(v);if(w>f)break;q=w;}w=f-q;0>w&&(w=0);w+=k;f=s.rowBottom(u)+m+w;f>C&&
(C=f);}t.css({width:g*G+'px',height:C*G+'px'});N!=a||r!=b.clientWidth||c!=b.clientHeight?(n.restore(),y=-1,aa()):(n.scale(G,G),da(n,'drawTextBackground'),da(n,'drawBackground'),da(n,'drawBorder',!0),da(n,'drawText'),n.restore(),ha(),ca(),e.update());};this.hidePopup=function(a){F&&F.animate({opacity:0,time:a?120:0,endCSS:{display:'none'}});};this.moveto=function(a,b,c){var d=!1;h.isRangeObject(a)&&('text'===a.type?(a=s.mapToCells(a))&&0<a.length&&(d=this.moveto(a[0],b,c)):'cell'===a.type&&(this.scrollToRange(a.c1,
a.r1,a.c2,a.r2),b&&b(c),d=!0));return d;};this.scrollToRange=function(a,b,c,e){var g=d.viewNode,f,h;if(a<K)f=a;else if(c>Q){a=g.clientWidth-H;for(f=c;0<=f;){a-=p.round(s.colWidth(f)*G);if(0==a)break;if(0>a){f++;break;}if(0==f)break;f--;}}if(b<D)h=b;else if(e>R){b=g.clientHeight-M;for(h=e;0<=h;){b-=p.round(s.rowHeight(h)*G);if(0==b)break;if(0>b){h++;break;}if(0==h)break;h--;}}e=this.scrollOffset(f,h);var k,l;void 0!==f&&(k=e.left);void 0!==h&&(l=e.top);g.scroll(k,l);};var ha=function(a){a=B.getContext('2d');
a.save();a.oitrect(0,0,n.clientWidth,n.clientHeight,'#d0d0d0');a.oitrect(0,0,H,M,'#aaa');a.oitrect(H-11.5,M-11.5,8,8,'#d0d0d0','#e0e0e0');a.fillStyle='black';a.textAlign='center';a.textBaseline='middle';var b=12;1<=G?a.font='12px Arial,Helvetica,sans-serif':(b*=G,8>b&&(b=8),a.font=b+'px Arial,Helvetica,sans-serif');for(var b=f.cellSelection(),c=M/2,d=!1,e=K;;e++){var g=p.round((s.colLeft(e)-s.colLeft(K))*G)+H+0.5;if(g>n.clientWidth)break;var h=p.round(s.colWidth(e)*G);0==h?d=!0:d&&(g+=1,d=!1);b&&
(e>=b.c1&&e<=b.c2)&&(a.oitrect(g,0,h,M,'#e8e8e8'),a.fillStyle='black');a.strokeStyle=b&&e>b.c1&&e<=b.c2?'#ccc':'#aaa';a.oitline(g,0,g,M,a.strokeStyle);g+=1;a.oitline(g,0,g,M,'#e0e0e0');if(!S&&e>=s.colCount())break;if(0<h){a.save();a.beginPath();a.rect(g,0,h,M);a.clip();var k=s.colTitle(e);a.measureText(k).width>=h?(g+=1,a.textAlign='left'):(g+=h/2,a.textAlign='center');a.fillText(k,g,c);a.restore();}}b=M+0.5;a.oitline(0,b,V,b,'#aaa');a.restore();},ca=function(a){a=A.getContext('2d');a.save();a.oitrect(0,
0,g.clientWidth,g.clientHeight,'#d0d0d0');a.fillStyle='black';a.textAlign='center';a.textBaseline='middle';var b=12;1<=G?a.font='12px Arial,Helvetica,sans-serif':(b*=G,8>b&&(b=8),a.font=b+'px Arial,Helvetica,sans-serif');for(var b=f.cellSelection(),c=H/2,d=!1,e=D;;e++){var h=ua(e)+0.5;if(h>g.clientHeight)break;var k=p.round(s.rowHeight(e)*G);0==k?d=!0:d&&(h+=1,d=!1);b&&(e>=b.r1&&e<=b.r2)&&(a.oitrect(0,h,H,k,'#e8e8e8'),a.fillStyle='black');a.strokeStyle=b&&e>b.r1&&e<=b.r2?'#ccc':'#aaa';a.oitline(0,
h,H,h,a.strokeStyle);h+=1;a.oitline(0,h,H,h,'#e0e0e0');if(!S&&e>=s.rowCount())break;0<k&&(a.save(),a.beginPath(),a.rect(0,h,H,k),a.clip(),a.fillText(String(e+1),c,h+k/2,H),a.restore());}b=H+0.5;a.oitline(b,0,b,g.clientHeight,'#aaa');a.restore();},Z=function(a,b){return!a||0>b||b>=a.length?null:a[b];},da=function(a,b,c){var d=0,e;c&&(e=[[null,null,null],[null,null,null],[null,null,null]]);for(var g=null,f=null,h=0<L.length?L[0]:null,k=0;k<L.length;k++){var g=f,f=h,h=k+1<L.length?L[k+1]:null,l=k+E.r1,
m=s.rowHeight(l);if(0<m){var n=0;E.c1!=K&&(n=s.colLeft(E.c1)-s.colLeft(K));for(var r=0;r<f.length;r++){var p=r+E.c1,q=s.colWidth(p),t=f[r];if(0<q&&t){for(var u=t.horizontalMerge(),v=t.verticalMerge(),C=q,w=m,x=1;x<=u;x++)C+=s.colWidth(p+x);for(x=1;x<=v;x++)w+=s.rowHeight(l+x);!0==c&&(e[0][0]=Z(g,r-1),e[0][1]=Z(g,r),e[0][2]=Z(g,r+1),e[1][0]=Z(f,r-1),e[1][1]=t,e[1][2]=Z(f,r+1),e[2][0]=Z(h,r-1),e[2][1]=Z(h,r),e[2][2]=Z(h,r+1));t[b](a,p,l,n,d,C,w,e);}n+=q;}d+=m;}}},ia=function(a,b,c,d,e,g,f,h,k){void 0===
g&&(g=s.colLeft(b)-s.colLeft(K));void 0===f&&(f=s.rowTop(c)-s.rowTop(D));void 0===h&&(h=s.colWidth(b));void 0===k&&(k=s.rowHeight(c));if(void 0===e){e=g;for(var l=b-1;0<=l;l--){var m=s.getCell(l,c);if(m&&(m.t||m.v))break;e=s.colLeft(l)-s.colLeft(K);}}var m=d.horizontalMerge(),r=d.verticalMerge();if((l='cs'===d.horizontalAlign())||0<m)for(var n=1;(l||n<=m)&&(!l||!(l=s.getCell(b+n,c),l=!l||l.t||l.v?!1:'cs'===s.cellStyle(l.s).a,!l&&n>m));)h+=s.colWidth(b+n),n++;for(n=1;n<=r;n++)k+=s.rowHeight(c+n);m=
s.colLeft(K);r=s.colRight(O)-m;n=void 0;S||(n=s.colRight(b)-m);for(b+=1;;b++){l=s.getCell(b,c);if(!l)break;if(l.t||l.v){n=s.colLeft(b)-m;break;}l=s.colRight(b)-m;if(l>r)break;S||(n=l);}d.layoutText(a,g,f,h,k,e,n);},fa=function(b,c){var d=s.getCell(b,c);if(d)return new a.SpreadsheetCellRenderer(d,s,b,c);},ma=function(a){var b;if(a>=H){a-=H;for(var c=K;c<s.colCount();){var d=p.round((s.colRight(c)-s.colLeft(K))*G),e=d-3;if(e>a)break;var g=d+3;if(a>=e&&a<=g&&(b=c,a<=d))break;c++;}}return b;},na=function(a){var b;
if(a>=H){a-=H;for(b=K;!(a<p.round((s.colRight(b)-s.colLeft(K))*G));b++);}return b;},X=function(a){var b;if(a>=M){a-=M;for(var c=D;c<s.rowCount();){var d=va(c),e=d-3;if(e>a)break;var g=d+3;if(a>=e&&a<=g&&(b=c,a<=d))break;c++;}}return b;},ea=function(a){var b;if(a>=M){a-=M;for(b=D;!(a<va(b));b++);}return b;},W=function(a){-1==$&&-1==U&&(a=d.viewNode.mousePos(a),a=void 0!==ma(a.x)?'col-resize':null,B.css('cursor',a));},ga=function(a){return-1==$&&(a=ma(a.center.x),void 0!==a)?(U=a,!0):!1;},oa=function(a){if(-1!=
$)a=na(a.center.x),e.select(h.cellRange(t.index,$,0,a,s.rowCount()-1));else if(-1!=U){a=p.round((a.center.x-H)/G)+s.colLeft(K);var b=s.colLeft(U);a=a>=b?a-b:0;a!=s.colWidth(U)&&(s.setColWidth(U,a),e.update(),z.update(),q.positionAll());}},sa=function(a){-1!=U&&(U=-1,aa(),q.positionAll());},pa=function(a){$=na(a.center.x);e.select(h.cellRange(t.index,$,0,$,s.rowCount()-1));},qa=function(a){$=-1;},ra=function(a){-1==Y&&-1==T&&(a=d.viewNode.mousePos(a),a=void 0!==X(a.y)?'row-resize':null,A.css('cursor',
a));},ta=function(a){return-1==Y&&(a=X(a.center.y),void 0!==a)?(T=a,!0):!1;},za=function(a){if(-1!=Y)a=ea(a.center.y),e.select(h.cellRange(t.index,0,Y,s.colCount()-1,a));else if(-1!==T){a=p.round((a.center.y-M)/G)+s.rowTop(D);var b=s.rowTop(T);a=a>=b?a-b:0;a!=s.rowHeight(T)&&(s.setRowHeight(T,a),e.update(),z.update(),q.positionAll());}},wa=function(a){-1!==T&&(T=-1,aa(),q.positionAll());},Aa=function(a){Y=ea(a.center.y);e.select(h.cellRange(t.index,0,Y,s.colCount()-1,Y));},Ba=function(a){Y=-1;},ua=function(a){return p.round((s.rowTop(a)-
s.rowTop(D))*G);},va=function(a){return p.round((s.rowBottom(a)-s.rowTop(D))*G);},xa=function(){void 0===r&&(r=t.childByClass('oit-sheet-embedpane'))&&d.viewNode.parent().append(r);return r;},ya=function(){if(void 0===C){var a=xa();C=a?a.childByClass('oit-sheet-embedlist'):null;}return C;};(function(){var c=d.viewNode;v=c.parent().childByClass('oit-ssoverlay');v||(v=b.create('div','oit-ssoverlay'),c.parent().insert(v,c));v.html('');I=t.overlay.childByClass('oit-sel-text');I||(I=b.create('div'),t.overlay.append(I));
J=b.create('pre');I.addClass('oit-sel-text');I.html('');I.append(J);a.on('document','scroll',ka);a.on('selection','selectionchanged',la);a.on('pages','pageload',ba);a.on('view','resize',aa);c=c.scroll();ka(c.left,c.left,c.top,c.top,!1);aa();})();};});OIT.extend(function(a){var b=a.opt,d=a.doc,c=a.glob,f=a.util,e=a.pages,l=a.highlights,p=a.selection,h=OIT.local,q=a.attachments,m=a.display,k=a.rawtext,z=a.range,s=a.view;a.EmailHeader=function(c){a.Element.call(this,c);d.attach(this);for(var f,k=h.LABEL_SEPARATOR,l=!!this.hasClass('oit-emailheader'),m=0;m<B.length;m++)if(f='oit-email_'+B[m],f=l?(f=this.byClass(f))&&0<f.length?f[0]:null:d.byId(f),f){var n='EMAIL_'+B[m].toUpperCase();f.html(h[n]+k);f.attr('data-acc','none');f.addClass('oit-noacc');}this._hdrsection=
e.forNode(c);(c=this.childByClass('oit-headerpadding'))?(this._hdrtable=c.childByClass('oit-maildata'),this._hdrtable||(this._hdrtable=d.byId('oit-maildata'))):(this._hdrtable=this.childByClass('oit-maildata'),this._hdrtable||(this._hdrtable=d.byId('oit-maildata')),c=d.create('div','oit-headerpadding'),this.insert(c,this._hdrtable),c.append(this._hdrtable));this.tabs=[];(c=this.childByClass('oit-emextra'))||(c=d.byId('oit-emextra'));c&&((c=c.childByClass('oit-em_allheaders'))||(c=d.byId('oit-em_allheaders')),
c&&(b.removeExtraEmailHeaders?this.removeExtraEmailHeaders():(this.allHeadersTab=new a.EmailHeaderTab(this,c,'oit-email_gear_icon',18,18,h.SHOWDETAILS,h.HIDEDETAILS),this.tabs.push(this.allHeadersTab))),this.append(this.tabs));if((c=this._hdrtable.byClass('oit-attachedFile'))&&0<c.length)for(l=0;l<c.length;l++)m=c[l],k=m.data('index'),k=void 0!=k?parseInt(k):l,q.on.addElement(m,k);c=this._fields=[];if(k=this._hdrtable.byTag('TR'))for(l=0;l<k.length;l++)if(m=k[l],f=m.byClass('oit-emhdrlabel'),n=m.byClass('oit-emhdrvalue'),
f&&n)for(var p=0;p<n.length;p++){var s=f[p],t=n[p];3==t.attr('colspan')&&t.attr('colspan',4);var u=s.nextSiblingElem();u&&!u.hasClass('oit-expander')&&(u=null);u||(u=d.create('td','oit-expander'),m.insert(u,t));var w=t.firstChildElem(),s={row:m,label:s,expander:u,value:t,content:w,header:this,show:v},u=t.data('acc');void 0!==u&&(u=parseInt(u),t=u+t.text().length,s.range=z.textRange(u,t));c.push(s);w&&w.addClass('oit-expandable');}a.on('selection','beginselection',this,this.beginSelection);this.onStyleChanged();};
var t=a.subclass(a.EmailHeader,a.Element),v=function(){this.expanded||y.call(this);},y=function(){var a=this.content,b=this.expander,c=this.icon,d=this.header;a&&(b&&c)&&(this.expanded?(a.css('white-space','nowrap'),c.attr('class','oit-expand_icon'),this.expanded=!1,d.applyViewSize(!1),'expandable'===d._selectionPos&&(p.select(null),l.deactivate())):(a.css('white-space','normal'),c.attr('class','oit-contract_icon'),this.expanded=!0,d.applyViewSize(!1)),e.each('pageLayoutChanged'));};t.unload=function(){a.off('selection',
'beginselection',this.beginSelection);f.each(this.tabs,'destroy');delete this.tabs;delete this.allHeadersTab;};t.destroy=function(){this.unload();a.Element.prototype.destroy.call(this);};var w=function(a){for(var b=0;b<a._fields.length;b++){var c=a._fields[b];c.temprow&&(c.row.append(c.label,c.expander,c.value),c.temprow.destroy(),delete c.temprow);c.content&&c.content.css('width',null);delete c.nowrapHeight;delete c.wrapWidth;delete c.wrapHeight;}},x=function(a){for(var b,c=0;c<a._fields.length;c++){var d=
a._fields[c];d.content&&d.content.css('width','0px');}for(c=0;c<a._fields.length;c++){var d=a._fields[c],e=d.content;e&&(e.css('width',null),d.nowrapHeight=e.offsetHeight,e.css('white-space','normal'),d.wrapWidth=e.offsetWidth,d.wrapHeight=e.offsetHeight,e.css('white-space',null),e.css('width','0px'));!d.temprow&&d.row==b&&(d.wrapHeight=d.nowrapHeight);b=d.row;}for(c=0;c<a._fields.length;c++)d=a._fields[c],d.content&&d.content.css('width',null);},u=function(a){for(var b=0;b<a._fields.length;b++){var c=
a._fields[b],e=c.content;e&&(c.wrapHeight!=c.nowrapHeight?(e.css('width',c.wrapWidth+'px'),c.iconWrap||(e=c.expander,c.iconWrap=d.create('div'),c.icon=d.create('div','oit-expand_icon'),c.iconWrap.append(c.icon),e.insertFirst(c.iconWrap),e.onclick(c,y),e.ontap(c,y),c.icon.css('visibility','visible'),c.expanded=!1,e.css('cursor','default'))):c.iconWrap&&(c.expander.offclick(y),c.expander.offtap(y),c.iconWrap.destroy(),delete c.iconWrap,delete c.icon));}};t.applyViewSize=function(a){if(!1!==a){a=!1;c.isMobile&&
(a=!0);if(!a){w(this);x(this);u(this);var b=this._hdrtable.offsetWidth,f=this._hdrtable.parent().offsetWidth;b>f&&(a=!0);}if(a){w(this);var h;for(a=0;a<this._fields.length;a++)b=this._fields[a],b.row==h&&(b.temprow=d.create('tr'),b.temprow.append(b.label,b.expander,b.value),b.row.parent().insertAfter(b.temprow,b.row)),h=b.row;x(this);u(this);}}this._hdrsection&&this._hdrsection.css('height',this.offsetHeight+'px');h=0;this._hdrtable&&(h=this._hdrtable.offsetHeight+this._hdrtable.offsetTop);for(a=0;a<
this.tabs.length;a++)this.tabs[a].applyViewSize(h);l.onEmailTabActivate();e.each('pageLayoutChanged');};t.finishAnimation=function(){this._hdrsection&&this._hdrsection.finishAnimation();};t.adjustHeightForTab=function(a,b,c){if(this._hdrsection){var d;a.isActive()?d=this.offsetHeight:this._hdrtable&&(d=this._hdrtable.offsetHeight+13);this._hdrsection.animate({innerHeight:d+4,time:!1===c?0:200,stepFn:l.positionAll,endFn:function(){a.isActive()||a._clientDiv.css('display','none');s.dispatchResize();e.each('pageLayoutChanged');
l.onEmailTabActivate();b&&b(a);}});}};var B='attachments calendarexceptions subject to cc bcc from topic priority owner date percent status startdate enddate duedate created category name received fullname first last middle suffix title fileas displayas company jobtitle bphone baddress fax email hphone haddress mobile im webpage entrytype starttime duration reqattend optattend location endtime importance recurtype recurrange'.split(' ');t.beginSelection=function(a){this._selectionPos=null;this.showEmailHeader(a);};
t.getEmailHeader=function(a){if(a&&'text'==a.type){for(var b=0;b<this._fields.length;b++){var c=this._fields[b];if(c.range&&z.contains(c.range,a))return{field:c};}if(a=e.page(0).findTextRange(a))for(b=0;b<a.length;b++)for(var c=a[b],d=0;d<this.tabs.length;d++){var f=this.tabs[d].containsRange(c);if(f)return f;}}};t.moveto=function(a,b,d){return(a=this.showEmailHeader(a,b,d))&&a.tab?(c.viewNode.scroll(0,0),!0):!1;};t.showEmailHeader=function(a,b,c){var d=this.getEmailHeader(a);d&&(c=c||{},d.field?(d.field.show(),
this._selectionPos='expandable',b&&b(c)):d.tab&&(d.tab.activate(null,!0,function(){d.tab.scrollToRange(a);b&&b(c);},c.animate),this._selectionPos='tab'));return d;};var n='font font-style font-variant font-weight font-stretch font-size line-height font-family text-transform color background background-image background-position background-size background-repeat background-origin background-clip background-attachment background-color'.split(' ');t.onStyleChanged=function(){var a=b.emailHeaderStyle;this._headerStyle&&
this.removeStyle(this._headerStyle);this._headerStyle={};if(a)for(var c in a)-1!=n.indexOf(c)&&(this._headerStyle[c]=a[c]);this.applyEmailHeaderStyles();};t.applyEmailHeaderStyles=function(){try{this._headerStyle&&this.css(this._headerStyle),this.applyViewSize();}catch(a){this.logError('email header style','An error occurred setting email header style');}};t.removeExtraEmailHeaders=function(){this.allHeadersTab&&this.allHeadersTab.activate(null,!1,null,!1);var a=this.byClass('oit-em_allheaders');a||
(a=d.byId('oit-em_allheaders'));if(a&&(Array.isArray(a)&&(a=a[0]),!1!==k.hasRawText())){for(var b=[],c,a=a.createTreeWalker(NodeFilter.SHOW_ELEMENT),e=a.firstACCNode();e;){var h=a.currentNode,e=d.data(h,'acc'),h=h.textContent||h.innerText;e&&h&&h.length?(e=Number(e),h=e+h.length,c&&e<=c.accend+2&&h>=c.acc-2?(c.acc=Math.min(c.acc,e),c.accend=Math.max(c.accend,h)):(c=z.textRange(e,h),b.push(c)),e=a.skipNode()):e=a.nextACCNode();}b.length&&(k.replaceRawText(b),l.removeFromRange(b));}this.allHeadersTab&&
(f.remove(this.tabs,this.allHeadersTab),this.allHeadersTab.destroy(),delete this.allHeadersTab);};a.EmailHeaderTab=function(b,e,f,h,k,l,m){a.Element.call(this,'div','oit-button');d.attach(this);f&&this.addClass(f);this.css({position:'absolute','z-index':40,left:b.offsetWidth-24+'px'});this._header=b;this._minHeight=this._fullHeight=k;this._clientDiv=e;this._active=!1;this._utip=l;c.isMobile||this._clientDiv.css('max-height','300px');m&&(this._atip=m);l&&this.attr('title',l);this._clientDiv&&(this._clientDiv.on('scroll',
null,A,this),this._clientDiv.css('display','none'));this.on('click',this,this.activate,'toggle');this.on('tap',this,this.activate,'toggle');};t=a.subclass(a.EmailHeaderTab,a.Element);t.destroy=function(){this._clientDiv&&(this._clientDiv.offscroll(A),delete this._clientDiv);this.offclick(this.activate);this.offtap(this.activate);a.Element.prototype.destroy.call(this);};var A=function(a,b){var c=b._clientDiv.scroll();if(!b._scroll||c.left!=b._scroll.left||c.top!=b._scroll.top)b._scroll=c,c=e.page(0),
l.deactivate(),c.pageLayoutChanged(),l.positionAll(c);};t.isActive=function(){return void 0!==this._pendingState?this._pendingState:this._active;};t.applyViewSize=function(a){this.css({left:this._header.offsetWidth-24+'px',top:a-this._minHeight+'px'});};t.containsRange=function(a){var b=d.wrap(a.startContainer);a=d.wrap(a.endContainer);var c=d.isDescendantOf(b,this._clientDiv);if(c||d.isDescendantOf(a,this._clientDiv))return{tab:this,rangeElem:c?b:a};};t.scrollToRange=function(a){if(this._clientDiv.childByClass('oit-emheadervalues')){var c=
e.page(0);if(a=m.rangeRect(a,c)){var d=this._clientDiv,c=d.pos(c);a.offset(-c.left,-c.top);var c=d.clientWidth,f=d.clientHeight,h=b.zoom;1<h&&(c/=h,f/=h);var k=h=0;0>a.left?h=a.left-10:a.right>c&&(h=a.right+10-c);0>a.top?k=a.top-10:a.bottom>f&&(k=a.bottom+10-f);if(h||k)d.dscroll(h,k),A(null,this);}}};t.activate=function(a,b,c,d){var e=this;a=e._active;'toggle'==b?a=!a:'boolean'===typeof b&&(a=b);if(a==e._active)c&&c(e);else if(a==e._pendingState)c&&e._stateCallbacks.push(c);else{e._header.finishAnimation();
e._pendingState=a;e._stateCallbacks=[];c&&e._stateCallbacks.push(c);!a&&'tab'===e._selectionPos&&(p.select(null),l.deactivate());if(a)for(b=0;b<e._header.tabs.length;b++)e._header.tabs[b]!=e&&e._header.tabs[b].activate(null,!1);a?(e._clientDiv.css('display','block'),e.css('height',e._fullHeight+'px'),e.addClass('oit-activetab'),e._atip&&e.attr('title',e._atip)):(e.css('height',e._minHeight+'px'),e.removeClass('oit-activetab'),e._utip&&e.attr('title',e._utip));e._header.adjustHeightForTab(e,function(){e._active=
e._pendingState;delete e._pendingState;for(var a=0;a<e._stateCallbacks.length;a++)e._stateCallbacks[a](e);delete e._stateCallbacks;},d);}};});OIT.extend(function(a){a.glob.libversion='8.5.5.12.2005081022';});OIT.extend(!1);
